# R2 å­˜å‚¨ä½ç½®è¯´æ˜

## ğŸ“ R2 æœ€ç»ˆå­˜å‚¨åˆ°å“ªé‡Œï¼Ÿ

### Cloudflare R2 å¯¹è±¡å­˜å‚¨

R2 è§†é¢‘æ–‡ä»¶å­˜å‚¨åœ¨ **Cloudflare çš„å…¨çƒåˆ†å¸ƒå¼æ•°æ®ä¸­å¿ƒ**ä¸­ã€‚

## ğŸ” å½“å‰é…ç½®ä¿¡æ¯

æ ¹æ®ä½ çš„é¡¹ç›®é…ç½®ï¼š

- **å­˜å‚¨æ¡¶åç§°**: `sora2`
- **Account ID**: `2776117bb412e09a1d30cbe886cd3935`
- **å…¬å…±è®¿é—® URL**: `https://pub-2868c824f92441499577980a0b61114c.r2.dev`
- **ç®¡ç†ç«¯ç‚¹**: `https://2776117bb412e09a1d30cbe886cd3935.r2.cloudflarestorage.com`

## ğŸŒ å­˜å‚¨ä½ç½®è¯¦æƒ…

### 1. **å…¨çƒåˆ†å¸ƒå¼å­˜å‚¨**

Cloudflare R2 å°†æ•°æ®å­˜å‚¨åœ¨ï¼š
- **å¤šä¸ªæ•°æ®ä¸­å¿ƒ**ï¼šCloudflare åœ¨å…¨çƒæœ‰ 300+ æ•°æ®ä¸­å¿ƒ
- **è‡ªåŠ¨å†—ä½™**ï¼šæ•°æ®è‡ªåŠ¨å¤‡ä»½åˆ°å¤šä¸ªä½ç½®ï¼Œç¡®ä¿é«˜å¯ç”¨æ€§
- **æ— åŒºåŸŸé™åˆ¶**ï¼šä¸ AWS S3 ä¸åŒï¼ŒR2 ä¸ç»‘å®šç‰¹å®šåŒºåŸŸï¼Œå…¨çƒç»Ÿä¸€å­˜å‚¨

### 2. **å…·ä½“ç‰©ç†ä½ç½®**

Cloudflare ä¸ä¼šå…¬å¼€å•ä¸ªæ–‡ä»¶çš„ç²¾ç¡®ç‰©ç†ä½ç½®ï¼Œå› ä¸ºï¼š
- æ•°æ®å¯èƒ½åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒåŒæ—¶å­˜åœ¨ï¼ˆå†—ä½™ï¼‰
- ç³»ç»Ÿä¼šæ ¹æ®è®¿é—®æ¨¡å¼è‡ªåŠ¨ä¼˜åŒ–å­˜å‚¨ä½ç½®
- ä½¿ç”¨ **Erasure Coding** æŠ€æœ¯åˆ†æ•£å­˜å‚¨æ•°æ®å—

### 3. **æ•°æ®åˆ†å¸ƒ**

ä½ çš„è§†é¢‘æ–‡ä»¶å¯èƒ½å­˜å‚¨åœ¨ï¼š
- ç¾å›½çš„æ•°æ®ä¸­å¿ƒ
- æ¬§æ´²çš„æ•°æ®ä¸­å¿ƒ
- äºšæ´²çš„æ•°æ®ä¸­å¿ƒ
- æˆ–å…¶ä»– Cloudflare è¦†ç›–çš„åœ°åŒº

**å¥½å¤„**ï¼š
- âœ… å…¨çƒè®¿é—®é€Ÿåº¦å¿«ï¼ˆCDN åŠ é€Ÿï¼‰
- âœ… é«˜å¯ç”¨æ€§ï¼ˆå¤šæ•°æ®ä¸­å¿ƒå¤‡ä»½ï¼‰
- âœ… è‡ªåŠ¨æ•…éšœè½¬ç§»

## ğŸ“‚ æ–‡ä»¶å­˜å‚¨è·¯å¾„

### åœ¨ä½ çš„ R2 å­˜å‚¨æ¡¶ä¸­çš„è·¯å¾„ç»“æ„ï¼š

```
sora2 (å­˜å‚¨æ¡¶)
  â””â”€â”€ videos/
      â”œâ”€â”€ task-id-1.mp4
      â”œâ”€â”€ task-id-2.mp4
      â””â”€â”€ ...
```

### è®¿é—® URL æ ¼å¼ï¼š

```
https://pub-2868c824f92441499577980a0b61114c.r2.dev/videos/task-id.mp4
```

## ğŸ–¥ï¸ å¦‚ä½•æŸ¥çœ‹å’Œç®¡ç†å­˜å‚¨

### æ–¹æ³• 1: Cloudflare Dashboardï¼ˆæ¨èï¼‰

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. è¿›å…¥ **R2** é¡µé¢
3. ç‚¹å‡»å­˜å‚¨æ¡¶åç§° `sora2`
4. æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨å’Œå­˜å‚¨ä½¿ç”¨æƒ…å†µ

**å¯ä»¥çœ‹åˆ°**ï¼š
- âœ… æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨
- âœ… æ¯ä¸ªæ–‡ä»¶å¤§å°
- âœ… ä¸Šä¼ æ—¶é—´
- âœ… æ€»å­˜å‚¨ä½¿ç”¨é‡
- âœ… ä¸‹è½½/åˆ é™¤æ–‡ä»¶

### æ–¹æ³• 2: ä½¿ç”¨ä»£ç æŸ¥çœ‹

```bash
# åˆ—å‡ºæ‰€æœ‰è§†é¢‘æ–‡ä»¶
GET /api/admin/r2/list?prefix=videos/

# è¿”å›ç¤ºä¾‹
{
  "files": [
    {
      "key": "videos/task-123.mp4",
      "size": 5242880,
      "lastModified": "2024-01-01T00:00:00Z",
      "url": "https://pub-xxx.r2.dev/videos/task-123.mp4"
    }
  ]
}
```

### æ–¹æ³• 3: é€šè¿‡ S3 å…¼å®¹ API

```bash
# ä½¿ç”¨ AWS CLI æˆ– S3 å®¢æˆ·ç«¯å·¥å…·
aws s3 ls s3://sora2/videos/ \
  --endpoint-url https://2776117bb412e09a1d30cbe886cd3935.r2.cloudflarestorage.com
```

## ğŸ“Š å­˜å‚¨ä½¿ç”¨ç›‘æ§

### åœ¨ Cloudflare Dashboard æŸ¥çœ‹ï¼š

1. **R2 > sora2 > Overview**
   - æ€»å­˜å‚¨é‡
   - æ–‡ä»¶æ•°é‡
   - å­˜å‚¨è¶‹åŠ¿å›¾

2. **R2 > Usage**
   - å½“å‰å­˜å‚¨ä½¿ç”¨é‡
   - å­˜å‚¨æˆæœ¬ä¼°ç®—
   - å¸¦å®½ä½¿ç”¨æƒ…å†µ

### é€šè¿‡ API æ£€æŸ¥ï¼š

```bash
# æ¸…ç† API ä¼šæ˜¾ç¤ºæ‰¾åˆ°çš„æ–‡ä»¶
POST /api/admin/r2/cleanup
{
  "daysOld": 30,
  "dryRun": true
}
```

## ğŸ” å­˜å‚¨å®‰å…¨æ€§

### æ•°æ®å®‰å…¨ï¼š

- âœ… **åŠ å¯†å­˜å‚¨**ï¼šR2 ä½¿ç”¨æœåŠ¡å™¨ç«¯åŠ å¯†
- âœ… **è®¿é—®æ§åˆ¶**ï¼šé€šè¿‡ API Token æ§åˆ¶è®¿é—®
- âœ… **å…¬å…±è®¿é—®æ§åˆ¶**ï¼šå¯è®¾ç½®å­˜å‚¨æ¡¶ä¸ºç§æœ‰æˆ–å…¬å…±
- âœ… **å¤‡ä»½å†—ä½™**ï¼šè‡ªåŠ¨å¤šæ•°æ®ä¸­å¿ƒå¤‡ä»½

### å½“å‰é…ç½®ï¼š

- å­˜å‚¨æ¡¶å·²å¯ç”¨å…¬å…±è®¿é—®ï¼ˆç”¨äºå…¬å…± URL è®¿é—®ï¼‰
- ä½¿ç”¨ API Token è¿›è¡Œç®¡ç†æ“ä½œï¼ˆä¸Šä¼ /åˆ é™¤ï¼‰
- æ•°æ®åŠ å¯†å­˜å‚¨åœ¨ Cloudflare æ•°æ®ä¸­å¿ƒ

## ğŸ’¾ æ•°æ®æŒä¹…æ€§

### R2 çš„ä¿è¯ï¼š

- **99.999999999% (11ä¸ª9)** çš„æŒä¹…æ€§
- è‡ªåŠ¨æ•°æ®å¤‡ä»½å’Œå†—ä½™
- å³ä½¿æ•°æ®ä¸­å¿ƒæ•…éšœï¼Œæ•°æ®ä»ç„¶å®‰å…¨

## ğŸš€ è®¿é—®é€Ÿåº¦

### CDN åŠ é€Ÿï¼š

é€šè¿‡ `pub-2868c824f92441499577980a0b61114c.r2.dev` è®¿é—®æ—¶ï¼š
- âœ… è‡ªåŠ¨é€šè¿‡ Cloudflare CDN åŠ é€Ÿ
- âœ… æ ¹æ®ç”¨æˆ·ä½ç½®è‡ªåŠ¨é€‰æ‹©æœ€è¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹
- âœ… å…¨çƒä½å»¶è¿Ÿè®¿é—®

## ğŸ“ æ€»ç»“

**R2 è§†é¢‘å­˜å‚¨ä½ç½®**ï¼š

1. **ç‰©ç†ä½ç½®**ï¼šCloudflare å…¨çƒåˆ†å¸ƒå¼æ•°æ®ä¸­å¿ƒï¼ˆè‡ªåŠ¨åˆ†é…ï¼‰
2. **é€»è¾‘ä½ç½®**ï¼šå­˜å‚¨æ¡¶ `sora2` ä¸‹çš„ `videos/` æ–‡ä»¶å¤¹
3. **è®¿é—®æ–¹å¼**ï¼š
   - å…¬å…± URLï¼š`https://pub-xxx.r2.dev/videos/xxx.mp4`
   - ç®¡ç†ç•Œé¢ï¼šCloudflare Dashboard > R2 > sora2
   - API ç®¡ç†ï¼šé€šè¿‡ S3 å…¼å®¹ API æˆ–é¡¹ç›® API

**å…³é”®ç‚¹**ï¼š
- ğŸŒ å…¨çƒåˆ†å¸ƒå¼å­˜å‚¨ï¼Œä¸ç»‘å®šç‰¹å®šåŒºåŸŸ
- ğŸ”’ è‡ªåŠ¨åŠ å¯†å’Œå¤‡ä»½
- âš¡ CDN åŠ é€Ÿè®¿é—®
- ğŸ’° æŒ‰å­˜å‚¨é‡è®¡è´¹ï¼ˆ$0.015/GB/æœˆï¼‰

## ğŸ”— ç›¸å…³é“¾æ¥

- [Cloudflare Dashboard](https://dash.cloudflare.com/)
- [R2 å­˜å‚¨æ¡¶ç®¡ç†](https://dash.cloudflare.com/?to=/:account/r2)
- [R2 æ–‡æ¡£](https://developers.cloudflare.com/r2/)

