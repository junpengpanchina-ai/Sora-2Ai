# 首页管理功能改进说明

## ✅ 已完成的改进

### 1. 支付计划管理 ✅

**位置**: 管理员后台 > 首页管理标签页 > 支付计划管理部分

支付计划管理功能已经集成在首页管理页面中，位于页面底部。如果看不到，请向下滚动页面。

**功能包括**:
- ✅ 查看所有支付计划
- ✅ 编辑计划（名称、价格、描述、Stripe按钮ID等）
- ✅ 添加新计划
- ✅ 启用/禁用计划
- ✅ 标记推荐计划
- ✅ 显示顺序控制

**管理字段**:
- 计划名称
- 计划类型（Basic/Professional/Custom）
- 价格（美元）
- 视频数量
- 积分数量
- 描述文本
- 徽章文本（如 "Recommended"）
- Stripe Buy Button ID
- Stripe Payment Link ID
- 启用/禁用状态
- 推荐标记

### 2. 圣诞节风格支持 ✅

**位置**: 管理员后台 > 首页管理标签页 > 风格配置 > 主题风格

已在风格配置中添加圣诞节风格选项。

**更新内容**:
- ✅ 数据库支持圣诞节风格（`theme_style` 字段支持 'christmas' 值）
- ✅ 管理界面下拉菜单添加了 "Christmas（圣诞节风格）🎄" 选项
- ✅ 与现有的圣诞节主题样式兼容

**使用说明**:
1. 在风格配置中选择 "Christmas（圣诞节风格）🎄"
2. 保存配置
3. 首页将应用圣诞节主题样式（红绿色调、雪花、灯光效果）

### 3. 图片和视频管理 - 九宫格展示 ✅

**位置**: 管理员后台 > 首页管理标签页 > 图片配置 / 视频配置

已将图片和视频管理改为九宫格展示，更便于统一管理。

**改进内容**:
- ✅ 图片管理改为 3x3 网格布局（九宫格）
- ✅ 视频管理改为 3x3 网格布局（九宫格）
- ✅ 每个格子显示：
  - 图片/视频预览（正方形缩略图）
  - 路径选择下拉菜单
  - Alt文本输入（仅图片）
  - 上传按钮
  - 删除按钮（右上角）

**优势**:
- 视觉上更统一
- 可以快速浏览所有图片/视频
- 操作更直观
- 节省页面空间

## 📋 使用指南

### 访问支付计划管理

1. 登录管理员后台
2. 点击顶部导航栏的 **"首页管理"** 标签
3. **向下滚动**到页面底部
4. 找到 **"支付计划管理"** 卡片

### 管理支付计划

1. **查看计划**: 在支付计划管理卡片中查看所有计划列表
2. **编辑计划**: 
   - 点击计划右侧的 **"编辑"** 按钮
   - 修改所需字段
   - 点击 **"保存"**
3. **添加计划**:
   - 点击右上角的 **"+ 添加计划"** 按钮
   - 填写计划信息
   - 点击 **"创建计划"**
4. **启用/禁用**: 在编辑模式下勾选或取消勾选"启用"选项

### 管理图片（九宫格）

1. 在"图片配置"部分，可以看到九宫格布局
2. 每个格子代表一张图片
3. 操作：
   - **选择图片**: 点击下拉菜单选择R2中的图片
   - **上传新图片**: 点击"上传"按钮选择本地图片
   - **设置Alt文本**: 在文本框中输入描述
   - **删除图片**: 点击右上角的 × 按钮
4. 添加更多图片：点击 **"+ 添加图片"** 按钮

### 管理视频（九宫格）

1. 在"视频配置"部分，可以看到九宫格布局
2. 每个格子代表一个视频
3. 操作：
   - **选择视频**: 点击下拉菜单选择R2中的视频
   - **上传新视频**: 点击"上传"按钮选择本地视频
   - **删除视频**: 点击右上角的 × 按钮
4. 添加更多视频：点击 **"+ 添加视频"** 按钮

### 切换圣诞节风格

1. 在"风格配置"部分，找到"主题风格"下拉菜单
2. 选择 **"Christmas（圣诞节风格）🎄"**
3. 点击页面底部的 **"保存配置"** 按钮
4. 首页将应用圣诞节主题

## 🎯 注意事项

### 支付计划管理

- 支付计划管理位于页面底部，需要向下滚动才能看到
- 如果看不到，请确保：
  1. 已执行数据库迁移 `029_create_payment_plans.sql`
  2. 已登录管理员账户
  3. 已进入"首页管理"标签页

### 九宫格展示

- 九宫格最多显示 9 个项目，超出部分会换行显示
- 每个格子的大小是固定的（aspect-square），保持视觉统一
- 删除操作需要确认（点击右上角 × 按钮）

### 圣诞节风格

- 圣诞节风格需要前端代码支持才能生效
- 如果应用后首页没有变化，需要检查前端组件是否支持 `theme_style === 'christmas'`
- 可以参考 `components/ChristmasBGM.tsx` 和 `CHRISTMAS_THEME_GUIDE.md` 了解实现细节

## 📝 数据库迁移

需要执行以下迁移：

1. **028_create_homepage_settings.sql** - 首页配置表（已更新，支持圣诞节风格）
2. **029_create_payment_plans.sql** - 支付计划表

在 Supabase SQL Editor 中执行这些迁移文件。

## 🔍 故障排除

### 看不到支付计划管理？

1. ✅ 确认已进入"首页管理"标签页
2. ✅ 向下滚动到页面底部
3. ✅ 确认已执行数据库迁移
4. ✅ 刷新页面（Ctrl+R 或 Cmd+R）

### 九宫格显示不正常？

1. ✅ 确认浏览器支持 CSS Grid
2. ✅ 清除浏览器缓存
3. ✅ 检查是否有图片/视频路径错误

### 圣诞节风格不生效？

1. ✅ 确认数据库中 `theme_style` 字段已更新为 'christmas'
2. ✅ 确认前端代码支持圣诞节主题渲染
3. ✅ 检查首页组件是否正确读取配置

