# æ‰¹é‡æ›´æ–° Purchase Intent - è‡ªåŠ¨åŒ–æ–¹æ¡ˆ

> **é—®é¢˜**: æ‰‹åŠ¨æ‰§è¡Œ 41 æ¬¡å¤ªéº»çƒ¦  
> **è§£å†³æ–¹æ¡ˆ**: 3 ç§è‡ªåŠ¨åŒ–æ–¹æ¡ˆï¼Œä»»é€‰å…¶ä¸€

---

## ğŸš€ æ–¹æ¡ˆ 1ï¼šSQL è‡ªåŠ¨å¾ªç¯ï¼ˆæœ€ç®€å•ï¼Œæ¨èï¼‰

### æ‰§è¡Œæ­¥éª¤

1. æ‰“å¼€ Supabase Dashboard â†’ SQL Editor
2. å¤åˆ¶å¹¶æ‰§è¡Œ `database/migrations/batch_update_purchase_intent_auto.sql` ä¸­çš„**æ–¹æ¡ˆ 1**ï¼ˆDO å—ï¼‰

### ä¼˜ç‚¹

- âœ… ä¸€æ¬¡æ‰§è¡Œï¼Œè‡ªåŠ¨å®Œæˆæ‰€æœ‰æ‰¹æ¬¡
- âœ… è‡ªåŠ¨æ˜¾ç¤ºè¿›åº¦
- âœ… è‡ªåŠ¨åœæ­¢ï¼ˆå½“æ²¡æœ‰æ›´å¤šè®°å½•æ—¶ï¼‰
- âœ… æ— éœ€é¢å¤–é…ç½®

### æ‰§è¡Œæ—¶é—´

- é¢„è®¡ï¼š5-10 åˆ†é’Ÿï¼ˆå–å†³äºæ•°æ®åº“æ€§èƒ½ï¼‰
- æ¯æ‰¹ 5,000 æ¡ï¼Œå»¶è¿Ÿ 0.5 ç§’

### è¾“å‡ºç¤ºä¾‹

```
NOTICE:  ğŸš€ å¼€å§‹æ‰¹é‡æ›´æ–° Purchase Intent...
NOTICE:  æ‰¹æ¬¡å¤§å°: 5000 æ¡
NOTICE:  ç¬¬ 1 æ‰¹: æ›´æ–° 5000 æ¡ï¼Œç´¯è®¡ 5000 æ¡
NOTICE:  ç¬¬ 2 æ‰¹: æ›´æ–° 5000 æ¡ï¼Œç´¯è®¡ 10000 æ¡
...
NOTICE:  âœ… æ‰€æœ‰è®°å½•å·²æ›´æ–°å®Œæˆï¼
NOTICE:  ğŸ‰ æ‰¹é‡æ›´æ–°å®Œæˆï¼æ€»å…±æ›´æ–° 203062 æ¡è®°å½•ï¼Œæ‰§è¡Œ 41 æ‰¹æ¬¡
```

---

## ğŸ”§ æ–¹æ¡ˆ 2ï¼šå­˜å‚¨è¿‡ç¨‹ï¼ˆæ›´çµæ´»ï¼‰

### æ‰§è¡Œæ­¥éª¤

1. å…ˆæ‰§è¡Œ `batch_update_purchase_intent_auto.sql` ä¸­çš„**æ–¹æ¡ˆ 2**ï¼ˆåˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼‰
2. ç„¶åæ‰§è¡Œï¼š
   ```sql
   SELECT * FROM batch_update_purchase_intent_auto(5000, 50);
   ```

### ä¼˜ç‚¹

- âœ… å¯ä»¥é‡å¤è°ƒç”¨
- âœ… å¯ä»¥è°ƒæ•´æ‰¹æ¬¡å¤§å°
- âœ… è¿”å›è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯

### ä½¿ç”¨åœºæ™¯

- éœ€è¦å¤šæ¬¡è¿è¡Œ
- éœ€è¦è°ƒæ•´å‚æ•°
- éœ€è¦è·å–è¯¦ç»†ç»“æœ

---

## âš¡ æ–¹æ¡ˆ 3ï¼šä¸€æ¬¡æ€§æ›´æ–°ï¼ˆæœ€å¿«ï¼Œä½†å¯èƒ½è¶…æ—¶ï¼‰

### æ‰§è¡Œæ­¥éª¤

1. æ‰§è¡Œ `database/migrations/batch_update_purchase_intent_one_shot.sql`

### ä¼˜ç‚¹

- âœ… æœ€å¿«ï¼ˆå¦‚æœæˆåŠŸï¼‰
- âœ… ä¸€æ¬¡æ‰§è¡Œå®Œæˆ

### ç¼ºç‚¹

- âš ï¸ å¯èƒ½è¶…æ—¶ï¼ˆå–å†³äºæ•°æ®åº“æ€§èƒ½ï¼‰
- âš ï¸ å¦‚æœè¶…æ—¶ï¼Œéœ€è¦å›é€€åˆ°æ–¹æ¡ˆ 1

### å»ºè®®

- å…ˆå°è¯•è¿™ä¸ªæ–¹æ¡ˆ
- å¦‚æœè¶…æ—¶ï¼Œä½¿ç”¨æ–¹æ¡ˆ 1

---

## ğŸ“ æ–¹æ¡ˆ 4ï¼šTypeScript è„šæœ¬ï¼ˆé€‚åˆ CI/CDï¼‰

### æ‰§è¡Œæ­¥éª¤

```bash
npm run batch-update-intent
```

### å‰ææ¡ä»¶

1. ç¡®ä¿ `.env.local` ä¸­æœ‰ï¼š
   ```env
   NEXT_PUBLIC_SUPABASE_URL=...
   SUPABASE_SERVICE_ROLE_KEY=...
   ```

2. éœ€è¦åˆ›å»º RPC å‡½æ•°ï¼ˆå¯é€‰ï¼Œå¦‚æœä½¿ç”¨è„šæœ¬ï¼‰

### ä¼˜ç‚¹

- âœ… å¯ä»¥é›†æˆåˆ° CI/CD
- âœ… å¯ä»¥æ·»åŠ æ›´å¤šé€»è¾‘
- âœ… å¯ä»¥è®°å½•æ—¥å¿—

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

### ç¬¬ä¸€æ¬¡æ‰§è¡Œ

**æ¨èï¼šæ–¹æ¡ˆ 1ï¼ˆSQL è‡ªåŠ¨å¾ªç¯ï¼‰**

ç†ç”±ï¼š
- æœ€ç®€å•
- æ— éœ€é¢å¤–é…ç½®
- è‡ªåŠ¨æ˜¾ç¤ºè¿›åº¦
- è‡ªåŠ¨åœæ­¢

### å¦‚æœæ–¹æ¡ˆ 1 è¶…æ—¶

**å¤‡é€‰ï¼šæ–¹æ¡ˆ 3ï¼ˆä¸€æ¬¡æ€§æ›´æ–°ï¼‰**

å…ˆå°è¯•ä¸€æ¬¡æ€§æ›´æ–°ï¼Œå¦‚æœè¶…æ—¶å†å›é€€åˆ°æ–¹æ¡ˆ 1ã€‚

---

## ğŸ“Š æ‰§è¡Œå‰æ£€æŸ¥

```sql
-- æŸ¥çœ‹éœ€è¦æ›´æ–°çš„è®°å½•æ•°
SELECT COUNT(*) as remaining
FROM page_meta
WHERE page_type = 'use_case'
  AND status = 'published'
  AND purchase_intent = 0;
```

---

## âœ… æ‰§è¡ŒåéªŒè¯

```sql
-- æŸ¥çœ‹æ›´æ–°ç»“æœåˆ†å¸ƒ
SELECT 
  purchase_intent,
  layer,
  COUNT(*) as count
FROM page_meta
WHERE page_type = 'use_case'
  AND status = 'published'
  AND purchase_intent > 0
GROUP BY purchase_intent, layer
ORDER BY purchase_intent DESC, layer;
```

**é¢„æœŸç»“æœ**ï¼š
- Intent 3: ~X æ¡ï¼ˆproduct-demo-showcase, advertising-promotionï¼‰
- Intent 2: ~Y æ¡ï¼ˆeducation-explainer, ugc-creator-contentï¼‰
- Intent 1: ~Z æ¡ï¼ˆbrand-storytellingï¼‰
- Intent 0: ~W æ¡ï¼ˆsocial-media-contentï¼‰

---

## ğŸš¨ å¦‚æœé‡åˆ°é—®é¢˜

### é—®é¢˜ 1ï¼šè¶…æ—¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆè‡ªåŠ¨å¾ªç¯ï¼‰ï¼Œæ‰¹æ¬¡å¤§å°æ”¹ä¸º 3000 æˆ– 2000
- å¢åŠ  `pg_sleep` æ—¶é—´åˆ° 1 ç§’

### é—®é¢˜ 2ï¼šé”è¡¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨ä½å³°æœŸæ‰§è¡Œ
- å¢åŠ  `pg_sleep` æ—¶é—´

### é—®é¢˜ 3ï¼šå†…å­˜ä¸è¶³

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å‡å°æ‰¹æ¬¡å¤§å°ï¼ˆ3000 æˆ– 2000ï¼‰
- ä½¿ç”¨æ–¹æ¡ˆ 1ï¼ˆè‡ªåŠ¨å¾ªç¯ï¼‰

---

## ğŸ“ æ–‡ä»¶ä½ç½®

- **æ–¹æ¡ˆ 1**: `database/migrations/batch_update_purchase_intent_auto.sql`ï¼ˆDO å—ï¼‰
- **æ–¹æ¡ˆ 2**: `database/migrations/batch_update_purchase_intent_auto.sql`ï¼ˆå­˜å‚¨è¿‡ç¨‹ï¼‰
- **æ–¹æ¡ˆ 3**: `database/migrations/batch_update_purchase_intent_one_shot.sql`
- **æ–¹æ¡ˆ 4**: `scripts/batch-update-purchase-intent.ts`

---

## âœ… æ€»ç»“

**æœ€ç®€å•çš„æ–¹æ³•**ï¼šæ‰§è¡Œ `batch_update_purchase_intent_auto.sql` ä¸­çš„æ–¹æ¡ˆ 1ï¼ˆDO å—ï¼‰ï¼Œä¸€æ¬¡å®Œæˆæ‰€æœ‰æ›´æ–°ã€‚

**é¢„è®¡æ—¶é—´**ï¼š5-10 åˆ†é’Ÿ

**æ— éœ€æ‰‹åŠ¨æ“ä½œ**ï¼šè‡ªåŠ¨å¾ªç¯ï¼Œè‡ªåŠ¨åœæ­¢ã€‚

