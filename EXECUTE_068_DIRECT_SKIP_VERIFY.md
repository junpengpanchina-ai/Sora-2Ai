# ⚡ 执行 068_setup_scene_data_direct.sql（跳过验证查询）

## 🚨 问题

执行 `068_setup_scene_data_direct.sql` 时，验证查询超时。

## ✅ 解决方案

**可以跳过验证查询，只执行 DO $$ 块（设置部分）**

DO $$ 块通常不会超时，因为它只是 UPDATE 操作。验证查询可以跳过，因为 DO $$ 块中的 NOTICE 消息已经显示了设置成功的场景数量。

---

## 📋 执行步骤

### 方法 1：只执行 DO $$ 块（推荐）

在 Supabase SQL Editor 中：

1. 打开 `068_setup_scene_data_direct.sql`
2. **只选择并执行两个 DO $$ ... END $$;** 块（第 12-24 行和第 30-43 行）
3. 查看执行结果中的 NOTICE 消息

**预期输出**：
```
NOTICE: ✅ 为 X 个场景设置了 in_sitemap = TRUE
NOTICE: ✅ 为 X 个场景设置了初始 AI 分数 0.7
```

**✅ 如果看到这两个消息**，说明设置成功，可以跳过验证查询。

### 方法 2：执行整个文件但忽略验证查询超时

1. 执行整个文件 `068_setup_scene_data_direct.sql`
2. 如果验证查询超时，忽略错误
3. 查看 NOTICE 消息确认设置成功

---

## 🎯 推荐执行步骤

1. **执行两个 DO $$ 块**（第 12-24 行和第 30-43 行）
   - 查看 NOTICE 消息确认设置成功
   - 应该看到 "✅ 为 X 个场景设置了..."

2. **确认成功**：
   - 如果看到两个 NOTICE 消息，说明设置成功
   - 不需要验证查询

3. **完成**：
   - 场景数据已设置完成
   - `in_sitemap = TRUE` 和 AI 分数已设置

---

## 💡 为什么可以跳过验证查询？

1. **DO $$ 块已经显示统计信息**：NOTICE 消息中已经显示了设置成功的场景数量
2. **UPDATE 操作不会超时**：DO $$ 块中的 UPDATE 操作通常很快完成
3. **验证查询不是必需的**：如果设置成功（看到 NOTICE 消息），就可以继续下一步

---

## ✅ 执行清单

- [ ] **步骤 1**：执行两个 DO $$ 块（第 12-24 行和第 30-43 行）
- [ ] **步骤 2**：查看 NOTICE 消息，确认看到两个 "✅ 为 X 个场景设置了..."
- [ ] **完成**：场景数据已设置完成

---

## 🚀 开始执行

1. **打开文件**：`supabase/migrations/068_setup_scene_data_direct.sql`
2. **只选择并执行两个 DO $$ 块**（第 12-24 行和第 30-43 行）
3. **查看 NOTICE 消息**，确认设置成功
4. **完成**！

即使验证查询超时，只要 DO $$ 块执行成功（看到 NOTICE 消息），就可以认为设置成功了！
