(()=>{var e={};e.id=7478,e.ids=[7478],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78272:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>c.Z,__next_app__:()=>u,originalPathname:()=>o,pages:()=>d,routeModule:()=>m,tree:()=>l}),t(22317),t(89866),t(11506),t(26083),t(35866);var s=t(23191),a=t(88716),c=t(48001),n=t(95231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);t.d(r,i);let l=["",{children:["payment",{children:["success",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,22317)),"/Users/p/Documents/GitHub/Sora-2Ai/app/payment/success/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,89866)),"/Users/p/Documents/GitHub/Sora-2Ai/app/payment/success/layout.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,11506)),"/Users/p/Documents/GitHub/Sora-2Ai/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,26083)),"/Users/p/Documents/GitHub/Sora-2Ai/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/p/Documents/GitHub/Sora-2Ai/app/payment/success/page.tsx"],o="/payment/success/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/payment/success/page",pathname:"/payment/success",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},3076:(e,r,t)=>{Promise.resolve().then(t.bind(t,31696))},35303:()=>{},31696:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(10326),a=t(17577),c=t(35047),n=t(90434),i=t(985),l=t(83850);function d(){let e=(0,c.useSearchParams)(),r=e.get("session_id"),t=e.get("recharge_id"),[d,o]=(0,a.useState)("checking"),[u,m]=(0,a.useState)(null),[p,g]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[y,f]=(0,a.useState)(0),b=(0,l.r4)()||"/video",j=(0,a.useCallback)(async()=>{if(r)try{let e=await fetch(`/api/payment/check-session?session_id=${r}`),t=await e.json();if(!e.ok){o("error"),h(t.error||"Failed to check payment status");return}if(!t.success){o("failed"),h(t.message||"Payment not completed");return}g({amount:t.recharge_record?.amount,credits:t.recharge_record?.credits,status:t.recharge_record?.status}),m(t.user_credits),"completed"===t.recharge_status?o("completed"):"pending"===t.recharge_status?o("processing"):(o("error"),h("Recharge status abnormal"))}catch(e){console.error("Failed to check payment status:",e),o("error"),h("Error occurred while checking payment status")}},[r]),k=(0,a.useCallback)(async()=>{if(t)try{let e=await fetch(`/api/payment/check-recharge?recharge_id=${t}`),r=await e.json();if(!e.ok){o("error"),h(r.error||"Failed to check recharge status");return}r.success&&(g({amount:r.recharge_record?.amount,credits:r.recharge_record?.credits,status:r.recharge_record?.status}),m(r.user_credits),"completed"===r.recharge_status?o("completed"):"pending"===r.recharge_status?o("processing"):(o("error"),h("Recharge status abnormal")))}catch(e){console.error("Failed to check recharge status:",e),o("error"),h("Error occurred while checking recharge status")}},[t]);return s.jsx("div",{className:"min-h-screen bg-energy-hero dark:bg-energy-hero-dark flex items-center justify-center p-4",children:(0,s.jsxs)(i.Zb,{className:"w-full max-w-md",children:[s.jsx(i.Ol,{children:(0,s.jsxs)(i.ll,{className:"text-center text-2xl",children:["completed"===d&&s.jsx("span",{className:"text-green-600 dark:text-green-400",children:"✓"}),"processing"===d&&s.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 animate-pulse",children:"⏳"}),"checking"===d&&s.jsx("span",{className:"text-blue-600 dark:text-blue-400 animate-pulse",children:"⏳"}),"failed"===d&&s.jsx("span",{className:"text-red-600 dark:text-red-400",children:"✗"}),"error"===d&&s.jsx("span",{className:"text-red-600 dark:text-red-400",children:"⚠"})," ","completed"===d&&"Payment Successful","processing"===d&&"Processing...","checking"===d&&"Verifying...","failed"===d&&"Payment Failed","error"===d&&"Error Occurred"]})}),(0,s.jsxs)(i.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center",children:["completed"===d&&s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Your recharge has been successfully processed, credits have been added to your account."}),"processing"===d&&s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Payment confirmed, processing credits, please wait..."}),"checking"===d&&s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Verifying payment status..."}),("failed"===d||"error"===d)&&x&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/30 rounded-lg border border-red-200 dark:border-red-800",children:s.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:x})}),p&&(0,s.jsxs)("div",{className:"mb-4 rounded-lg bg-energy-water-surface p-4 dark:bg-energy-water-muted/30",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"Recharge Information"}),(0,s.jsxs)("p",{className:"text-lg font-semibold text-energy-water dark:text-energy-soft",children:["$",p.amount," → ",p.credits," Credits"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Status: ","completed"===p.status?"Completed":"pending"===p.status?"Processing":p.status||"Unknown"]})]}),null!==u&&(0,s.jsxs)("div",{className:"mb-4 rounded-lg bg-energy-water-surface p-4 dark:bg-energy-water-muted/30",children:[s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Current Credits Balance"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-energy-water dark:text-energy-soft",children:[u," Credits"]})]}),r&&(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mb-4",children:["Order ID: ",r.substring(0,20),"..."]}),"processing"===d&&s.jsx("div",{className:"mb-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-500",children:[s.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-energy-water"}),(0,s.jsxs)("span",{children:["Waiting for credits... (",y,"/30)"]})]})})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[("error"===d||"processing"===d)&&s.jsx(i.zx,{variant:"primary",className:"flex-1",onClick:()=>{f(0),o("checking"),h(null),t&&!r?k():r&&j()},children:"Refresh Status"}),s.jsx(n.default,{href:"/",className:"flex-1",children:s.jsx(i.zx,{variant:"primary",className:"w-full",children:"Back to Home"})}),"completed"===d&&s.jsx(n.default,{href:b,className:"flex-1",children:s.jsx(i.zx,{variant:"secondary",className:"w-full",children:"Generate Video"})})]})]})]})})}},83850:(e,r,t)=>{"use strict";t.d(r,{Ko:()=>c,r4:()=>n});let s="s2ai_post_login_redirect";function a(e){if(!e)return null;let r=String(e).trim();return!r||!r.startsWith("/")||r.startsWith("//")||r.includes("://")||r.startsWith("/auth/callback")||r.startsWith("/login")?null:r}function c(e){let r=a(e);if(r){try{"undefined"!=typeof sessionStorage&&sessionStorage.setItem(s,r)}catch{}try{"undefined"!=typeof localStorage&&localStorage.setItem(s,r)}catch{}}}function n(){let e=null;try{"undefined"!=typeof sessionStorage&&(e=sessionStorage.getItem(s))}catch{}if(!e)try{"undefined"!=typeof localStorage&&(e=localStorage.getItem(s))}catch{}return a(e)}},90434:(e,r,t)=>{"use strict";t.d(r,{default:()=>a.a});var s=t(79404),a=t.n(s)},89866:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n,dynamic:()=>a,revalidate:()=>c});var s=t(19510);let a="force-dynamic",c=0;function n({children:e}){return s.jsx(s.Fragment,{children:e})}},22317:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`/Users/p/Documents/GitHub/Sora-2Ai/app/payment/success/page.tsx#default`)},97049:(e,r,t)=>{"use strict";e.exports=t(23191).vendored["react-rsc"].ReactDOM},51749:(e,r,t)=>{"use strict";e.exports=t(23191).vendored["react-rsc"].ReactServerDOMWebpackServerEdge},38238:(e,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return t}});class t{static get(e,r,t){let s=Reflect.get(e,r,t);return"function"==typeof s?s.bind(e):s}static set(e,r,t,s){return Reflect.set(e,r,t,s)}static has(e,r){return Reflect.has(e,r)}static deleteProperty(e,r){return Reflect.deleteProperty(e,r)}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,111,5266],()=>t(78272));module.exports=s})();