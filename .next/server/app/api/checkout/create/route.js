"use strict";(()=>{var e={};e.id=67,e.ids=[67,6299],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},61282:e=>{e.exports=require("child_process")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},21764:e=>{e.exports=require("util")},86269:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>k,patchFetch:()=>f,requestAsyncStorage:()=>v,routeModule:()=>_,serverHooks:()=>y,staticGenerationAsyncStorage:()=>x});var n={};t.r(n),t.d(n,{POST:()=>h,runtime:()=>d});var s=t(49303),i=t(88716),o=t(60670),a=t(87070),u=t(37857),c=t(76299),p=t(69206);let d="nodejs",l=(0,p.d)(),m=(0,u.eI)("https://hgzpzsiafycwlqrkzbis.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function h(e){try{let r=await e.json(),t=r.planId,n=r.deviceId??null;if(!t)return a.NextResponse.json({error:"missing_planId"},{status:400});let s=c.v0[t];if(!s)return a.NextResponse.json({error:"invalid_plan"},{status:400});let i=e.headers.get("authorization"),o=i?.startsWith("Bearer ")?i.slice(7):null;if(!o)return a.NextResponse.json({error:"missing_auth_token"},{status:401});let{data:u,error:p}=await m.auth.getUser(o);if(p||!u?.user)return a.NextResponse.json({error:"unauthorized"},{status:401});let d=u.user.id,h=e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()||e.headers.get("x-real-ip")||e.headers.get("cf-connecting-ip"),_=function(e){if(!e)return null;let r=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/);return r?`${r[1]}.${r[2]}.${r[3]}.0/24`:null}(h),v="http://sora2aivideos.com",x=await l.checkout.sessions.create({mode:"payment",line_items:[{price_data:{currency:"usd",product_data:{name:s.displayName},unit_amount:Math.round(100*s.priceUsd)},quantity:1}],client_reference_id:d,metadata:{user_id:d,plan_id:t,amount_usd:s.priceUsd.toString(),device_id:n??"",ip_prefix:_??""},success_url:`${v}/billing/success?session_id={CHECKOUT_SESSION_ID}`,cancel_url:`${v}/pricing?canceled=1`,allow_promotion_codes:!0});return a.NextResponse.json({url:x.url})}catch(r){console.error("[checkout/create] Error:",r);let e=r instanceof Error?r.message:"Unknown error";return a.NextResponse.json({error:"checkout_create_failed",message:e},{status:500})}}let _=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/checkout/create/route",pathname:"/api/checkout/create",filename:"route",bundlePath:"app/api/checkout/create/route"},resolvedPagePath:"/Users/p/Documents/GitHub/Sora-2Ai/app/api/checkout/create/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:v,staticGenerationAsyncStorage:x,serverHooks:y}=_,k="/api/checkout/create/route";function f(){return(0,o.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:x})}},76299:(e,r,t)=>{t.d(r,{planFromPaymentLink:()=>s,v0:()=>n});let n={starter:{planId:"starter",displayName:"Starter Access",priceUsd:4.9,paymentLinkId:"plink_1SjMNLDqGbi6No9vUku66neA",permanentCredits:0,bonusCredits:200,bonusExpiresDays:7,allowVeoPro:!1,concurrency:1,dailyCaps:{sora:6,veo_fast:1}},creator:{planId:"creator",displayName:"Creator Pack",priceUsd:39,paymentLinkId:"plink_1SRxHLDqGbi6No9vhu7i5iud",permanentCredits:2e3,bonusCredits:600,bonusExpiresDays:14,allowVeoPro:!0,concurrency:2},studio:{planId:"studio",displayName:"Studio Pack",priceUsd:99,paymentLinkId:"plink_1SmxBiDqGbi6No9v4L6dFvvK",permanentCredits:6e3,bonusCredits:1500,bonusExpiresDays:30,allowVeoPro:!0,concurrency:3},pro:{planId:"pro",displayName:"Pro Pack",priceUsd:299,paymentLinkId:"plink_1SNF1zDqGbi6No9vqtJXYMhQ",permanentCredits:2e4,bonusCredits:4e3,bonusExpiresDays:60,allowVeoPro:!0,concurrency:5}};function s(e){return Object.values(n).find(r=>r.paymentLinkId===e)??null}},69206:(e,r,t)=>{t.d(r,{d:()=>i});var n=t(91988);let s=null;function i(){if(!s){let e=process.env.STRIPE_SECRET_KEY;if(!e)throw Error("STRIPE_SECRET_KEY is not set in environment variables");try{s=new n.Z(e,{apiVersion:"2025-10-29.clover"})}catch(e){throw console.error("[Stripe] Failed to initialize Stripe client:",e),Error(`Failed to initialize Stripe: ${e instanceof Error?e.message:"Unknown error"}`)}}return s}i()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[8948,7289,5972,1988],()=>t(86269));module.exports=n})();