(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5321],{2385:function(e,s,a){Promise.resolve().then(a.bind(a,9016))},9016:function(e,s,a){"use strict";a.d(s,{default:function(){return d}});var r=a(7437),t=a(2265),l=a(1055),i=a(3075),n=a(7648),c=a(3145);function d(){let[e,s]=(0,t.useState)(!1),[a,d]=(0,t.useState)([]),[x,o]=(0,t.useState)(null),[h,g]=(0,t.useState)(""),[m,y]=(0,t.useState)(null),[u,f]=(0,t.useState)(""),j=async e=>{s(!0),o(null);try{let s=new URLSearchParams({action:"list"});e&&s.append("prefix",e);let a=await fetch("/api/storage/test?".concat(s)),r=await a.json();r.success?d(r.files||[]):o(r.error||"Failed to list files"),y(r)}catch(e){o(e instanceof Error?e.message:"Failed to list files")}finally{s(!1)}},k=async e=>{if(!e){o("Please enter a file key");return}s(!0),o(null);try{let s=await fetch("/api/storage/test?action=check&key=".concat(encodeURIComponent(e))),a=await s.json();a.success?(y(a),a.exists&&f(a.url)):(o(a.error||"Failed to check file"),y(a))}catch(e){o(e instanceof Error?e.message:"Failed to check file")}finally{s(!1)}},b=async e=>{if(!e){o("Please enter a file key");return}s(!0),o(null);try{let s=await fetch("/api/storage/test?action=image&key=".concat(encodeURIComponent(e))),a=await s.json();a.success?(y(a),f(a.url)):(o(a.error||"Failed to get image URL"),y(a))}catch(e){o(e instanceof Error?e.message:"Failed to get image URL")}finally{s(!1)}},p=e=>{if(!e){o("Please enter a file key");return}let s=(0,i.WP)(e);f(s),y({success:!0,action:"quick",key:e,url:s,message:"URL generated using getPublicUrl() function"})};return(0,r.jsxs)("div",{className:"min-h-screen bg-energy-hero dark:bg-energy-hero-dark",children:[(0,r.jsx)("nav",{className:"border-b border-gray-200 bg-white/80 backdrop-blur-sm dark:border-gray-700 dark:bg-gray-800/80",children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(n.default,{href:"/",className:"text-xl font-bold text-gray-900 dark:text-white",children:"Sora2Ai Videos"}),(0,r.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"R2 Storage Test"})]}),(0,r.jsx)(n.default,{href:"/",children:(0,r.jsx)(l.zx,{variant:"secondary",size:"sm",children:"Back to Home"})})]})})}),(0,r.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 dark:text-white mb-2",children:"R2 Storage Test"}),(0,r.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-400",children:"Test accessing files from Cloudflare R2 storage"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Test Controls"})}),(0,r.jsxs)(l.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"List Files"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.zx,{variant:"secondary",onClick:()=>j(),disabled:e,children:"List All Files"}),(0,r.jsx)(l.zx,{variant:"secondary",onClick:()=>j("images/"),disabled:e,children:"List Images"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Test File Access"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),placeholder:"e.g., images/test.jpg",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 shadow-sm focus:border-energy-water focus:outline-none focus:ring-energy-water dark:border-gray-600 dark:bg-gray-700 dark:text-white"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.zx,{variant:"primary",onClick:()=>b(h),disabled:e||!h,children:"Get Image URL"}),(0,r.jsx)(l.zx,{variant:"secondary",onClick:()=>k(h),disabled:e||!h,children:"Check File"}),(0,r.jsx)(l.zx,{variant:"ghost",onClick:()=>p(h),disabled:e||!h,children:"Quick Test"})]})]})]}),x&&(0,r.jsx)(l.bZ,{variant:"error",children:x}),m&&(0,r.jsxs)("div",{className:"rounded-lg bg-gray-50 dark:bg-gray-800 p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Test Result"}),(0,r.jsx)("pre",{className:"text-xs text-gray-600 dark:text-gray-400 overflow-auto",children:JSON.stringify(m,null,2)})]})]})]}),(0,r.jsxs)(l.Zb,{children:[(0,r.jsx)(l.Ol,{children:(0,r.jsx)(l.ll,{children:"Image Preview"})}),(0,r.jsx)(l.aY,{children:u?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700",children:(0,r.jsx)(c.default,{src:u,alt:"R2 Image",width:800,height:450,className:"h-auto w-full",onError:()=>{o("Failed to load image. File may not exist or URL is incorrect.")},unoptimized:!0})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Image URL"}),(0,r.jsx)("p",{className:"text-sm text-gray-900 dark:text-white break-all",children:u}),(0,r.jsx)("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-block text-xs text-energy-water hover:text-energy-water-deep dark:text-energy-soft",children:"Open in new tab â†’"})]})]}):(0,r.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("p",{children:"No image URL yet"}),(0,r.jsx)("p",{className:"text-xs mt-2",children:'Enter a file key and click "Get Image URL"'})]})})]})]}),a.length>0&&(0,r.jsxs)(l.Zb,{className:"mt-6",children:[(0,r.jsx)(l.Ol,{children:(0,r.jsxs)(l.ll,{children:["Files List (",a.length,")"]})}),(0,r.jsx)(l.aY,{children:(0,r.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.key||"Unknown"}),e.size&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(e.size/1024).toFixed(2)," KB"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.url&&(0,r.jsx)(l.zx,{variant:"ghost",size:"sm",onClick:()=>{g(e.key||""),f(e.url||"")},children:"Load"}),e.url&&(0,r.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-energy-water hover:text-energy-water-deep dark:text-energy-soft",children:"Open"})]})]},s))})})]})]})]})}}},function(e){e.O(0,[2972,6137,4609,5726,5492,2971,2117,1744],function(){return e(e.s=2385)}),_N_E=e.O()}]);