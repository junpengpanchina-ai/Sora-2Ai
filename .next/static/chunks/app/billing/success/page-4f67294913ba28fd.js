(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3171],{5677:function(e,t,s){Promise.resolve().then(s.bind(s,176))},176:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l},dynamic:function(){return o}});var a=s(7437),r=s(2265),n=s(9376),i=s(7648);let o="force-dynamic";function c(){let e=(0,n.useSearchParams)(),t=(0,n.useRouter)(),s=e.get("session_id"),[o,c]=(0,r.useState)("loading"),[l,d]=(0,r.useState)("Finalizing your credits...");return(0,r.useEffect)(()=>{if(!s){c("error"),d("Missing session_id. Please contact support.");return}(async()=>{try{let e=await fetch("/api/billing/finalize",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({sessionId:s})}),a=await e.json().catch(()=>({}));e.ok&&(null==a?void 0:a.status)==="paid"?(null==a?void 0:a.purchaseApplied)?(c("ok"),d("✅ Payment confirmed! Credits have been added to your wallet. Redirecting..."),setTimeout(()=>t.push("/video"),1500)):(c("ok"),d("✅ Payment confirmed! Your credits are being processed and will appear shortly. Redirecting..."),setTimeout(()=>t.push("/video"),2e3)):(null==a?void 0:a.status)==="pending"?(c("ok"),d("⏳ Payment is being processed. Please wait a moment and refresh.")):(c("error"),d((null==a?void 0:a.error)||"Payment status unknown. Please contact support if you were charged."))}catch(e){c("error"),d("Network error. Please refresh the page or contact support.")}})()},[s,t]),(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-[#0a0a0a] via-[#1a1a1a] to-[#0a0a0a] text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Payment successful"}),(0,a.jsx)("p",{className:"text-lg text-white/80 mb-8",children:l}),"loading"===o&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-b-2 border-white"}),(0,a.jsx)("span",{className:"text-sm text-white/60",children:"Processing..."})]}),"error"===o&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-white/60",children:"Tip: Please make sure you are logged in on this device."}),(0,a.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,a.jsx)(i.default,{href:"/pricing",className:"px-6 py-3 rounded-xl border border-white/20 hover:bg-white/5 transition-colors",children:"Back to Pricing"}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 rounded-xl bg-white/10 hover:bg-white/20 transition-colors",children:"Retry"})]})]}),"ok"===o&&(0,a.jsx)(i.default,{href:"/video",className:"inline-block px-8 py-3 rounded-xl bg-gradient-to-r from-[#1f75ff] to-[#3f8cff] hover:opacity-90 transition-opacity font-semibold",children:"Start Creating"})]})})}function l(){return(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-[#0a0a0a] via-[#1a1a1a] to-[#0a0a0a] text-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"max-w-md mx-auto px-4 py-16 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Payment successful"}),(0,a.jsx)("p",{className:"text-lg text-white/80 mb-8",children:"Loading..."}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-b-2 border-white"}),(0,a.jsx)("span",{className:"text-sm text-white/60",children:"Processing..."})]})]})}),children:(0,a.jsx)(c,{})})}},7648:function(e,t,s){"use strict";s.d(t,{default:function(){return r.a}});var a=s(2972),r=s.n(a)},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},function(e){e.O(0,[2972,2971,2117,1744],function(){return e(e.s=5677)}),_N_E=e.O()}]);