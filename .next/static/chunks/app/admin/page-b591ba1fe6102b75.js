(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3,970],{1043:function(e,t,s){Promise.resolve().then(s.bind(s,7163))},7163:function(e,t,s){"use strict";s.d(t,{default:function(){return eH}});var a=s(7437),r=s(2265),n=s(9376),i=s(1055),l=s(7648),o=s(970);let d=["nature","character","action","scenery","abstract","cinematic"],c=["information","comparison","transaction"],u=["zh","en"];var m=s(3145),g=s(5525);function h(e){let{textInput:t,onTextInputChange:s,onRecognize:n,isRecognizing:l=!1,onShowBanner:o,maxImages:d=10}=e,[c,u]=(0,r.useState)([]),[h,p]=(0,r.useState)(!1),x=(0,r.useRef)(null),y=(0,r.useRef)(null),f=async e=>{if(e<0||e>=c.length)return;let t=c[e];if(!t.isProcessing){u(t=>{let s=[...t];return s[e]={...s[e],isProcessing:!0,progress:0},s}),p(!0);try{let a=await (0,g.createWorker)("eng+chi_sim+chi_tra+tha+ara+rus+slv+ron+spa+fra+deu+ita+por+nld+pol+ces+hun+ell+swe+nor+fin+bul",1,{logger:t=>{"recognizing text"===t.status&&u(s=>{let a=[...s];return a[e]={...a[e],progress:Math.round(100*t.progress)},a})}}),{data:{text:r}}=await a.recognize(t.file);await a.terminate();let n=r.trim();if(u(t=>{let s=[...t];return s[e]={...s[e],recognizedText:n,isProcessing:!1,progress:100},s}),!n){o("error","No text detected in image ".concat(e+1,"."));return}let i=c.map((t,s)=>s===e?n:t.recognizedText||"").filter(e=>e.trim()).join("\n\n");i.trim()&&(s(i),o("success","Image ".concat(e+1," recognized (").concat(n.length," characters).")))}catch(t){console.error("OCR recognition failed:",t),u(t=>{let s=[...t];return s[e]={...s[e],isProcessing:!1,progress:0},s}),o("error",t instanceof Error?t.message:"OCR recognition failed. Please try again.")}finally{p(c.some((t,s)=>s!==e&&t.isProcessing))}}},b=async()=>{if(0===c.length){o("error","Please add images first.");return}p(!0);for(let e=0;e<c.length;e++)c[e].recognizedText||c[e].isProcessing||await f(e);let e=c.map(e=>e.recognizedText||"").filter(e=>e.trim()).join("\n\n");e.trim()&&(s(e),o("success","Recognized ".concat(c.filter(e=>e.recognizedText).length," images."))),p(!1)},v=e=>{u(t=>t.filter((t,s)=>s!==e))};return(0,r.useEffect)(()=>{let e=async e=>{var t;let s=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(!s)return;let a=[];for(let t=0;t<s.length;t++){let r=s[t];if(r.type.startsWith("image/")){e.preventDefault();let t=r.getAsFile();if(!t)continue;if(t.size>10485760){o("error","".concat(t.name||"image"," exceeds 10MB."));continue}a.push(t)}}if(0===a.length)return;let r=d-c.length;if(r<=0){o("error","You can add up to ".concat(d," images."));return}let n=a.slice(0,r),i=[];for(let e of n){let t=new FileReader;t.onloadend=()=>{let s=t.result;u(t=>{let a=[...t],r=a.findIndex(t=>t.file===e);return r>=0&&(a[r]={...a[r],preview:s}),a})},t.readAsDataURL(e),i.push({file:e,preview:"",isProcessing:!1,progress:0})}i.length>0&&(u(e=>[...e,...i]),o("success","Pasted ".concat(i.length," images.")))};return document.addEventListener("paste",e),()=>{document.removeEventListener("paste",e)}},[o,c.length,d]),(0,a.jsxs)("div",{className:"text-recognition-area mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-950/30",children:[(0,a.jsx)("div",{className:"mb-2 flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\uD83D\uDCCB Text Recognition & Auto-fill"})}),(0,a.jsx)("p",{className:"mb-3 text-xs text-gray-600 dark:text-gray-400",children:"Supported inputs: (1) Paste images (Ctrl+V / Cmd+V) for OCR, (2) Upload images for OCR, (3) Paste plain text. The system will detect fields and auto-fill the form. Multi-language OCR is supported, and common notes/labels are filtered out."}),(0,a.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("input",{ref:x,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;if(!t||0===t.length)return;let s=[],a=d-c.length;if(a<=0){o("error","You can add up to ".concat(d," images."));return}for(let e of Array.from(t).slice(0,a)){if(!e.type.startsWith("image/")){o("error","".concat(e.name," is not an image file."));continue}if(e.size>10485760){o("error","".concat(e.name," exceeds 10MB."));continue}let t=new FileReader;t.onloadend=()=>{let s=t.result;u(t=>{let a=[...t],r=a.findIndex(t=>t.file===e);return r>=0&&(a[r]={...a[r],preview:s}),a})},t.readAsDataURL(e),s.push({file:e,preview:"",isProcessing:!1,progress:0})}s.length>0&&(u(e=>[...e,...s]),o("success","Added ".concat(s.length," images."))),x.current&&(x.current.value="")},className:"hidden",id:"image-upload",disabled:h||c.length>=d}),(0,a.jsxs)("label",{htmlFor:"image-upload",className:"flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium transition-colors ".concat(h||c.length>=d?"cursor-not-allowed border-gray-300 bg-gray-100 text-gray-400 dark:border-gray-600 dark:bg-gray-800":"cursor-pointer border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 dark:border-blue-600 dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800"),children:["\uD83D\uDCF7 Upload Images ",c.length>0&&"(".concat(c.length,"/").concat(d,")")]}),c.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:b,disabled:h,children:h?"Batch recognizing...":"\uD83D\uDD0D Recognize all images"}),(0,a.jsx)(i.zx,{type:"button",variant:"ghost",size:"sm",onClick:()=>{u([]),x.current&&(x.current.value="")},disabled:h,children:"✕ Clear all"})]})]}),c.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:c.map((e,t)=>(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white p-2 dark:border-gray-700 dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"absolute -top-2 -right-2 z-10 flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-xs font-bold text-white",children:t+1}),e.preview&&(0,a.jsxs)("div",{className:"relative aspect-square w-full overflow-hidden rounded",children:[(0,a.jsx)(m.default,{src:e.preview,alt:"Preview ".concat(t+1),width:200,height:200,className:"h-full w-full object-cover",unoptimized:!0}),e.isProcessing&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"text-center text-white",children:[(0,a.jsx)("div",{className:"mb-1 text-xs",children:"Recognizing..."}),(0,a.jsx)("div",{className:"h-1 w-20 overflow-hidden rounded-full bg-gray-700",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:"".concat(e.progress,"%")}})})]})}),e.recognizedText&&!e.isProcessing&&(0,a.jsx)("div",{className:"absolute top-1 left-1 rounded bg-green-500 px-1.5 py-0.5 text-xs font-medium text-white",children:"✓"})]}),(0,a.jsxs)("div",{className:"mt-2 flex gap-1",children:[!e.recognizedText&&!e.isProcessing&&(0,a.jsx)(i.zx,{type:"button",variant:"ghost",size:"sm",className:"flex-1 text-xs",onClick:()=>f(t),disabled:h,children:"Recognize"}),(0,a.jsx)(i.zx,{type:"button",variant:"ghost",size:"sm",className:"text-xs",onClick:()=>v(t),disabled:e.isProcessing,children:"✕"})]})]},t))})]}),(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsx)(i.gx,{ref:y,value:t,onChange:e=>s(e.target.value),placeholder:"Paste text or images (Ctrl+V / Cmd+V). Example: Title: Best Sora Alternatives... Description: Find the best Sora alternatives... Notes will be filtered automatically.",className:"min-h-[120px] resize-y",disabled:l||h})}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("span",{children:"\uD83D\uDCA1"}),(0,a.jsx)("span",{children:"Multi-language recognition: keywords, product/service, location, title, H1, meta description, etc. Notes in many languages will be filtered automatically."})]}),(0,a.jsx)(i.zx,{type:"button",onClick:()=>{if(!t.trim()){o("error","Please paste text or images to recognize.");return}n(t).then(()=>{s("")})},disabled:l||h||!t.trim(),className:"bg-gray-700 text-white hover:bg-gray-800 dark:bg-gray-600 dark:hover:bg-gray-700",children:l?"Recognizing...":"\uD83D\uDD0D Recognize & Fill"})]})]})}function p(e){let t=e.trim();return[/^\/\/\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)/i,/^#\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)/i,/^\/\*\s*(中文解释|解释|备注|说明)/i,/^\*\s*(中文解释|解释|备注|说明)/i].some(e=>e.test(t))}function x(e){return e.split("\n").map(e=>{let t=function(e){let t=/\s*\/\/\s*中文解释[:：]\s*.*$/i;if(t.test(e))return e.replace(t,"").trim();let s=e;for(let e of[/\s*\/\/\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)[:：]?.*$/i,/\s*#\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)[:：]?.*$/i])s=s.replace(e,"");return s.trim()}(e);return p(e)||t.includes("// 中文解释：")||t.includes("// 中文解释:")?"":t}).filter(e=>{let t=e.trim();return!(!t||p(t)||t.includes("// 中文解释：")||t.includes("// 中文解释:"))}).join("\n").trim()}function y(e,t){for(let s of t){let t=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");for(let s of[RegExp("^".concat(t,"\\s*[:：]\\s*(.+)$"),"im"),RegExp("^".concat(t,"\\s*\\([^)]+\\)\\s*[:：]\\s*(.+)$"),"im"),RegExp("^".concat(t,"\\s*[|\\t]\\s*(.+)$"),"im")]){let t=e.match(s);if(t&&t[1]){let e=x(t[1].trim());if(e&&e.length>0)return e}}let a=RegExp("^".concat(t,"\\s*[:：]?\\s*\\n?\\s*(.+?)(?=\\n\\s*[\\u4e00-\\u9fa5a-zA-Z]+\\s*[:：]|$)"),"ims"),r=e.match(a);if(r&&r[1]){let e=x(r[1].trim());if(e&&e.length>0)return e}}return null}function f(e,t){let s=y(e,t);return s?s.split(/[,，\n;；]/).map(e=>x(e)).filter(e=>e.length>0):[]}let b=["nature","character","action","scenery","abstract","cinematic"],v=["information","comparison","transaction"],j=["zh","en"],k={title:"",description:"",prompt:"",category:"nature",tags:"",difficulty:"information",example:"",locale:"zh",isPublished:!0},w={nature:"自然",character:"角色",action:"动作",scenery:"场景",abstract:"抽象",cinematic:"电影感"},N={information:"信息型",comparison:"对比型",transaction:"交易型"},_={zh:"简体中文",en:"English"},C={published:{label:"已发布",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},draft:{label:"草稿",className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}};function S(e){var t,s,a;if(!e||"object"!=typeof e)return null;let r="string"==typeof e.id?e.id:null,n="string"==typeof e.title?e.title:"",i="string"==typeof e.prompt?e.prompt:"",l=null!==(t=e.category)&&void 0!==t?t:"nature",o=null!==(s=e.difficulty)&&void 0!==s?s:"information",d=null!==(a=e.locale)&&void 0!==a?a:"zh";return r&&n&&i?{id:r,title:n,description:"string"==typeof e.description?e.description:null,prompt:i,category:l,tags:Array.isArray(e.tags)?e.tags.filter(e=>"string"==typeof e):[],difficulty:o,example:"string"==typeof e.example?e.example:null,locale:d,is_published:"boolean"!=typeof e.is_published||e.is_published,created_at:"string"==typeof e.created_at?e.created_at:new Date().toISOString(),updated_at:"string"==typeof e.updated_at?e.updated_at:new Date().toISOString(),created_by_admin_id:"string"==typeof e.created_by_admin_id?e.created_by_admin_id:null}:null}function I(e){return e.split(",").map(e=>e.trim()).filter(e=>e.length>0)}function E(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[m,g]=(0,r.useState)(null),[p,E]=(0,r.useState)(""),[T,P]=(0,r.useState)("all"),[D,A]=(0,r.useState)("all"),[z,O]=(0,r.useState)("all"),[L,R]=(0,r.useState)(k),[B,M]=(0,r.useState)(!1),[F,H]=(0,r.useState)(""),[q,V]=(0,r.useState)(!1),[U,W]=(0,r.useState)(null),[Y,J]=(0,r.useState)(k),[G,$]=(0,r.useState)(!1),[Z,K]=(0,r.useState)(null),Q=(0,r.useCallback)(async()=>{o(!0),g(null);try{let e=await fetch("/api/admin/prompts"),t=await e.json().catch(()=>({}));if(!e.ok){let e=[];"string"==typeof t.error&&t.error.trim().length>0&&e.push(t.error.trim()),"string"==typeof t.details&&t.details.trim().length>0&&e.push(t.details.trim());let s=e.join("：")||"获取提示词列表失败";throw Error(s)}let s=(Array.isArray(t.prompts)?t.prompts:[]).map(e=>S(e)).filter(e=>!!e);n(s)}catch(e){console.error("获取提示词列表失败:",e),g(e instanceof Error?e.message:"获取提示词列表失败"),n([])}finally{o(!1)}},[]);(0,r.useEffect)(()=>{Q()},[Q]);let X=(0,r.useCallback)(async e=>{if(e.trim()){V(!0);try{let s=function(e){let t={},s=y(e,["title","标题","Title","提示词标题","prompt title"]);s&&(t.title=s);let a=y(e,["description","描述","Description","简介","introduction"]);a&&(t.description=a);let r=y(e,["prompt","提示词","Prompt","内容","content","prompt text","提示词内容"]);if(!r){let t=e.match(/(?:prompt|提示词|内容)[：:]\s*([\s\S]+?)(?=\n\s*(?:category|tags|difficulty|example|locale|$))/i);t&&t[1]&&(r=x(t[1]))}r&&(t.prompt=r);let n=y(e,["category","分类","Category","类别","type"]);if(n){let e=n.toLowerCase(),s=b.find(t=>e.includes(t)||"nature"===t&&(e.includes("自然")||e.includes("nature"))||"character"===t&&(e.includes("角色")||e.includes("character"))||"action"===t&&(e.includes("动作")||e.includes("action"))||"scenery"===t&&(e.includes("场景")||e.includes("scenery"))||"abstract"===t&&(e.includes("抽象")||e.includes("abstract"))||"cinematic"===t&&(e.includes("电影")||e.includes("cinematic")));s?t.category=s:t.category=n.toLowerCase()}t.tags=f(e,["tags","标签","Tags","tag","关键词","keywords"]);let i=y(e,["difficulty","难度","Difficulty","意图","intent","类型","type"]);if(i){let e=i.toLowerCase(),s=v.find(t=>e.includes(t)||"information"===t&&(e.includes("信息")||e.includes("information"))||"comparison"===t&&(e.includes("对比")||e.includes("comparison"))||"transaction"===t&&(e.includes("交易")||e.includes("transaction")));s?t.difficulty=s:t.difficulty=i.toLowerCase()}let l=y(e,["example","示例","Example","例子","样例","sample"]);l&&(t.example=l);let o=y(e,["locale","语言","Locale","Language","lang"]);if(o){let e=o.toLowerCase(),s=j.find(t=>e.includes(t)||"zh"===t&&(e.includes("中文")||e.includes("chinese")||e.includes("zh"))||"en"===t&&(e.includes("英文")||e.includes("english")||e.includes("en")));s?t.locale=s:t.locale=e.substring(0,2)}let d=y(e,["is_published","isPublished","published","发布状态","publish status","status"]);if(d){let e=d.toLowerCase();t.isPublished=e.includes("true")||e.includes("是")||e.includes("yes")||e.includes("published")}return t}(e);R(e=>{let t={...e};return s.title&&(t.title=s.title),s.description&&(t.description=s.description),s.prompt&&(t.prompt=s.prompt),s.category&&d.includes(s.category)&&(t.category=s.category),s.tags&&s.tags.length>0&&(t.tags=s.tags.join(", ")),s.difficulty&&c.includes(s.difficulty)&&(t.difficulty=s.difficulty),s.example&&(t.example=s.example),s.locale&&u.includes(s.locale)&&(t.locale=s.locale),void 0!==s.isPublished&&(t.isPublished=s.isPublished),t});let a=Object.keys(s).filter(e=>{let t=s[e];return Array.isArray(t)?t.length>0:null!=t&&""!==t}).length;t("success","成功识别并填充了 ".concat(a," 个字段"))}catch(e){console.error("Text recognition failed:",e),t("error",e instanceof Error?e.message:"文本识别失败")}finally{V(!1)}}},[t]),ee=(0,r.useMemo)(()=>{let e=p.trim().toLowerCase();return s.filter(t=>{var s;let a="all"===T||t.locale===T,r="all"===D||("published"===D?t.is_published:!t.is_published),n="all"===z||t.category===z,i=""===e||t.title.toLowerCase().includes(e)||(null!==(s=t.description)&&void 0!==s?s:"").toLowerCase().includes(e)||t.tags.some(t=>t.toLowerCase().includes(e))||t.prompt.toLowerCase().includes(e);return a&&r&&n&&i})},[s,p,T,D,z]),et=async e=>{if(e.preventDefault(),!L.title.trim()){t("error","请输入提示词标题");return}if(!L.prompt.trim()){t("error","请输入提示词正文");return}M(!0);try{let e=await fetch("/api/admin/prompts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:L.title.trim(),description:L.description.trim()||null,prompt:L.prompt.trim(),category:L.category,difficulty:L.difficulty,tags:I(L.tags),example:L.example.trim()||null,locale:L.locale,isPublished:L.isPublished})}),s=await e.json().catch(()=>({}));if(!e.ok){let e="string"==typeof s.error?s.error:"创建提示词失败";throw Error(e)}let a=S(s.prompt);a&&n(e=>[a,...e]),R(k),t("success","提示词已创建")}catch(e){console.error("创建提示词失败:",e),t("error",e instanceof Error?e.message:"创建提示词失败")}finally{M(!1)}},es=e=>{var t,s;W(e.id),J({title:e.title,description:null!==(t=e.description)&&void 0!==t?t:"",prompt:e.prompt,category:e.category,tags:e.tags.join(", "),difficulty:e.difficulty,example:null!==(s=e.example)&&void 0!==s?s:"",locale:e.locale,isPublished:e.is_published})},ea=()=>{W(null),J(k)},er=async e=>{if(e.preventDefault(),U){if(!Y.title.trim()){t("error","请输入提示词标题");return}if(!Y.prompt.trim()){t("error","请输入提示词正文");return}$(!0);try{let e=await fetch("/api/admin/prompts/".concat(U),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:Y.title.trim(),description:Y.description.trim()||null,prompt:Y.prompt.trim(),category:Y.category,difficulty:Y.difficulty,tags:I(Y.tags),example:Y.example.trim()||null,locale:Y.locale,isPublished:Y.isPublished})}),s=await e.json().catch(()=>({}));if(!e.ok){let e="string"==typeof s.error?s.error:"更新提示词失败";throw Error(e)}let a=S(s.prompt);a&&n(e=>e.map(e=>e.id===a.id?a:e)),t("success","提示词已更新"),ea()}catch(e){console.error("更新提示词失败:",e),t("error",e instanceof Error?e.message:"更新提示词失败")}finally{$(!1)}}},en=async e=>{$(!0);try{let s=await fetch("/api/admin/prompts/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isPublished:!e.is_published})}),a=await s.json().catch(()=>({}));if(!s.ok){let e="string"==typeof a.error?a.error:"更新发布状态失败";throw Error(e)}let r=S(a.prompt);r&&n(e=>e.map(e=>e.id===r.id?r:e)),t("success",e.is_published?"已切换为草稿":"已发布提示词")}catch(e){console.error("更新发布状态失败:",e),t("error",e instanceof Error?e.message:"更新发布状态失败")}finally{$(!1)}},ei=async e=>{if(window.confirm("确定要删除提示词「".concat(e.title,"」吗？此操作不可恢复。"))){K(e.id);try{let s=await fetch("/api/admin/prompts/".concat(e.id),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok){let e="string"==typeof a.error?a.error:"删除提示词失败";throw Error(e)}n(t=>t.filter(t=>t.id!==e.id)),t("success","提示词已删除"),U===e.id&&ea()}catch(e){console.error("删除提示词失败:",e),t("error",e instanceof Error?e.message:"删除提示词失败")}finally{K(null)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"新增提示词"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:et,children:[(0,a.jsx)(h,{textInput:F,onTextInputChange:H,onRecognize:X,isRecognizing:q,onShowBanner:t}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"标题"}),(0,a.jsx)(i.II,{value:L.title,onChange:e=>R(t=>({...t,title:e.target.value})),placeholder:"例如：Serene Forest Dawn",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"语言"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:L.locale,onChange:e=>R(t=>({...t,locale:e.target.value})),children:u.map(e=>(0,a.jsx)("option",{value:e,children:_[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"分类"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:L.category,onChange:e=>R(t=>({...t,category:e.target.value})),children:d.map(e=>(0,a.jsx)("option",{value:e,children:w[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"意图"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:L.difficulty,onChange:e=>R(t=>({...t,difficulty:e.target.value})),children:c.map(e=>(0,a.jsx)("option",{value:e,children:N[e]},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"标签（用逗号分隔）"}),(0,a.jsx)(i.II,{value:L.tags,onChange:e=>R(t=>({...t,tags:e.target.value})),placeholder:"例如：forest, morning, peaceful"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"简短描述"}),(0,a.jsx)(i.gx,{rows:2,value:L.description,onChange:e=>R(t=>({...t,description:e.target.value})),placeholder:"用于列表展示的简短摘要，可选"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"提示词正文"}),(0,a.jsx)(i.gx,{rows:5,value:L.prompt,onChange:e=>R(t=>({...t,prompt:e.target.value})),placeholder:"请输入完整的提示词内容",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"示例（可选）"}),(0,a.jsx)(i.gx,{rows:3,value:L.example,onChange:e=>R(t=>({...t,example:e.target.value})),placeholder:"可记录示例输出、使用说明或注意事项"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{id:"newPromptPublished",type:"checkbox",checked:L.isPublished,onChange:e=>R(t=>({...t,isPublished:e.target.checked}))}),(0,a.jsx)("label",{htmlFor:"newPromptPublished",className:"text-sm text-gray-600 dark:text-gray-300",children:"创建后立即对用户开放"})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(i.zx,{type:"submit",disabled:B,children:B?"创建中...":"创建提示词"})})]})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"提示词列表"})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-3 md:grid-cols-4",children:[(0,a.jsx)(i.II,{placeholder:"搜索标题、标签或内容...",value:p,onChange:e=>E(e.target.value)}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:T,onChange:e=>P(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"全部语言"}),u.map(e=>(0,a.jsx)("option",{value:e,children:_[e]},e))]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:z,onChange:e=>O(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"全部分类"}),d.map(e=>(0,a.jsx)("option",{value:e,children:w[e]},e))]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:D,onChange:e=>A(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"全部状态"}),(0,a.jsx)("option",{value:"published",children:"已发布"}),(0,a.jsx)("option",{value:"draft",children:"草稿"})]})]}),l?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("div",{className:"mr-3 h-6 w-6 animate-spin rounded-full border-b-2 border-energy-water"}),"正在加载提示词..."]}):m?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 py-12 text-center text-red-500 dark:text-red-400",children:[(0,a.jsx)("p",{children:m}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:Q,children:"重新加载"})]}):0===ee.length?(0,a.jsx)("div",{className:"py-12 text-center text-gray-500 dark:text-gray-400",children:"暂无符合条件的提示词"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"标题"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"语言"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"分类"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"意图"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"标签"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"更新于"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"状态"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"操作"})]})}),(0,a.jsx)("tbody",{children:ee.map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/40",children:[(0,a.jsx)("td",{className:"py-3 px-4 font-medium text-gray-900 dark:text-gray-100",children:e.title}),(0,a.jsx)("td",{className:"py-3 px-4",children:_[e.locale]}),(0,a.jsx)("td",{className:"py-3 px-4",children:w[e.category]}),(0,a.jsx)("td",{className:"py-3 px-4",children:N[e.difficulty]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags.map(e=>(0,a.jsx)(i.Ct,{variant:"info",className:"text-xs",children:e},e))})}),(0,a.jsx)("td",{className:"py-3 px-4 text-xs text-gray-500 dark:text-gray-400",children:new Date(e.updated_at).toLocaleString()}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(i.Ct,{className:e.is_published?C.published.className:C.draft.className,children:e.is_published?C.published.label:C.draft.label})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",disabled:G,onClick:()=>es(e),children:"编辑"}),(0,a.jsx)(i.zx,{size:"sm",variant:e.is_published?"outline":"primary",disabled:G,onClick:()=>en(e),children:e.is_published?"设为草稿":"发布"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",disabled:Z===e.id,onClick:()=>ei(e),children:Z===e.id?"删除中...":"删除"})]})})]},e.id))})]})})]})]}),U&&(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"编辑提示词"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:er,children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"标题"}),(0,a.jsx)(i.II,{value:Y.title,onChange:e=>J(t=>({...t,title:e.target.value})),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"语言"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:Y.locale,onChange:e=>J(t=>({...t,locale:e.target.value})),children:u.map(e=>(0,a.jsx)("option",{value:e,children:_[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"分类"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:Y.category,onChange:e=>J(t=>({...t,category:e.target.value})),children:d.map(e=>(0,a.jsx)("option",{value:e,children:w[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"难度"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:Y.difficulty,onChange:e=>J(t=>({...t,difficulty:e.target.value})),children:c.map(e=>(0,a.jsx)("option",{value:e,children:N[e]},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"标签"}),(0,a.jsx)(i.II,{value:Y.tags,onChange:e=>J(t=>({...t,tags:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"简短描述"}),(0,a.jsx)(i.gx,{rows:2,value:Y.description,onChange:e=>J(t=>({...t,description:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"提示词正文"}),(0,a.jsx)(i.gx,{rows:5,value:Y.prompt,onChange:e=>J(t=>({...t,prompt:e.target.value})),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"示例"}),(0,a.jsx)(i.gx,{rows:3,value:Y.example,onChange:e=>J(t=>({...t,example:e.target.value}))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{id:"editPromptPublished",type:"checkbox",checked:Y.isPublished,onChange:e=>J(t=>({...t,isPublished:e.target.checked}))}),(0,a.jsx)("label",{htmlFor:"editPromptPublished",className:"text-sm text-gray-600 dark:text-gray-300",children:"对用户可见"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(i.zx,{type:"button",variant:"outline",onClick:ea,disabled:G,children:"取消"}),(0,a.jsx)(i.zx,{type:"submit",disabled:G,children:G?"保存中...":"保存修改"})]})]})})]})]})}let T=["information","comparison","transaction","information_comparison_transaction"],P={information:"Informational",comparison:"Comparison",transaction:"Transactional",information_comparison_transaction:"Informational + Comparison + Transactional"},D=["draft","published"];function A(e){let t=e.trim();return[/^\/\/\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)/i,/^#\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)/i,/^\/\*\s*(中文解释|解释|备注|说明)/i,/^\*\s*(中文解释|解释|备注|说明)/i].some(e=>e.test(t))}function z(e){let t=/\s*\/\/\s*中文解释[:：]\s*.*$/i;if(t.test(e))return e.replace(t,"").trim();let s=e;for(let e of[/\s*\/\/\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)[:：]?.*$/i,/\s*#\s*(中文解释|解释|备注|说明|comment|explanation|note|remark|หมายเหตุ|คำอธิบาย|شرح|تعليق|комментарий|объяснение|примечание)[:：]?.*$/i])s=s.replace(e,"");return s.trim()}function O(e){return e.split("\n").map(e=>{let t=z(e);return A(e)||t.includes("// 中文解释：")||t.includes("// 中文解释:")?"":t}).filter(e=>{let t=e.trim();return!(!t||A(t)||t.includes("// 中文解释：")||t.includes("// 中文解释:"))}).join("\n").trim()}function L(e,t){for(let s of t){let t=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");for(let s of[RegExp("^".concat(t,"\\s*[:：]\\s*(.+)$"),"im"),RegExp("^".concat(t,"\\s*\\([^)]+\\)\\s*[:：]\\s*(.+)$"),"im"),RegExp("^".concat(t,"\\s*[|\\t]\\s*(.+)$"),"im")]){let t=e.match(s);if(t&&t[1]){let e=O(t[1].trim());if(e&&e.length>0)return e}}let a=RegExp("^".concat(t,"\\s*[:：]?\\s*\\n?\\s*(.+?)(?=\\n\\s*[\\u4e00-\\u9fa5a-zA-Z]+\\s*[:：]|$)"),"ims"),r=e.match(a);if(r&&r[1]){let e=O(r[1].trim());if(e&&e.length>0)return e}}return null}let R=()=>({title:"",description:""}),B=()=>({question:"",answer:""}),M={keyword:"",intent:"information",page_style:"default",product:"",service:"",region:"",pain_point:"",search_volume:"",competition_score:"",priority:"0",page_slug:"",title:"",meta_description:"",h1:"",intro_paragraph:"",status:"draft",steps:[R()],faq:[B()]},F={published:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",draft:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"};function H(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[p,x]=(0,r.useState)({search:"",intent:"all",status:"all",product:"",region:"",painPoint:""}),[y,f]=(0,r.useState)(!1),[b,v]=(0,r.useState)(M),[j,k]=(0,r.useState)(""),[w,N]=(0,r.useState)(!1),[_,C]=(0,r.useState)([]),[S,I]=(0,r.useState)(!1),E=(0,r.useRef)(null),H=(0,r.useRef)(null),[q,V]=(0,r.useState)(null),[U,W]=(0,r.useState)(M),[Y,J]=(0,r.useState)(!1),[G,$]=(0,r.useState)(null),Z=e=>e.map(e=>{var t;return{title:e.title.trim(),description:(null!==(t=e.description)&&void 0!==t?t:"").trim()}}).filter(e=>e.title||e.description),K=e=>e.map(e=>({question:e.question.trim(),answer:e.answer.trim()})).filter(e=>e.question&&e.answer),Q=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e&&c(!0);let s=new URLSearchParams;p.search.trim()&&s.set("search",p.search.trim()),"all"!==p.intent&&s.set("intent",p.intent),"all"!==p.status&&s.set("status",p.status),p.product.trim()&&s.set("product",p.product.trim()),p.region.trim()&&s.set("region",p.region.trim()),p.painPoint.trim()&&s.set("pain_point",p.painPoint.trim());let a=await fetch("/api/admin/keywords?".concat(s.toString())),r=await a.json().catch(()=>({}));if(!a.ok||!r.success){var t;throw Error(null!==(t=r.error)&&void 0!==t?t:"Failed to fetch keywords")}n(Array.isArray(r.keywords)?r.keywords:[]),h(null)}catch(e){console.error("Failed to fetch keywords:",e),h(e instanceof Error?e.message:"Failed to fetch keywords"),n([])}finally{o(!1),c(!1)}},[p]);(0,r.useEffect)(()=>{Q(!0)},[Q]);let X=(0,r.useCallback)(async e=>{if(e.trim()){N(!0);try{let s=function(e){let t=function(e){let t=["左边字段","右边内容","左边字段（中文）","右边内容（英文 + 中文解释）","常见问题","步骤","FAQ","Part","部分"];return e.split("\n").map(e=>{let s=e.trim();return A(s)||t.some(e=>s===e||s.startsWith(e+"（")||s.startsWith(e+"("))?"":z(e)}).filter(e=>{let t=e.trim();return!(!t||function(e){let t=e.trim();return!!(t.length<10&&/^[\u4e00-\u9fa5a-zA-Z0-9\s\/\-_()：:]+$/.test(t)&&["关键词","URL别名","产品","服务功能","服务/功能","搜索量","竞争度","优先级","页面标题","H1标题","元描述","意图类型","地区","痛点/场景","痛点","场景","介绍段落","步骤","常见问题","FAQ","左边字段","右边内容","keyword","keywords","product","service","region","title","h1","meta description","intent","status","priority","search volume","competition score"].some(e=>t.toLowerCase().includes(e.toLowerCase())))}(t)||t.includes("// 中文解释：")||t.includes("// 中文解释:"))}).join("\n").trim()}(e),s=function(e){let t={},s=e.split("\n"),a=["关键词","URL别名","产品","服务功能","服务/功能","搜索量","竞争度","优先级","页面标题","H1标题","元描述","意图类型","地区","痛点/场景","痛点","场景","介绍段落","keyword","keywords","product","service","region","title","h1","meta description","intent","status","priority","search volume","competition score","page slug","คำสำคัญ","ผลิตภัณฑ์","บริการ","ภูมิภาค","कीवर्ड","उत्पाद","सेवा","क्षेत्र","كلمة مفتاحية","منتج","خدمة","منطقة","ключевое слово","продукт","услуга","регион","ključna beseda","izdelek","storitev","regija","naslov","opis","cuv\xe2nt cheie","produs","serviciu","regiune","titlu","descriere","palabra clave","producto","servicio","regi\xf3n","t\xedtulo","descripci\xf3n","mot-cl\xe9","produit","service","r\xe9gion","titre","description","Schl\xfcsselwort","Produkt","Service","Region","Titel","Beschreibung","parola chiave","prodotto","servizio","regione","titolo","descrizione","palavra-chave","produto","servi\xe7o","regi\xe3o","t\xedtulo","descri\xe7\xe3o","sleutelwoord","product","service","regio","titel","beschrijving","słowo kluczowe","produkt","usługa","region","tytuł","opis","kl\xedčov\xe9 slovo","produkt","služba","region","n\xe1zev","popis","kulcssz\xf3","term\xe9k","szolg\xe1ltat\xe1s","r\xe9gi\xf3","c\xedm","le\xedr\xe1s","λέξη-κλειδί","προϊόν","υπηρεσία","περιοχή","τίτλος","περιγραφή","nyckelord","produkt","tj\xe4nst","region","titel","beskrivning","n\xf8kkelord","produkt","tjeneste","region","tittel","beskrivelse","avainsana","tuote","palvelu","alue","otsikko","kuvaus","ключова дума","продукт","услуга","регион","заглавие","описание","ključna riječ","proizvod","usluga","regija","naslov","opis"];for(let e=0;e<s.length;e++){let r=s[e].trim();if(!r||/^步骤\s*\d+\s*(标题|描述)[：:]?/i.test(r)||/^Part\s*\d+/i.test(r)||/^步骤\s*\d+[：:]/i.test(r))continue;let n=r.match(/^(.+?)\s*[|\\t:：]\s*(.+)$/);if(n){let e=n[1].trim();if(/^步骤\s*\d+\s*(标题|描述)/i.test(e)||/^Part\s*\d+/i.test(e))continue;let s=n[2].trim();(s=O(s))&&(t[e]=s)}if(a.find(e=>{let t=r.toLowerCase(),s=e.toLowerCase();return t===s||t.startsWith(s)})&&e+1<s.length){let n=s[e+1].trim();if(n&&!A(n)&&!a.some(e=>{let t=n.toLowerCase(),s=e.toLowerCase();return t===s||t.startsWith(s)})){let s=O(n);s&&(t[r]=s,e++)}}}return t}(t),a={},r=s["关键词"]||s.keyword||function(e){let t=L(e,["关键词","keyword","Keywords","Keyword","คำสำคัญ","कीवर्ड","كلمة مفتاحية","ключевое слово","ключевые слова","ključna beseda","ključne besede","cuv\xe2nt cheie","cuvinte cheie","palabra clave","palabras clave","mot-cl\xe9","mots-cl\xe9s","Schl\xfcsselwort","Schl\xfcsselw\xf6rter","parola chiave","parole chiave","palavra-chave","palavras-chave","sleutelwoord","sleutelwoorden","słowo kluczowe","słowa kluczowe","kl\xedčov\xe9 slovo","kl\xedčov\xe1 slova","kulcssz\xf3","kulcsszavak","λέξη-κλειδί","λέξεις-κλειδιά","nyckelord","n\xf8kkelord","avainsana","avainsanat","ключова дума","ключови думи","ključna riječ","ključne riječi","ključna reč","ključne reči"]);if(!t){let a=e.split("\n");for(let e=0;e<Math.min(5,a.length);e++){var s;let r=null===(s=a[e])||void 0===s?void 0:s.trim();if(!(!r||/^(关键词|keyword|产品|product|服务|service|地区|region|标题|title|步骤|Part|常见问题|FAQ)/i.test(r)||/^左边字段|右边内容/i.test(r)||/^步骤\d+标题|^步骤\d+描述/i.test(r))&&!/[:：|\\t]\s*[A-Za-z\u4e00-\u9fa5]/.test(r)&&r.length>5){let e=r.split(/[\s,，、]+/).filter(e=>e.length>1).length;if(e>=2&&(/(ai|video|generator|sora|christmas|rush|ranafast|england|ireland|keyword|关键词)/i.test(r)||e>=3)&&(t=O(r)))break}}}return t}(t);r&&(a.keyword=r);let n=s["产品"]||s.product||L(t,["产品","product","Product","ผลิตภัณฑ์","उत्पाद","منتج","продукт","товар","izdelek","proizvod","produs","produse","producto","productos","produit","produits","Produkt","Produkte","prodotto","prodotti","produto","produtos","product","producten","produkt","produkty","produkt","produkty","term\xe9k","term\xe9kek","προϊόν","προϊόντα","produkt","produkt","tuote","tuotteet","продукт","продукти","proizvod","proizvodi"]);n&&(a.product=n);let i=s["服务功能"]||s["服务/功能"]||s.service||L(t,["服务/功能","服务功能","service","Service","Service Features","บริการ","सेवा","خدمة","услуга","сервис","storitev","storitve","funkcija","funkcije","serviciu","servicii","funcție","funcții","servicio","servicios","funci\xf3n","funciones","service","services","fonction","fonctions","Service","Dienst","Dienste","Funktion","Funktionen","servizio","servizi","funzione","funzioni","servi\xe7o","servi\xe7os","fun\xe7\xe3o","fun\xe7\xf5es","service","diensten","functie","functies","usługa","usługi","funkcja","funkcje","služba","služby","funkce","funkce","szolg\xe1ltat\xe1s","szolg\xe1ltat\xe1sok","funkci\xf3","funkci\xf3k","υπηρεσία","υπηρεσίες","λειτουργία","λειτουργίες","tj\xe4nst","tj\xe4nster","funktion","funktioner","tjeneste","tjenester","funksjon","funksjoner","palvelu","palvelut","toiminto","toiminnot","услуга","услуги","функция","функции","usluga","usluge","funkcija","funkcije"]);i&&(a.service=i);let l=s["地区"]||s.region||L(t,["地区","region","Region","ภูมิภาค","क्षेत्र","منطقة","регион","область","regija","regije","regiune","regiuni","regi\xf3n","regiones","r\xe9gion","r\xe9gions","Region","Gebiet","Gebiete","regione","regioni","regi\xe3o","regi\xf5es","regio","regio's","gebied","gebieden","region","regiony","region","oblast","oblasti","r\xe9gi\xf3","r\xe9gi\xf3k","περιοχή","περιοχές","region","regioner","region","regioner","alue","alueet","регион","област","области","regija","regije"]);l&&(a.region=l);let o=s["痛点/场景"]||s["痛点"]||s["场景"]||s.pain_point||L(t,["痛点/场景","痛点","场景","pain_point","Pain Point","Pain Point/Scenario","จุดเจ็บปวด","दर्द बिंदु","نقطة الألم","болевая точка","сценарий","točka bolečine","scenarij","punct de durere","scenariu","punto de dolor","escenario","point de douleur","sc\xe9nario","Schmerzpunkt","Szenario","punto di dolore","scenario","ponto de dor","cen\xe1rio","pijnpunt","scenario","punkt b\xf3lu","scenariusz","bolestiv\xfd bod","sc\xe9n\xe1ř","f\xe1jdalom pont","forgat\xf3k\xf6nyv","σημείο πόνου","σενάριο","sm\xe4rtpunkt","scenario","smertepunkt","scenario","kivun kohta","skenaario","точка на болка","сценарий","točka boli","scenarij"]);o&&(a.pain_point=o);let d=s["搜索量"]||s.search_volume||function(e){let t=L(e,["搜索量","search_volume","Search Volume","ปริมาณการค้นหา","खोज मात्रा","حجم البحث","объем поиска","obseg iskanja","volum căutări","volumen de b\xfasqueda","volume de recherche","Suchvolumen","volume di ricerca","volume de pesquisa","zoekvolume","wolumen wyszukiwań","objem vyhled\xe1v\xe1n\xed","keres\xe9si mennyis\xe9g","όγκος αναζήτησης","s\xf6kvolym","s\xf8kevolum","hakum\xe4\xe4r\xe4","обем на търсене","obim pretrage"]);if(t){let e=t.match(/(\d+)/);return e?e[1]:null}return null}(t);d&&(a.search_volume=d);let c=s["竞争度"]||s.competition_score||function(e){let t=L(e,["竞争度","competition_score","Competition Score","Competitiveness","ระดับการแข่งขัน","प्रतिस्पर्धा स्कोर","درجة المنافسة","уровень конкуренции","stopnja konkurence","scor competiție","puntuaci\xf3n de competencia","score de concurrence","Wettbewerbsbewertung","punteggio di competizione","pontua\xe7\xe3o de competi\xe7\xe3o","concurrentiescore","wynik konkurencji","sk\xf3re konkurence","versenypontsz\xe1m","βαθμός ανταγωνισμού","konkurrenspo\xe4ng","konkurransescore","kilpailupisteet","резултат на конкуренция","rezultat konkurencije"]);if(t){let e=t.match(/(0?\.\d+|1\.0|0|1)/);return e?e[1]:null}return null}(t);c&&(a.competition_score=c);let u=s["优先级"]||s.priority||function(e){let t=L(e,["优先级","priority","Priority","ลำดับความสำคัญ","प्राथमिकता","الأولوية","приоритет","prioriteta","prioritate","prioridad","priorit\xe9","Priorit\xe4t","priorit\xe0","prioridade","prioriteit","priorytet","priorita","priorit\xe1s","προτεραιότητα","prioritet","prioritet","prioriteetti","приоритет","prioritet"]);if(t){let e=t.match(/(\d+)/);return e?e[1]:null}return null}(t);u&&(a.priority=u);let m=s["页面标题"]||s.title||L(t,["页面标题","title","Title","Page Title","หัวข้อหน้า","शीर्षक","عنوان الصفحة","заголовок страницы","название","naslov strani","naslov","titlu pagină","titlu","t\xedtulo de p\xe1gina","t\xedtulo","titre de page","titre","Seitentitel","Titel","titolo pagina","titolo","t\xedtulo da p\xe1gina","t\xedtulo","paginatitel","titel","tytuł strony","tytuł","n\xe1zev str\xe1nky","n\xe1zev","oldal c\xedme","c\xedm","τίτλος σελίδας","τίτλος","sidtitel","titel","sidetittel","tittel","sivun otsikko","otsikko","заглавие на страница","заглавие","naslov stranice","naslov"]);m&&(a.title=m);let g=s["H1标题"]||s.H1||s.h1||L(t,["H1标题","H1","h1","Main heading","หัวข้อหลัก","मुख्य शीर्षक","العنوان الرئيسي","главный заголовок","glavni naslov","H1 naslov","titlu principal","H1 titlu","encabezado principal","H1 encabezado","titre principal","H1 titre","Haupt\xfcberschrift","H1 \xdcberschrift","intestazione principale","H1 intestazione","cabe\xe7alho principal","H1 cabe\xe7alho","hoofdkop","H1 kop","nagł\xf3wek gł\xf3wny","H1 nagł\xf3wek","hlavn\xed nadpis","H1 nadpis","főc\xedm","H1 c\xedm","κύριος τίτλος","H1 τίτλος","huvudrubrik","H1 rubrik","hovedoverskrift","H1 overskrift","p\xe4\xe4otsikko","H1 otsikko","главно заглавие","H1 заглавие","glavni naslov","H1 naslov"]);g&&(a.h1=g);let h=s["元描述"]||s.meta_description||L(t,["元描述","meta_description","Meta Description","คำอธิบาย","मेटा विवरण","الوصف التعريفي","мета-описание","meta opis","opis","meta descriere","descriere","meta descripci\xf3n","descripci\xf3n","meta description","description","Meta-Beschreibung","Beschreibung","meta descrizione","descrizione","meta descri\xe7\xe3o","descri\xe7\xe3o","meta beschrijving","beschrijving","meta opis","opis","meta popis","popis","meta le\xedr\xe1s","le\xedr\xe1s","meta περιγραφή","περιγραφή","meta beskrivning","beskrivning","meta beskrivelse","beskrivelse","meta kuvaus","kuvaus","meta описание","описание","meta opis","opis"]);h&&(a.meta_description=h);let p=s["介绍段落"]||s.intro_paragraph||L(t,["介绍段落","intro_paragraph","Introduction Paragraph","Overview","ย่อหน้าแนะนำ","परिचय","فقرة المقدمة","вводный абзац","введение","uvodni odstavek","uvod","paragraf introductiv","introducere","p\xe1rrafo de introducci\xf3n","introducci\xf3n","paragraphe d'introduction","introduction","Einf\xfchrungsabsatz","Einf\xfchrung","\xdcberblick","paragrafo introduttivo","introduzione","par\xe1grafo introdut\xf3rio","introdu\xe7\xe3o","inleidende paragraaf","inleiding","overzicht","akapit wprowadzający","wprowadzenie","przegląd","\xfavodn\xed odstavec","\xfavod","přehled","bevezető bekezd\xe9s","bevezet\xe9s","\xe1ttekint\xe9s","εισαγωγική παράγραφος","εισαγωγή","επισκόπηση","introduktionsstycke","introduktion","\xf6versikt","innledningsavsnitt","innledning","oversikt","johdantokappale","johdanto","yleiskatsaus","въвеждащ параграф","въведение","преглед","uvodni odlomak","uvod","pregled"]);p&&(a.intro_paragraph=p);let x=s["URL别名"]||s.page_slug||function(e){let t=L(e,["URL别名","page_slug","Page Slug","URL Alias","นามแฝง URL","URL उपनाम","اسم URL","URL псевдоним","URL vzdevek","alias URL","alias de URL","alias URL","URL-Alias","alias URL","alias de URL","URL alias","alias URL","URL alias","URL \xe1lneve","ψευδώνυμο URL","URL-alias","URL-alias","URL-aliaksen","URL псевдоним","URL alias"]);if(t){let e=O(t).trim();if(e.includes("/keywords/keywords-")){let t=e.match(/\/keywords\/keywords-(.+)$/);if(t)return"keywords-".concat(t[1].trim())}return(e.startsWith("/keywords/")&&!e.includes("keywords-")&&(e=e.replace(/^\/keywords\//,"")),e.startsWith("keywords-"))?e:e=e.replace(/^\/keywords\//,"")}return null}(t);x&&(a.page_slug=x);let y=s["意图类型"]||s.intent||function(e){let t=L(e,["意图类型","intent","Intent","Intent Type","ประเภทความตั้งใจ","इरादा प्रकार","نوع النية","тип намерения","vrsta namena","tip intenție","tipo de intenci\xf3n","type d'intention","Absichtstyp","tipo di intenzione","tipo de inten\xe7\xe3o","intentietype","typ intencji","typ z\xe1měru","sz\xe1nd\xe9k t\xedpusa","τύπος πρόθεσης","avsiktstyp","intensjonstype","aikomus tyyppi","тип намерение","tip namjere"]);if(t){let e=t.toLowerCase().trim(),s=e.includes("informational")||e.includes("信息")||e.includes("ข้อมูล")||e.includes("معلومات")||e.includes("informativno")||e.includes("informativ")||e.includes("informativo")||e.includes("informatif")||e.includes("informativ")||e.includes("informativo")||e.includes("informatief")||e.includes("informacyjne")||e.includes("informačn\xed")||e.includes("t\xe1j\xe9koztat\xf3")||e.includes("ενημερωτικό")||e.includes("informativt")||e.includes("informativt")||e.includes("informatiivinen")||e.includes("информационно")||e.includes("informativno"),a=e.includes("comparison")||e.includes("对比")||e.includes("เปรียบเทียบ")||e.includes("مقارنة")||e.includes("primerjava")||e.includes("comparare")||e.includes("comparaci\xf3n")||e.includes("comparaison")||e.includes("Vergleich")||e.includes("confronto")||e.includes("compara\xe7\xe3o")||e.includes("vergelijking")||e.includes("por\xf3wnanie")||e.includes("srovn\xe1n\xed")||e.includes("\xf6sszehasonl\xedt\xe1s")||e.includes("σύγκριση")||e.includes("j\xe4mf\xf6relse")||e.includes("sammenligning")||e.includes("vertailu")||e.includes("сравнение")||e.includes("poređenje"),r=e.includes("transactional")||e.includes("交易")||e.includes("ธุรกรรม")||e.includes("معاملة")||e.includes("transakcijsko")||e.includes("tranzacțional")||e.includes("transaccional")||e.includes("transactionnel")||e.includes("transaktional")||e.includes("transazionale")||e.includes("transacional")||e.includes("transactioneel")||e.includes("transakcyjne")||e.includes("transakčn\xed")||e.includes("tranzakci\xf3s")||e.includes("συναλλακτικό")||e.includes("transaktionell")||e.includes("transaksjonell")||e.includes("transaktio")||e.includes("транзакционен")||e.includes("transakcioni");if(s&&a&&r)return"information_comparison_transaction";if(s)return"information";if(a)return"comparison";if(r)return"transaction"}return null}(t);y&&(a.intent=y);let f=function(e){let t=L(e,["页面风格","page_style","Page Style","สไตล์หน้า","पृष्ठ शैली","نمط الصفحة","стиль страницы","slog strani","stil pagină","estilo de p\xe1gina","style de page","Seitenstil","stile pagina","estilo da p\xe1gina","pagina stijl","styl strony","styl str\xe1nky","oldal st\xedlus","στυλ σελίδας","sidstil","sidestil","sivun tyyli","стил на страница","stil stranice"]);if(t){let e=t.toLowerCase().trim();return e.includes("christmas")||e.includes("圣诞")||e.includes("คริสต์มาส")||e.includes("عيد الميلاد")||e.includes("рождество")||e.includes("božič")||e.includes("crăciun")||e.includes("navidad")||e.includes("no\xebl")||e.includes("weihnachten")||e.includes("natale")||e.includes("natal")||e.includes("kerst")||e.includes("święta")||e.includes("v\xe1noce")||e.includes("kar\xe1csony")||e.includes("χριστούγεννα")||e.includes("jul")||e.includes("jul")||e.includes("joulu")||e.includes("коледа")||e.includes("božić")?"christmas":e.includes("official")||e.includes("官网")||e.includes("อย่างเป็นทางการ")||e.includes("رسمي")||e.includes("официальный")||e.includes("uradno")||e.includes("oficial")||e.includes("oficial")||e.includes("officiel")||e.includes("offiziell")||e.includes("ufficiale")||e.includes("oficial")||e.includes("officieel")||e.includes("oficjalny")||e.includes("ofici\xe1ln\xed")||e.includes("hivatalos")||e.includes("επίσημο")||e.includes("officiell")||e.includes("offisiell")||e.includes("virallinen")||e.includes("официален")||e.includes("zvanično")?"official":"default"}return null}(t)||((s["页面风格"]||s.page_style)&&["default","christmas","official"].includes((s["页面风格"]||s.page_style||"").toLowerCase().trim())?(s["页面风格"]||s.page_style||"").toLowerCase().trim():null);f&&(a.page_style=f);let b=function(e){let t=L(e,["状态","status","Status","สถานะ","स्थिति","الحالة","статус","status","stare","estado","statut","Status","stato","status","estado","status","status","stav","\xe1llapot","κατάσταση","status","status","tila","статус","status"]);if(t){let e=t.toLowerCase().trim();return e.includes("published")||e.includes("发布")||e.includes("เผยแพร่")||e.includes("प्रकाशित")||e.includes("منشور")||e.includes("опубликовано")||e.includes("objavljeno")||e.includes("publicat")||e.includes("publicado")||e.includes("publi\xe9")||e.includes("ver\xf6ffentlicht")||e.includes("pubblicato")||e.includes("publicado")||e.includes("gepubliceerd")||e.includes("opublikowane")||e.includes("zveřejněno")||e.includes("k\xf6zz\xe9t\xe9ve")||e.includes("δημοσιευμένο")||e.includes("publicerad")||e.includes("publisert")||e.includes("julkaistu")||e.includes("публикувано")||e.includes("objavljeno")?"published":"draft"}return null}(t)||((s["状态"]||s.status)&&["draft","published"].includes((s["状态"]||s.status||"").toLowerCase().trim())?(s["状态"]||s.status||"").toLowerCase().trim():null);b&&(a.status=b);let v=function(e){let t;let s=[],a=[...e.matchAll(/^步骤\s*(\d+)\s*标题[：:]\s*(.+)$/gim)],r=[...e.matchAll(/^步骤\s*(\d+)\s*描述[：:]\s*([\s\S]+?)(?=^\s*步骤\s*\d+\s*标题|^\s*步骤\s*\d+\s*描述|^\s*Part\s*\d+|^\s*常见问题|^\s*FAQ|$)/gim)],n=new Map;if(a.forEach(e=>{let t=parseInt(e[1],10),s=O(e[2].trim()),a=s.match(/^(\d+\.\d+|\d+)[.:]?\s*(.+)$/),r=t;if(a){let e=a[1];e.includes(".")&&(r=parseFloat(e)),s=a[2].trim()}s&&(n.has(t)||n.set(t,{order:r}),n.get(t).title=s,n.get(t).order=r)}),r.forEach(e=>{let t=parseInt(e[1],10),s=e[2].trim(),a=O(s=s.replace(/\n\s*\/\/\s*中文解释[：:].*$/i,""));a&&(n.has(t)||n.set(t,{}),n.get(t).description=a)}),n.size>0){let e=Array.from(n.entries()).sort((e,t)=>{var s,a;return(null!==(s=e[1].order)&&void 0!==s?s:e[0])-(null!==(a=t[1].order)&&void 0!==a?a:t[0])}).map(e=>{let[,t]=e;return t}).filter(e=>e.title||e.description);if(e.length>0)return e.map(e=>{var t;return{title:e.title||(null===(t=e.description)||void 0===t?void 0:t.split("\n")[0])||"Step",description:e.description&&e.title?e.description:void 0}})}let i=[...e.matchAll(/^Part\s*(\d+)[：:\s–-]+\s*([^\n]+)$/gim)];if(i.length>0){let t=[...i].sort((e,t)=>parseInt(e[1],10)-parseInt(t[1],10));for(let a=0;a<t.length;a++){let r=t[a],n=parseInt(r[1],10),i=O(r[2].trim()),l=r.index||0,o=t[a+1],d=o?o.index:e.length,c=e.slice(l,d),u=/^步骤\s*(\d+)\s*标题[：:]\s*(.+)$/gim,m=/^步骤\s*(\d+)\s*描述[：:]\s*([\s\S]+?)(?=^\s*步骤\s*\d+\s*标题|^\s*步骤\s*\d+\s*描述|^\s*Part\s*\d+|^\s*常见问题|^\s*FAQ|$)/gim,g=[...c.matchAll(u)],h=[...c.matchAll(m)];if(g.length>0||h.length>0){let e=new Map;g.forEach(t=>{let s=parseInt(t[1],10),a=O(t[2].trim()),r=a.match(/^(\d+\.\d+|\d+)[.:]?\s*(.+)$/),n=s;if(r){let e=r[1];e.includes(".")&&(n=parseFloat(e)),a=r[2].trim()}a&&(e.has(s)||e.set(s,{order:n}),e.get(s).title=a,e.get(s).order=n)}),h.forEach(t=>{let s=parseInt(t[1],10),a=t[2].trim(),r=O(a=a.replace(/\n\s*\/\/\s*中文解释[：:].*$/i,""));r&&(e.has(s)||e.set(s,{}),e.get(s).description=r)}),s.push({title:"Part ".concat(n,": ").concat(i),description:void 0}),Array.from(e.entries()).sort((e,t)=>{var s,a;return(null!==(s=e[1].order)&&void 0!==s?s:e[0])-(null!==(a=t[1].order)&&void 0!==a?a:t[0])}).map(e=>{let[,t]=e;return t}).filter(e=>e.title||e.description).forEach(e=>{var t;s.push({title:e.title||(null===(t=e.description)||void 0===t?void 0:t.split("\n")[0])||"Step",description:e.description&&e.title?e.description:void 0})});continue}let p=RegExp("(?:步骤\\s*(\\d+)\\s*标题[：:]\\s*)?(\\d+\\.\\d+|".concat(n,"\\.\\d+|\\d+)[.)]?\\s*([^\\n]+(?:\\n(?!\\d+[.)]|Part\\s*\\d+|步骤\\s*\\d+|常见问题|FAQ|$)[^\\n]+)*)"),"gim"),x=[...c.matchAll(p)].sort((e,t)=>{let s=e[1]?parseInt(e[1],10):0,a=t[1]?parseInt(t[1],10):0;return s!==a?s-a:(e[2].includes(".")?parseFloat(e[2]):parseInt(e[2],10))-(t[2].includes(".")?parseFloat(t[2]):parseInt(t[2],10))});if(x.length>0){let e="Part ".concat(n,": ").concat(i);s.push({title:e,description:void 0}),x.forEach(e=>{let t;let a=e[1],r=e[2],i=O(e[3].trim());if(a){let e=RegExp("步骤\\s*".concat(a,"\\s*描述[：:]\\s*([\\s\\S]+?)(?=\\n\\s*步骤\\s*\\d+\\s*标题|\\n\\s*步骤\\s*\\d+\\s*描述|\\n\\s*Part\\s*\\d+|\\n\\s*常见问题|\\n\\s*FAQ|$)"),"gi"),s=c.match(e);if(s){let e=s[1].trim();t=O(e=e.replace(/\n\s*\/\/\s*中文解释[：:].*$/i,""))}}let l=i.split("\n").map(e=>{let t=z(e);return A(e)||t.includes("// 中文解释：")||t.includes("// 中文解释:")?"":t}).filter(e=>{let t=e.trim();return t&&!A(t)}).join("\n").trim();if(l){let e=l.split("\n").filter(e=>e.trim());if(e.length>0){let a=r.includes(".")?r:"".concat(n,".").concat(r),i="".concat(a," ").concat(e[0].trim());!t&&e.length>1&&(t=e.slice(1).join("\n").trim()||void 0),s.push({title:i,description:t})}}})}else{let e="Part ".concat(n,": ").concat(i);s.push({title:e,description:void 0})}}if(s.length>0)return s}let l=/(?:步骤|Step|ขั้นตอน|चरण|خطوة|шаг|step|korak|koraki|pas|pași|paso|pasos|étape|étapes|Schritt|Schritte|passo|passi|stap|stappen|krok|kroki|krok|kroky|lépés|lépések|βήμα|βήματα|steg|steg|askel|askeleet|стъпка|стъпки)\s*(\d+)[.:]?\s*([\s\S]+?)(?=(?:步骤|Step|ขั้นตอน|चरण|خطوة|шаг|step|korak|koraki|pas|pași|paso|pasos|étape|étapes|Schritt|Schritte|passo|passi|stap|stappen|krok|kroki|krok|kroky|lépés|lépések|βήμα|βήματα|steg|steg|askel|askeleet|стъпка|стъпки)\s*\d+|$)/gi;for(;null!==(t=l.exec(e));){let e=O(t[2].trim()).split("\n").filter(e=>{let t=e.trim();return t&&!A(t)&&!t.includes("// 中文解释")});if(e.length>0){let t=e[0].replace(/^[\d.]+\s*/,"").trim(),a=e.length>1?e.slice(1).join("\n").trim():void 0;t&&s.push({title:t,description:a})}}if(0===s.length){let t=[...e.matchAll(/^\s*(\d+\.\d+|\d+)[.)]\s*([\s\S]+?)(?=^\s*\d+[.)]|Part\s*\d+|步骤|$)/gim)];t.length>0&&t.sort((e,t)=>(e[1].includes(".")?parseFloat(e[1]):parseInt(e[1],10))-(t[1].includes(".")?parseFloat(t[1]):parseInt(t[1],10))).forEach(e=>{let t=e[1],a=O(e[2].trim()).split("\n").filter(e=>{let t=e.trim();return t&&!A(t)&&!t.includes("// 中文解释")});if(a.length>0){let e="".concat(t," ").concat(a[0].trim()),r=a.slice(1).join("\n").trim()||void 0;e&&e.length>3&&s.push({title:e,description:r})}})}return s}(t);v.length>0&&(a.steps=v);let j=function(e){let t;let s=[],a=[...e.matchAll(/问题\s*(\d+)[：:]\s*(?:Q[：:]?\s*)?([^\n]+)/gi)],r=[...e.matchAll(/回答\s*(\d+)[：:]\s*(?:A[：:]?\s*)?([\s\S]+?)(?=\n\s*问题\s*\d+|\n\s*常见问题|\n\s*FAQ|$)/gi)],n=new Map;if(a.forEach(e=>{let t=parseInt(e[1],10),s=O(e[2].trim());(s=s.replace(/^Q[：:]\s*/i,"").trim())&&(n.has(t)||n.set(t,{}),n.get(t).question=s)}),r.forEach(e=>{let t=parseInt(e[1],10),s=e[2].trim(),a=O(s=s.replace(/\n\s*\/\/\s*中文解释[：:].*$/i,""));(a=a.replace(/^A[：:]\s*/i,"").trim())&&(n.has(t)||n.set(t,{}),n.get(t).answer=a)}),n.size>0){let e=Array.from(n.entries()).sort((e,t)=>e[0]-t[0]).map(e=>{let[,t]=e;return t}).filter(e=>e.question&&e.answer);if(e.length>0)return e.map(e=>({question:e.question,answer:e.answer}))}let i=/(?:常见问题|FAQ|Question|Q|คำถามที่พบบ่อย|सामान्य प्रश्न|الأسئلة الشائعة|часто задаваемые вопросы|faq|pogosta vprašanja|întrebări frecvente|preguntas frecuentes|questions fréquentes|häufig gestellte Fragen|domande frequenti|perguntas frequentes|veelgestelde vragen|często zadawane pytania|časté otázky|gyakori kérdések|συχνές ερωτήσεις|vanliga frågor|vanlige spørsmål|usein kysytyt kysymykset|често задавани въпроси|često postavljana pitanja)[\s:：]*([\s\S]+?)(?=(?:常见问题|FAQ|Question|Q|คำถามที่พบบ่อย|सामान्य प्रश्न|الأسئلة الشائعة|часто задаваемые вопросы|faq|pogosta vprašanja|întrebări frecvente|preguntas frecuentes|questions fréquentes|häufig gestellte Fragen|domande frequenti|perguntas frequentes|veelgestelde vragen|często zadawane pytania|časté otázky|gyakori kérdések|συχνές ερωτήσεις|vanliga frågor|vanlige spørsmål|usein kysytyt kysymykset|често задавани въпроси|često postavljana pitanja)[\s:：]|$)/gi;for(;null!==(t=i.exec(e));){let e=t[1].trim(),a=(e=O(e)).match(/^([\s\S]+[?？؟])\s*([\s\S]+)$/);if(a){let e=O(a[1].trim()),t=O(a[2].trim());e&&t&&s.push({question:e,answer:t})}}if(0===s.length){let t=[...e.matchAll(/^([\s\S]+[?？؟])\s*\n([\s\S]+?)(?=^[\s\S]+[?？？]|常见问题|FAQ|$)/gim)];t.length>0&&t.forEach(e=>{let t=O(e[1].trim()),a=O(e[2].trim());t=t.replace(/^Q[：:]\s*/i,"").trim(),a=a.replace(/^A[：:]\s*/i,"").trim(),t&&a&&s.push({question:t,answer:a})})}return s}(t);return j.length>0&&(a.faq=j),a}(e);v(e=>{let t={...e};return s.keyword&&(t.keyword=s.keyword),s.intent&&T.includes(s.intent)&&(t.intent=s.intent),s.page_style&&(t.page_style=s.page_style),s.page_slug&&(t.page_slug=s.page_slug),s.status&&(t.status=s.status),s.product&&(t.product=s.product),s.service&&(t.service=s.service),s.region&&(t.region=s.region),s.pain_point&&(t.pain_point=s.pain_point),s.search_volume&&(t.search_volume=s.search_volume),s.competition_score&&(t.competition_score=s.competition_score),s.priority&&(t.priority=s.priority),s.title&&(t.title=s.title),s.h1&&(t.h1=s.h1),s.meta_description&&(t.meta_description=s.meta_description),s.intro_paragraph&&(t.intro_paragraph=s.intro_paragraph),s.steps&&s.steps.length>0&&(t.steps=s.steps.map(e=>({title:e.title,description:e.description||""}))),s.faq&&s.faq.length>0&&(t.faq=s.faq),t});let a=Object.keys(s).filter(e=>{let t=s[e];return Array.isArray(t)?t.length>0:null!=t&&""!==t}).length;t("success","Successfully recognized and filled ".concat(a," field(s)"))}catch(e){console.error("Text recognition failed:",e),t("error",e instanceof Error?e.message:"Text recognition failed")}finally{N(!1)}}},[t]);(0,r.useEffect)(()=>{let e=async e=>{var s;let a=null===(s=e.clipboardData)||void 0===s?void 0:s.items;if(!a)return;let r=[];for(let s=0;s<a.length;s++){let n=a[s];if(n.type.startsWith("image/")){e.preventDefault();let s=n.getAsFile();if(!s)continue;if(s.size>10485760){t("error","".concat(s.name||"图片"," 大小超过 10MB"));continue}r.push(s)}}if(0===r.length)return;let n=10-_.length;if(n<=0){t("error","最多只能添加 ".concat(10," 张图片"));return}let i=r.slice(0,n),l=[];for(let e of i){let t=new FileReader;t.onloadend=()=>{let s=t.result;C(t=>{let a=[...t],r=a.findIndex(t=>t.file===e);return r>=0&&(a[r]={...a[r],preview:s}),a})},t.readAsDataURL(e),l.push({file:e,preview:"",isProcessing:!1,progress:0})}l.length>0&&(C(e=>[...e,...l]),t("success","已粘贴 ".concat(l.length," 张图片")))};return document.addEventListener("paste",e),()=>{document.removeEventListener("paste",e)}},[X,t,_.length]);let ee=(e,t,s)=>{e(e=>({...e,[t]:s}))},et=(e,t,s,a)=>{e(e=>{let r=[...e.steps];return r[t]={...r[t],[s]:a},{...e,steps:r}})},es=(e,t,s,a)=>{e(e=>{let r=[...e.faq];return r[t]={...r[t],[s]:a},{...e,faq:r}})},ea=e=>{e(e=>({...e,steps:[...e.steps,R()]}))},er=e=>{e(e=>({...e,faq:[...e.faq,B()]}))},en=(e,t)=>{e(e=>({...e,steps:e.steps.filter((e,s)=>s!==t)}))},ei=(e,t)=>{e(e=>({...e,faq:e.faq.filter((e,s)=>s!==t)}))},el=e=>({keyword:e.keyword.trim(),intent:e.intent,page_style:e.page_style,product:e.product.trim(),service:e.service.trim(),region:e.region.trim(),pain_point:e.pain_point.trim(),search_volume:e.search_volume.trim(),competition_score:e.competition_score.trim(),priority:e.priority.trim(),pageSlug:e.page_slug.trim(),title:e.title.trim(),meta_description:e.meta_description.trim(),h1:e.h1.trim(),intro_paragraph:e.intro_paragraph.trim(),status:e.status,steps:Z(e.steps),faq:K(e.faq)}),eo=async e=>{if(e.preventDefault(),!b.keyword.trim()){t("error","Please enter a keyword");return}f(!0);try{let e=await fetch("/api/admin/keywords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(el(b))}),a=await e.json().catch(()=>({}));if(!e.ok||!a.success){var s;throw Error(null!==(s=a.error)&&void 0!==s?s:"Creation failed")}v(M),n(e=>[a.keyword,...e]),t("success","Keyword created successfully")}catch(e){console.error("Failed to create keyword:",e),t("error",e instanceof Error?e.message:"Failed to create keyword")}finally{f(!1)}},ed=e=>{var t,s,a,r,n,i,l,o,d,c,u,m,g;V(e.id),W({keyword:e.keyword,intent:e.intent,page_style:null!==(a=e.page_style)&&void 0!==a?a:"default",product:null!==(r=e.product)&&void 0!==r?r:"",service:null!==(n=e.service)&&void 0!==n?n:"",region:null!==(i=e.region)&&void 0!==i?i:"",pain_point:null!==(l=e.pain_point)&&void 0!==l?l:"",search_volume:null!==(o=null===(t=e.search_volume)||void 0===t?void 0:t.toString())&&void 0!==o?o:"",competition_score:null!==(d=null===(s=e.competition_score)||void 0===s?void 0:s.toString())&&void 0!==d?d:"",priority:e.priority.toString(),page_slug:e.page_slug,title:null!==(c=e.title)&&void 0!==c?c:"",meta_description:null!==(u=e.meta_description)&&void 0!==u?u:"",h1:null!==(m=e.h1)&&void 0!==m?m:"",intro_paragraph:null!==(g=e.intro_paragraph)&&void 0!==g?g:"",status:e.status,steps:e.steps.length?e.steps:[R()],faq:e.faq.length?e.faq:[B()]}),setTimeout(()=>{try{let e=document.getElementById("edit-keyword-card");e&&e.isConnected&&e.scrollIntoView({behavior:"smooth",block:"start"})}catch(e){console.debug("Scroll to edit card error (safe to ignore):",e)}},100)},ec=async e=>{if(e.preventDefault(),q){J(!0);try{let e=await fetch("/api/admin/keywords/".concat(q),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(el(U))}),a=await e.json().catch(()=>({}));if(!e.ok||!a.success){var s;throw Error(null!==(s=a.error)&&void 0!==s?s:"Update failed")}n(e=>e.map(e=>e.id===q?a.keyword:e)),t("success","Keyword updated successfully"),V(null),W(M)}catch(e){console.error("Failed to update keyword:",e),t("error",e instanceof Error?e.message:"Failed to update keyword")}finally{J(!1)}}},eu=async e=>{if(window.confirm('Are you sure you want to delete "'.concat(e.keyword,'"?'))){$(e.id);try{let a=await fetch("/api/admin/keywords/".concat(e.id),{method:"DELETE"}),r=await a.json().catch(()=>({}));if(!a.ok||!r.success){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"Delete failed")}n(t=>t.filter(t=>t.id!==e.id)),q===e.id&&(V(null),W(M)),t("success","Keyword deleted successfully")}catch(e){console.error("Failed to delete keyword:",e),t("error",e instanceof Error?e.message:"Failed to delete keyword")}finally{$(null)}}},em=(0,r.useMemo)(()=>s.length,[s]),eg=async e=>{if(e<0||e>=_.length)return;let s=_[e];if(!s.isProcessing){C(t=>{let s=[...t];return s[e]={...s[e],isProcessing:!0,progress:0},s}),I(!0);try{let a=await (0,g.createWorker)("eng+chi_sim+chi_tra+tha+ara+rus+slv+ron+spa+fra+deu+ita+por+nld+pol+ces+hun+ell+swe+nor+fin+bul",1,{logger:t=>{"recognizing text"===t.status&&C(s=>{let a=[...s];return a[e]={...a[e],progress:Math.round(100*t.progress)},a})}}),{data:{text:r}}=await a.recognize(s.file);await a.terminate();let n=r.trim();if(C(t=>{let s=[...t];return s[e]={...s[e],recognizedText:n,isProcessing:!1,progress:100},s}),!n){t("error","图片 ".concat(e+1," 未识别到文字"));return}let i=_.map((t,s)=>s===e?n:t.recognizedText||"").filter(e=>e.trim()).join("\n\n");k(i),i.trim()&&(await X(i),t("success","图片 ".concat(e+1," 识别成功，共 ").concat(n.length," 个字符")))}catch(s){console.error("OCR recognition failed:",s),C(t=>{let s=[...t];return s[e]={...s[e],isProcessing:!1,progress:0},s}),t("error",s instanceof Error?s.message:"OCR recognition failed. Please try again.")}finally{I(_.some((t,s)=>s!==e&&t.isProcessing))}}},eh=async()=>{if(0===_.length){t("error","请先添加图片");return}I(!0);for(let e=0;e<_.length;e++)_[e].recognizedText||_[e].isProcessing||await eg(e);let e=_.map(e=>e.recognizedText||"").filter(e=>e.trim()).join("\n\n");e.trim()&&(k(e),await X(e),t("success","已识别 ".concat(_.filter(e=>e.recognizedText).length," 张图片"))),I(!1)},ep=e=>{C(t=>t.filter((t,s)=>s!==e))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Create Keyword Page"})}),(0,a.jsxs)(i.aY,{children:[(0,a.jsxs)("div",{className:"text-recognition-area mb-6 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-800 dark:bg-blue-950/30",children:[(0,a.jsx)("div",{className:"mb-2 flex items-center gap-2",children:(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\uD83D\uDCCB 文本识别自动填充 (Text Recognition & Auto-fill)"})}),(0,a.jsx)("p",{className:"mb-3 text-xs text-gray-600 dark:text-gray-400",children:"支持三种方式：1) 直接粘贴图片（Ctrl+V / Cmd+V）自动识别文字（OCR） 2) 上传图片自动识别文字 3) 直接粘贴文本。系统会自动识别字段并填充表单。支持多语言识别（中文、英文、泰语、印地语、阿拉伯语、俄语、斯洛文尼亚语、罗马尼亚语、西班牙语、法语、德语、意大利语、葡萄牙语、荷兰语、波兰语、捷克语、匈牙利语、希腊语、瑞典语、挪威语、芬兰语等），自动屏蔽各种语言的备注和表单标签。"}),(0,a.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("input",{ref:E,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let s=e.target.files;if(!s||0===s.length)return;let a=[],r=10-_.length;if(r<=0){t("error","最多只能添加 ".concat(10," 张图片"));return}for(let e of Array.from(s).slice(0,r)){if(!e.type.startsWith("image/")){t("error","".concat(e.name," 不是图片文件"));continue}if(e.size>10485760){t("error","".concat(e.name," 大小超过 10MB"));continue}let s=new FileReader;s.onloadend=()=>{let t=s.result;C(s=>{let a=[...s],r=a.findIndex(t=>t.file===e);return r>=0&&(a[r]={...a[r],preview:t}),a})},s.readAsDataURL(e),a.push({file:e,preview:"",isProcessing:!1,progress:0})}a.length>0&&(C(e=>[...e,...a]),t("success","已添加 ".concat(a.length," 张图片"))),E.current&&(E.current.value="")},className:"hidden",id:"image-upload",disabled:S||_.length>=10}),(0,a.jsxs)("label",{htmlFor:"image-upload",className:"flex items-center gap-2 rounded-lg border px-3 py-2 text-sm font-medium transition-colors ".concat(S||_.length>=10?"cursor-not-allowed border-gray-300 bg-gray-100 text-gray-400 dark:border-gray-600 dark:bg-gray-800":"cursor-pointer border-blue-300 bg-blue-100 text-blue-700 hover:bg-blue-200 dark:border-blue-600 dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800"),children:["\uD83D\uDCF7 上传图片 ",_.length>0&&"(".concat(_.length,"/").concat(10,")")]}),_.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:eh,disabled:S,children:S?"批量识别中...":"\uD83D\uDD0D 批量识别所有图片"}),(0,a.jsx)(i.zx,{type:"button",variant:"ghost",size:"sm",onClick:()=>{C([]),E.current&&(E.current.value="")},disabled:S,children:"✕ 清除全部"})]})]}),_.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:_.map((e,t)=>(0,a.jsxs)("div",{className:"relative rounded-lg border border-gray-200 bg-white p-2 dark:border-gray-700 dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"absolute -top-2 -right-2 z-10 flex h-6 w-6 items-center justify-center rounded-full bg-blue-500 text-xs font-bold text-white",children:t+1}),e.preview&&(0,a.jsxs)("div",{className:"relative aspect-square w-full overflow-hidden rounded",children:[(0,a.jsx)(m.default,{src:e.preview,alt:"Preview ".concat(t+1),width:200,height:200,className:"h-full w-full object-cover",unoptimized:!0}),e.isProcessing&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"text-center text-white",children:[(0,a.jsx)("div",{className:"mb-1 text-xs",children:"识别中..."}),(0,a.jsx)("div",{className:"h-1 w-20 overflow-hidden rounded-full bg-gray-700",children:(0,a.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,a.jsxs)("div",{className:"mt-1 text-[10px]",children:[e.progress,"%"]})]})}),e.recognizedText&&!e.isProcessing&&(0,a.jsx)("div",{className:"absolute top-1 left-1 rounded bg-green-500 px-1.5 py-0.5 text-[10px] font-medium text-white",children:"✓"})]}),(0,a.jsxs)("div",{className:"mt-2 flex gap-1",children:[(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",className:"flex-1 text-xs",onClick:()=>eg(t),disabled:e.isProcessing||!!e.recognizedText,children:e.isProcessing?"识别中":e.recognizedText?"已识别":"识别"}),(0,a.jsx)(i.zx,{type:"button",variant:"ghost",size:"sm",className:"px-2 text-xs",onClick:()=>ep(t),disabled:e.isProcessing,children:"✕"})]})]},t))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(i.gx,{ref:H,rows:6,value:j,onChange:e=>k(e.target.value),onPaste:()=>{},placeholder:"粘贴文本内容或图片（Ctrl+V / Cmd+V），例如： 关键词: Sora2 vs Runway for English Christmas Pantomime videos... 产品: Sora2 AI Video Generator 地区: England, UK // 中文解释: 这些是中文备注，会被自动过滤",className:"font-mono text-sm"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\uD83D\uDCA1 支持多语言识别：关键词、产品、服务、地区、标题、H1、元描述等字段，自动过滤各种语言的备注（包括欧洲语言：斯洛文尼亚语、罗马尼亚语、西班牙语、法语、德语、意大利语等）"}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",onClick:()=>{if(!j.trim()){t("error","Please paste text to recognize");return}X(j).then(()=>{k("")})},disabled:w||!j.trim(),children:w?"识别中...":"\uD83D\uDD0D 识别并填充"})]})]})]}),(0,a.jsxs)("form",{className:"space-y-4",onSubmit:eo,children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"关键词 (keyword)"}),(0,a.jsx)(i.II,{value:b.keyword,onChange:e=>ee(v,"keyword",e.target.value),placeholder:"e.g., sora video generator free online",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"意图类型 (intent)"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:b.intent,onChange:e=>ee(v,"intent",e.target.value),children:T.map(e=>(0,a.jsx)("option",{value:e,children:P[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"页面风格 (page_style)"}),(0,a.jsxs)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:b.page_style,onChange:e=>ee(v,"page_style",e.target.value),children:[(0,a.jsx)("option",{value:"default",children:"默认风格 (Default)"}),(0,a.jsx)("option",{value:"christmas",children:"圣诞节风格 \uD83C\uDF84 (Christmas)"}),(0,a.jsx)("option",{value:"official",children:"官网风格 \uD83C\uDF10 (Official Website)"})]}),"christmas"===b.page_style&&(0,a.jsx)("p",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"\uD83D\uDCA1 圣诞节风格包含动态背景和背景音乐"}),"official"===b.page_style&&(0,a.jsx)("p",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"\uD83D\uDCA1 官网风格使用网站官方设计风格"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"URL别名 (page_slug)"}),(0,a.jsx)(i.II,{value:b.page_slug,onChange:e=>ee(v,"page_slug",e.target.value),placeholder:"e.g., sora-video-generator-free (会自动添加 keywords- 前缀)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"状态 (status)"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:b.status,onChange:e=>ee(v,"status",e.target.value),children:D.map(e=>(0,a.jsx)("option",{value:e,children:"published"===e?"Published":"Draft"},e))})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"产品 (product)"}),(0,a.jsx)(i.II,{value:b.product,onChange:e=>ee(v,"product",e.target.value),placeholder:"e.g., Sora2 Video"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"服务/功能 (service)"}),(0,a.jsx)(i.II,{value:b.service,onChange:e=>ee(v,"service",e.target.value),placeholder:"e.g., Online Generator"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"地区 (region)"}),(0,a.jsx)(i.II,{value:b.region,onChange:e=>ee(v,"region",e.target.value),placeholder:"e.g., US, UK, Global"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"痛点/场景 (pain_point)"}),(0,a.jsx)(i.II,{value:b.pain_point,onChange:e=>ee(v,"pain_point",e.target.value),placeholder:"e.g., Batch Content Creation"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"搜索量 (search_volume)"}),(0,a.jsx)(i.II,{type:"number",value:b.search_volume,onChange:e=>ee(v,"search_volume",e.target.value),placeholder:"e.g., 90"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"竞争度 (competition_score)"}),(0,a.jsx)(i.II,{type:"number",step:"0.01",value:b.competition_score,onChange:e=>ee(v,"competition_score",e.target.value),placeholder:"0 - 1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"优先级 (priority)"}),(0,a.jsx)(i.II,{type:"number",value:b.priority,onChange:e=>ee(v,"priority",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"页面标题 (title)"}),(0,a.jsx)(i.II,{value:b.title,onChange:e=>ee(v,"title",e.target.value),placeholder:"Page title containing long-tail keyword"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"H1标题 (h1)"}),(0,a.jsx)(i.II,{value:b.h1,onChange:e=>ee(v,"h1",e.target.value),placeholder:"Main heading (H1)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"元描述 (meta_description)"}),(0,a.jsx)(i.gx,{rows:3,value:b.meta_description,onChange:e=>ee(v,"meta_description",e.target.value),placeholder:"140-160 characters, naturally includes long-tail keyword"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"介绍段落 (intro_paragraph)"}),(0,a.jsx)(i.gx,{rows:4,value:b.intro_paragraph,onChange:e=>ee(v,"intro_paragraph",e.target.value),placeholder:"150-300 words, describes the search intent"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Steps"}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>ea(v),children:"Add Step"})]}),b.steps.map((e,t)=>{var s;let r=e.title.startsWith("Part ")&&!e.description;return(0,a.jsx)("div",{className:r?"col-span-2":"grid gap-2 md:grid-cols-2",children:r?(0,a.jsx)("div",{className:"rounded-lg border-2 border-blue-300 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-950/30",children:(0,a.jsx)(i.II,{value:e.title,onChange:e=>et(v,t,"title",e.target.value),placeholder:"Part Title",className:"font-semibold text-blue-700 dark:text-blue-300"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.II,{value:e.title,onChange:e=>et(v,t,"title",e.target.value),placeholder:"Step ".concat(t+1," Title")}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.gx,{rows:2,value:null!==(s=e.description)&&void 0!==s?s:"",onChange:e=>et(v,t,"description",e.target.value),placeholder:"Description (optional)"}),b.steps.length>1&&(0,a.jsx)(i.zx,{type:"button",variant:"ghost",onClick:()=>en(v,t),children:"Delete"})]})]})},"create-step-".concat(t))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"FAQ"}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>er(v),children:"Add FAQ"})]}),b.faq.map((e,t)=>(0,a.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,a.jsx)(i.II,{value:e.question,onChange:e=>es(v,t,"question",e.target.value),placeholder:"Question ".concat(t+1)}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.gx,{rows:2,value:e.answer,onChange:e=>es(v,t,"answer",e.target.value),placeholder:"Answer"}),b.faq.length>1&&(0,a.jsx)(i.zx,{type:"button",variant:"ghost",onClick:()=>ei(v,t),children:"Delete"})]})]},"create-faq-".concat(t)))]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(i.zx,{type:"submit",disabled:y,children:y?"Creating...":"Create Keyword"})})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,a.jsx)(i.ll,{children:"Keywords List"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)(i.Ct,{className:"bg-energy-water-surface text-energy-water dark:bg-energy-water-muted dark:text-energy-soft",children:["Total ",em," items"]}),(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>Q(!0),disabled:d,children:d?"Refreshing...":"Refresh List"})]})]})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("form",{className:"grid gap-3 md:grid-cols-6",onSubmit:e=>{e.preventDefault(),Q(!0)},children:[(0,a.jsx)(i.II,{placeholder:"Search keyword/title/URL",value:p.search,onChange:e=>x(t=>({...t,search:e.target.value}))}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:p.intent,onChange:e=>x(t=>({...t,intent:e.target.value})),children:[(0,a.jsx)("option",{value:"all",children:"All Intents"}),T.map(e=>(0,a.jsx)("option",{value:e,children:P[e]},e))]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:p.status,onChange:e=>x(t=>({...t,status:e.target.value})),children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"published",children:"Published"}),(0,a.jsx)("option",{value:"draft",children:"Draft"})]}),(0,a.jsx)(i.II,{placeholder:"Product",value:p.product,onChange:e=>x(t=>({...t,product:e.target.value}))}),(0,a.jsx)(i.II,{placeholder:"Region",value:p.region,onChange:e=>x(t=>({...t,region:e.target.value}))}),(0,a.jsx)(i.II,{placeholder:"Pain Point",value:p.painPoint,onChange:e=>x(t=>({...t,painPoint:e.target.value}))})]}),l?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("div",{className:"mr-3 h-6 w-6 animate-spin rounded-full border-b-2 border-energy-water"}),"Loading keywords..."]}):u?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 py-12 text-center text-red-500 dark:text-red-400",children:[(0,a.jsx)("p",{children:u}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>Q(!0),children:"Reload"})]}):0===s.length?(0,a.jsx)("div",{className:"py-12 text-center text-gray-500 dark:text-gray-400",children:"No data available"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Keyword"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Slug"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Intent"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Region/Product"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Priority"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Status"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Last Updated"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:s.map(e=>{var t;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/40",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.keyword}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:null!==(t=e.title)&&void 0!==t?t:"—"})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("code",{className:"rounded bg-gray-100 px-2 py-1 text-xs text-gray-700 dark:bg-gray-900 dark:text-gray-300",children:["/keywords/",e.page_slug]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(i.Ct,{className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:P[e.intent]})}),(0,a.jsxs)("td",{className:"py-3 px-4 text-xs text-gray-600 dark:text-gray-300",children:[e.region||"—",(0,a.jsx)("br",{}),e.product||"—"]}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.priority}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)(i.Ct,{className:F[e.status],children:"published"===e.status?"Published":"Draft"})}),(0,a.jsx)("td",{className:"py-3 px-4 text-xs text-gray-500 dark:text-gray-400",children:new Date(e.updated_at).toLocaleString()}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("div",{className:"flex flex-col gap-2",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>ed(e),children:"Edit"}),"published"===e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>window.open("/keywords/".concat(e.page_slug),"_blank"),className:"text-blue-600 hover:text-blue-700 dark:text-blue-400",children:"View"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>eu(e),disabled:G===e.id,children:G===e.id?"Deleting...":"Delete"})]})})})]},e.id)})})]})})]})]}),q&&(0,a.jsxs)(i.Zb,{id:"edit-keyword-card",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Edit Keyword"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{className:"space-y-4",onSubmit:ec,children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"关键词 (keyword)"}),(0,a.jsx)(i.II,{value:U.keyword,onChange:e=>ee(W,"keyword",e.target.value),required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"意图类型 (intent)"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:U.intent,onChange:e=>ee(W,"intent",e.target.value),children:T.map(e=>(0,a.jsx)("option",{value:e,children:P[e]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"页面风格 (page_style)"}),(0,a.jsxs)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:U.page_style,onChange:e=>ee(W,"page_style",e.target.value),children:[(0,a.jsx)("option",{value:"default",children:"默认风格 (Default)"}),(0,a.jsx)("option",{value:"christmas",children:"圣诞节风格 \uD83C\uDF84 (Christmas)"}),(0,a.jsx)("option",{value:"official",children:"官网风格 \uD83C\uDF10 (Official Website)"})]}),"christmas"===U.page_style&&(0,a.jsx)("p",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"\uD83D\uDCA1 圣诞节风格包含动态背景和背景音乐"}),"official"===U.page_style&&(0,a.jsx)("p",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"\uD83D\uDCA1 官网风格使用网站官方设计风格"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"URL别名 (page_slug)"}),(0,a.jsx)(i.II,{value:U.page_slug,onChange:e=>ee(W,"page_slug",e.target.value)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"状态 (status)"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:U.status,onChange:e=>ee(W,"status",e.target.value),children:D.map(e=>(0,a.jsx)("option",{value:e,children:"published"===e?"Published":"Draft"},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"优先级 (priority)"}),(0,a.jsx)(i.II,{type:"number",value:U.priority,onChange:e=>ee(W,"priority",e.target.value)})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"产品 (product)"}),(0,a.jsx)(i.II,{value:U.product,onChange:e=>ee(W,"product",e.target.value),placeholder:"e.g., Sora2 Video"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"服务/功能 (service)"}),(0,a.jsx)(i.II,{value:U.service,onChange:e=>ee(W,"service",e.target.value),placeholder:"e.g., Online Generator"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"地区 (region)"}),(0,a.jsx)(i.II,{value:U.region,onChange:e=>ee(W,"region",e.target.value),placeholder:"e.g., US, UK, Global"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"痛点/场景 (pain_point)"}),(0,a.jsx)(i.II,{value:U.pain_point,onChange:e=>ee(W,"pain_point",e.target.value),placeholder:"e.g., Batch Content Creation"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"搜索量 (search_volume)"}),(0,a.jsx)(i.II,{type:"number",value:U.search_volume,onChange:e=>ee(W,"search_volume",e.target.value),placeholder:"e.g., 90"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"竞争度 (competition_score)"}),(0,a.jsx)(i.II,{type:"number",step:"0.01",value:U.competition_score,onChange:e=>ee(W,"competition_score",e.target.value),placeholder:"0 - 1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"H1标题 (h1)"}),(0,a.jsx)(i.II,{value:U.h1,onChange:e=>ee(W,"h1",e.target.value),placeholder:"Main heading (H1)"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"页面标题 (title)"}),(0,a.jsx)(i.gx,{rows:2,value:U.title,onChange:e=>ee(W,"title",e.target.value),placeholder:"Page title containing keyword"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"元描述 (meta_description)"}),(0,a.jsx)(i.gx,{rows:2,value:U.meta_description,onChange:e=>ee(W,"meta_description",e.target.value),placeholder:"140-160 characters, naturally includes long-tail keyword"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"介绍段落 (intro_paragraph)"}),(0,a.jsx)(i.gx,{rows:4,value:U.intro_paragraph,onChange:e=>ee(W,"intro_paragraph",e.target.value),placeholder:"150-300 words, describes the search intent"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"步骤 (steps)"}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>ea(W),children:"添加步骤"})]}),U.steps.map((e,t)=>{var s;let r=e.title.startsWith("Part ")&&!e.description;return(0,a.jsx)("div",{className:r?"col-span-2":"grid gap-2 md:grid-cols-2",children:r?(0,a.jsx)("div",{className:"rounded-lg border-2 border-blue-300 bg-blue-50 p-3 dark:border-blue-700 dark:bg-blue-950/30",children:(0,a.jsx)(i.II,{value:e.title,onChange:e=>et(W,t,"title",e.target.value),placeholder:"Part Title",className:"font-semibold text-blue-700 dark:text-blue-300"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.II,{value:e.title,onChange:e=>et(W,t,"title",e.target.value),placeholder:"Step ".concat(t+1," Title")}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.gx,{rows:2,value:null!==(s=e.description)&&void 0!==s?s:"",onChange:e=>et(W,t,"description",e.target.value)}),U.steps.length>1&&(0,a.jsx)(i.zx,{type:"button",variant:"ghost",onClick:()=>en(W,t),children:"Delete"})]})]})},"edit-step-".concat(t))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"常见问题 (faq)"}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>er(W),children:"添加FAQ"})]}),U.faq.map((e,t)=>(0,a.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,a.jsx)(i.II,{value:e.question,onChange:e=>es(W,t,"question",e.target.value),placeholder:"Question ".concat(t+1)}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.gx,{rows:2,value:e.answer,onChange:e=>es(W,t,"answer",e.target.value)}),U.faq.length>1&&(0,a.jsx)(i.zx,{type:"button",variant:"ghost",onClick:()=>ei(W,t),children:"Delete"})]})]},"edit-faq-".concat(t)))]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(i.zx,{type:"button",variant:"outline",onClick:()=>V(null),disabled:Y,children:"Cancel"}),(0,a.jsx)(i.zx,{type:"submit",disabled:Y,children:Y?"Saving...":"Save Changes"})]})]})})]})]})}var q=s(3075);function V(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)(!0),[l,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)({}),[u,m]=(0,r.useState)([]),[g,h]=(0,r.useState)([]),[p,x]=(0,r.useState)(!1),[y,f]=(0,r.useState)({}),[b,v]=(0,r.useState)(null),j=(0,r.useRef)({}),k=(0,r.useCallback)(async()=>{try{n(!0);let e=await fetch("/api/admin/homepage"),s=await e.json();if(401===e.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}if(!e.ok||!s.success)throw Error(s.error||"加载配置失败");s.settings?c(s.settings):c({hero_badge_text:"Sora 2 AI Control Center",hero_h1_text:"Turn cinematic ideas into deployable Sora 2.0 workflows.",hero_h1_text_logged_in:"Welcome back, Creator!",hero_description:"Operate from a focused dashboard that keeps the cosmic atmosphere but prioritizes productivity.",hero_image_paths:[],hero_image_alt_texts:[],hero_video_paths:[],theme_style:"cosmic",primary_color:"#3B82F6",secondary_color:"#8B5CF6",accent_color:"#F59E0B",background_gradient:"cosmic-space",cta_primary_text:"Open Video Console",cta_primary_text_logged_out:"Sign in to Start",cta_secondary_text:"Browse Prompt Library"})}catch(e){console.error("加载首页配置失败:",e),t("error",e instanceof Error?e.message:"加载配置失败")}finally{n(!1)}},[t]);(0,r.useEffect)(()=>{k(),w()},[]);let w=(0,r.useCallback)(async()=>{try{x(!0),v(null);let[e,s]=await Promise.all([fetch("/api/admin/r2/list?type=image&maxKeys=100"),fetch("/api/admin/r2/list?type=video&maxKeys=100")]),a=await e.json(),r=await s.json(),n=null,i=null,l=!1;if(401===e.status||401===s.status){l=!0,n="未授权，请先登录管理员账户",i="需要管理员权限才能访问R2文件列表。请先登录。",v("".concat(n,"\n").concat(i)),t("error",n),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}if(a.success)m(a.files.map(e=>({key:e.key||"",url:e.url||(0,q.WP)(e.key||"")})));else if(n=a.error||"加载图片列表失败",i=a.details||a.error,a.troubleshooting||a.config){let e=a.config?"\n配置状态: ".concat(JSON.stringify(a.config,null,2)):"",t=a.troubleshooting?"\n故障排除:\n".concat(Object.entries(a.troubleshooting).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join("\n")):"";i="".concat(i).concat(e).concat(t)}if(r.success)h(r.files.map(e=>({key:e.key||"",url:e.url||(0,q.WP)(e.key||"")})));else if(!n&&(n=r.error||"加载视频列表失败",i=r.details||r.error,r.troubleshooting||r.config)){let e=r.config?"\n配置状态: ".concat(JSON.stringify(r.config,null,2)):"",t=r.troubleshooting?"\n故障排除:\n".concat(Object.entries(r.troubleshooting).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join("\n")):"";i="".concat(i).concat(e).concat(t)}if(n&&!l){let e=i?"".concat(n,"\n").concat(i):n;v(e),console.error("R2加载错误:",{errorMessage:n,errorDetails:i,imagesData:a,videosData:r})}}catch(e){console.error("加载R2文件列表失败:",e),v("加载文件列表失败，请检查R2配置")}finally{x(!1)}},[t]),N=(0,r.useCallback)(async(e,s,a)=>{try{let r="video"===a?"video-".concat(s):s;f(e=>({...e,[r]:!0}));let n=new FormData;n.append("file",e),n.append("folder","image"===a?"images":"videos");let i=await fetch("/api/admin/r2/upload",{method:"POST",body:n});if(401===i.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}let l=await i.json();if(!i.ok||!l.success)throw Error(l.error||"上传失败");let o="image"===a?"hero_image_paths":"hero_video_paths";c(e=>{let t=[...e[o]||[]];return t[s]=l.file.key,{...e,[o]:t}}),await w(),t("success","文件上传成功")}catch(e){console.error("上传文件失败:",e),t("error",e instanceof Error?e.message:"上传失败")}finally{let e="video"===a?"video-".concat(s):s;f(t=>({...t,[e]:!1}))}},[w,t]),_=(0,r.useCallback)(async()=>{try{o(!0);let e=await fetch("/api/admin/homepage",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(401===e.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}let s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"保存失败");t("success","首页配置已保存")}catch(e){console.error("保存首页配置失败:",e),t("error",e instanceof Error?e.message:"保存失败")}finally{o(!1)}},[d,t]),C=(e,t,s)=>{let a=[...d[e]||[]];a[t]=s,c(t=>({...t,[e]:a}))},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=d[e]||[];c(a=>({...a,[e]:[...s,t]}))},I=(e,t)=>{let s=(d[e]||[]).filter((e,s)=>s!==t);c(t=>({...t,[e]:s}))};return s?(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"py-8",children:(0,a.jsx)("p",{className:"text-center text-gray-500",children:"加载中..."})})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"首页配置管理"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"管理首页的标题、描述、图片、视频和风格设置"})]}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Hero Section（顶部横幅区域）"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Badge 文本"}),(0,a.jsx)(i.II,{value:d.hero_badge_text||"",onChange:e=>c(t=>({...t,hero_badge_text:e.target.value})),placeholder:"例如: Sora 2 AI Control Center"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"H1 标题（未登录用户）"}),(0,a.jsx)(i.II,{value:d.hero_h1_text||"",onChange:e=>c(t=>({...t,hero_h1_text:e.target.value})),placeholder:"主标题文本"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"H1 标题（已登录用户）"}),(0,a.jsx)(i.II,{value:d.hero_h1_text_logged_in||"",onChange:e=>c(t=>({...t,hero_h1_text_logged_in:e.target.value})),placeholder:"例如: Welcome back, {name}!"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"描述文本"}),(0,a.jsx)(i.gx,{value:d.hero_description||"",onChange:e=>c(t=>({...t,hero_description:e.target.value})),placeholder:"描述文本",rows:3})]})]}),(0,a.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"图片配置"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"从R2选择图片、手动输入路径或上传新图片，九宫格展示"}),b&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-sm",children:[(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400 font-semibold",children:"R2配置错误"}),(0,a.jsx)("pre",{className:"text-red-500 dark:text-red-300 text-xs mt-1 whitespace-pre-wrap break-words",children:b}),(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400 text-xs mt-2",children:"提示：检查 Vercel 环境变量设置，确保 R2_SECRET_ACCESS_KEY 是密钥字符串（不是URL）"})]}),!p&&0===u.length&&!b&&(0,a.jsx)("p",{className:"text-sm text-yellow-500 mt-1",children:"R2中暂无图片，可手动输入路径或上传"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:w,disabled:p,children:p?"刷新中...":"刷新列表"}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>S("hero_image_paths"),children:"+ 添加图片"}),(0,a.jsx)(i.zx,{variant:"primary",size:"sm",onClick:_,disabled:l,children:l?"保存中...":"保存图片设置"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:(d.hero_image_paths||[]).map((e,t)=>(0,a.jsxs)("div",{className:"border rounded-lg p-3 space-y-2 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"relative w-full aspect-square border rounded overflow-hidden bg-gray-100 dark:bg-gray-800",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:(0,q.WP)(e),alt:"Preview ".concat(t+1),className:"w-full h-full object-cover",onError:t=>{let s=t.target;s.style.display="none";let a=s.parentElement;if(a){let t=e.length>30?e.substring(0,30)+"...":e;a.innerHTML='\n                                <div class="flex flex-col items-center justify-center h-full text-gray-400 text-xs p-2 text-center">\n                                  <div class="mb-1">图片加载失败</div>\n                                  <div class="text-[10px] opacity-75 break-all">'.concat(t,'</div>\n                                  <div class="text-[10px] opacity-60 mt-1">请检查路径是否正确</div>\n                                </div>\n                              ')}}}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0 bg-red-500 hover:bg-red-600 text-white",onClick:()=>I("hero_image_paths",t),children:"\xd7"})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:"未设置"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{value:u.some(t=>t.key===e)?e:"",onChange:e=>{e.target.value&&C("hero_image_paths",t,e.target.value)},className:"w-full px-2 py-1 border rounded text-xs",children:[(0,a.jsx)("option",{value:"",children:"-- 从R2选择图片 --"}),u.map(e=>(0,a.jsx)("option",{value:e.key,children:e.key.split("/").pop()},e.key))]})}),(0,a.jsx)(i.II,{value:e,onChange:e=>C("hero_image_paths",t,e.target.value),placeholder:"或手动输入路径，如: images/hero.jpg 或 https://...",className:"text-xs h-8"}),(0,a.jsx)(i.II,{value:(d.hero_image_alt_texts||[])[t]||"",onChange:e=>C("hero_image_alt_texts",t,e.target.value),placeholder:"Alt ".concat(t+1),className:"text-xs h-8"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{ref:e=>{j.current[t]=e},type:"file",accept:"image/*",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&N(a,t,"image")}}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>{var e;return null===(e=j.current[t])||void 0===e?void 0:e.click()},disabled:y[t],className:"w-full h-8 text-xs",children:y[t]?"上传中...":"上传"})]})]},t))})]}),(0,a.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"视频配置"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"从R2选择视频、手动输入路径或上传新视频，九宫格展示"}),!p&&0===g.length&&!b&&(0,a.jsx)("p",{className:"text-sm text-yellow-500 mt-1",children:"R2中暂无视频，可手动输入路径或上传"}),b&&(0,a.jsxs)("div",{className:"mt-2 p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-sm",children:[(0,a.jsx)("p",{className:"text-red-600 dark:text-red-400 font-semibold",children:"R2配置错误"}),(0,a.jsx)("pre",{className:"text-red-500 dark:text-red-300 text-xs mt-1 whitespace-pre-wrap break-words",children:b})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:w,disabled:p,children:p?"刷新中...":"刷新列表"}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>S("hero_video_paths"),children:"+ 添加视频"}),(0,a.jsx)(i.zx,{variant:"primary",size:"sm",onClick:_,disabled:l,children:l?"保存中...":"保存视频设置"})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:(d.hero_video_paths||[]).map((e,t)=>(0,a.jsxs)("div",{className:"border rounded-lg p-3 space-y-2 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"relative w-full aspect-square border rounded overflow-hidden bg-gray-100 dark:bg-gray-800",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("video",{src:(0,q.WP)(e),className:"w-full h-full object-cover",controls:!0,muted:!0}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0 bg-red-500 hover:bg-red-600 text-white",onClick:()=>I("hero_video_paths",t),children:"\xd7"})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs",children:"未设置"})}),(0,a.jsx)("div",{children:(0,a.jsxs)("select",{value:g.some(t=>t.key===e)?e:"",onChange:e=>{e.target.value&&C("hero_video_paths",t,e.target.value)},className:"w-full px-2 py-1 border rounded text-xs",children:[(0,a.jsx)("option",{value:"",children:"-- 从R2选择视频 --"}),g.map(e=>(0,a.jsx)("option",{value:e.key,children:e.key.split("/").pop()},e.key))]})}),(0,a.jsx)(i.II,{value:e,onChange:e=>C("hero_video_paths",t,e.target.value),placeholder:"或手动输入路径，如: videos/demo.mp4 或 https://...",className:"text-xs h-8"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{ref:e=>{j.current["video-".concat(t)]=e},type:"file",accept:"video/*",className:"hidden",onChange:e=>{var s;let a=null===(s=e.target.files)||void 0===s?void 0:s[0];a&&N(a,t,"video")}}),(0,a.jsx)(i.zx,{type:"button",variant:"secondary",size:"sm",onClick:()=>{var e;return null===(e=j.current["video-".concat(t)])||void 0===e?void 0:e.click()},disabled:y["video-".concat(t)],className:"w-full h-8 text-xs",children:y["video-".concat(t)]?"上传中...":"上传"})]})]},t))})]}),(0,a.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"风格配置"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"主题风格"}),(0,a.jsxs)("select",{value:d.theme_style||"cosmic",onChange:e=>c(t=>({...t,theme_style:e.target.value})),className:"w-full px-3 py-2 border rounded-md",children:[(0,a.jsx)("option",{value:"cosmic",children:"Cosmic（宇宙风格）"}),(0,a.jsx)("option",{value:"minimal",children:"Minimal（简约风格）"}),(0,a.jsx)("option",{value:"modern",children:"Modern（现代风格）"}),(0,a.jsx)("option",{value:"classic",children:"Classic（经典风格）"}),(0,a.jsx)("option",{value:"christmas",children:"Christmas（圣诞节风格）\uD83C\uDF84"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"主色调"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.II,{type:"color",value:d.primary_color||"#3B82F6",onChange:e=>c(t=>({...t,primary_color:e.target.value})),className:"w-16 h-10"}),(0,a.jsx)(i.II,{value:d.primary_color||"#3B82F6",onChange:e=>c(t=>({...t,primary_color:e.target.value})),placeholder:"#3B82F6"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"次色调"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.II,{type:"color",value:d.secondary_color||"#8B5CF6",onChange:e=>c(t=>({...t,secondary_color:e.target.value})),className:"w-16 h-10"}),(0,a.jsx)(i.II,{value:d.secondary_color||"#8B5CF6",onChange:e=>c(t=>({...t,secondary_color:e.target.value})),placeholder:"#8B5CF6"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"强调色"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.II,{type:"color",value:d.accent_color||"#F59E0B",onChange:e=>c(t=>({...t,accent_color:e.target.value})),className:"w-16 h-10"}),(0,a.jsx)(i.II,{value:d.accent_color||"#F59E0B",onChange:e=>c(t=>({...t,accent_color:e.target.value})),placeholder:"#F59E0B"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"背景渐变样式"}),(0,a.jsx)(i.II,{value:d.background_gradient||"cosmic-space",onChange:e=>c(t=>({...t,background_gradient:e.target.value})),placeholder:"cosmic-space"})]})]}),(0,a.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"按钮文本配置"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"主要按钮文本（已登录）"}),(0,a.jsx)(i.II,{value:d.cta_primary_text||"",onChange:e=>c(t=>({...t,cta_primary_text:e.target.value})),placeholder:"例如: Open Video Console"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"主要按钮文本（未登录）"}),(0,a.jsx)(i.II,{value:d.cta_primary_text_logged_out||"",onChange:e=>c(t=>({...t,cta_primary_text_logged_out:e.target.value})),placeholder:"例如: Sign in to Start"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"次要按钮文本"}),(0,a.jsx)(i.II,{value:d.cta_secondary_text||"",onChange:e=>c(t=>({...t,cta_secondary_text:e.target.value})),placeholder:"例如: Browse Prompt Library"})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[(0,a.jsx)(i.zx,{variant:"secondary",onClick:k,disabled:l,children:"重置"}),(0,a.jsx)(i.zx,{variant:"primary",onClick:_,disabled:l,children:l?"保存中...":"保存配置"})]})]})]}),(0,a.jsx)(U,{onShowBanner:t})]})}function U(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)({}),[u,m]=(0,r.useState)(null),[g,h]=(0,r.useState)({}),[p,x]=(0,r.useState)(!1),[y,f]=(0,r.useState)({}),b=e=>{let t=String(e||"").trim();if(!t)return"";let s=t.match(/buy\.stripe\.com\/([a-zA-Z0-9]+)(?:\?|$)/);return(null==s?void 0:s[1])?s[1]:t},v=(0,r.useCallback)(async()=>{try{o(!0);let e=await fetch("/api/admin/payment-plans");if(401===e.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}let s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"加载支付计划失败");n(s.plans||[])}catch(e){console.error("加载支付计划失败:",e),t("error",e instanceof Error?e.message:"加载支付计划失败")}finally{o(!1)}},[t]);(0,r.useEffect)(()=>{v()},[v]);let j=(0,r.useCallback)(async e=>{try{c(t=>({...t,[e.id]:!0}));let s={};Object.keys(g).forEach(e=>{let t=g[e];"string"==typeof t&&""===t.trim()?s[e]=null:void 0!==t&&(s[e]=t)});let a=await fetch("/api/admin/payment-plans",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.id,...s})});if(401===a.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}let r=await a.json();if(!a.ok||!r.success)throw Error(r.error||"保存失败");m(null),h({}),await v(),t("success","支付计划已更新")}catch(e){console.error("保存支付计划失败:",e),t("error",e instanceof Error?e.message:"保存失败")}finally{c(t=>({...t,[e.id]:!1}))}},[g,v,t]),k=(0,r.useCallback)(async()=>{try{c(e=>({...e,new:!0}));let e=await fetch("/api/admin/payment-plans",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(401===e.status){t("error","未授权，请先登录管理员账户"),setTimeout(()=>{window.location.href="/admin/login"},2e3);return}let s=await e.json();if(!e.ok||!s.success)throw Error(s.error||"创建失败");x(!1),f({}),await v(),t("success","支付计划已创建")}catch(e){console.error("创建支付计划失败:",e),t("error",e instanceof Error?e.message:"创建失败")}finally{c(e=>({...e,new:!1}))}},[y,v,t]);return l?(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"py-8",children:(0,a.jsx)("p",{className:"text-center text-gray-500",children:"加载支付计划中..."})})}):(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(i.ll,{children:"支付计划管理"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"管理支付计划的名称、价格、描述、Stripe按钮ID等"})]}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>x(!0),children:"+ 添加计划"})]})}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[p&&(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)("h4",{className:"font-semibold",children:"添加新支付计划"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"计划名称"}),(0,a.jsx)(i.II,{value:y.plan_name||"",onChange:e=>f(t=>({...t,plan_name:e.target.value})),placeholder:"例如: Basic Plan"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"计划类型"}),(0,a.jsxs)("select",{value:y.plan_type||"custom",onChange:e=>f(t=>({...t,plan_type:e.target.value})),className:"w-full px-3 py-2 border rounded-md",children:[(0,a.jsx)("option",{value:"basic",children:"Basic"}),(0,a.jsx)("option",{value:"professional",children:"Professional"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"价格 ($)"}),(0,a.jsx)(i.II,{type:"number",step:"0.01",value:y.amount||"",onChange:e=>f(t=>({...t,amount:parseFloat(e.target.value)})),placeholder:"39.00"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"视频数量"}),(0,a.jsx)(i.II,{type:"number",value:y.videos||"",onChange:e=>f(t=>({...t,videos:parseInt(e.target.value)})),placeholder:"50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"积分数量"}),(0,a.jsx)(i.II,{type:"number",value:y.credits||"",onChange:e=>f(t=>({...t,credits:parseInt(e.target.value)})),placeholder:"500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"显示顺序"}),(0,a.jsx)(i.II,{type:"number",value:y.display_order||0,onChange:e=>f(t=>({...t,display_order:parseInt(e.target.value)})),placeholder:"0"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"描述"}),(0,a.jsx)(i.gx,{value:y.description||"",onChange:e=>f(t=>({...t,description:e.target.value})),placeholder:"Perfect for individual users and small projects",rows:2})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stripe Buy Button ID"}),(0,a.jsx)(i.II,{value:y.stripe_buy_button_id||"",onChange:e=>f(t=>({...t,stripe_buy_button_id:e.target.value})),placeholder:"buy_btn_xxxxx"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stripe Payment Link ID"}),(0,a.jsx)(i.II,{value:y.stripe_payment_link_id||"",onChange:e=>f(t=>({...t,stripe_payment_link_id:b(e.target.value)})),placeholder:"Paste Payment Link token or full URL (e.g., https://buy.stripe.com/XXXX)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"徽章文本（可选）"}),(0,a.jsx)(i.II,{value:y.badge_text||"",onChange:e=>f(t=>({...t,badge_text:e.target.value})),placeholder:"Recommended"})]}),(0,a.jsxs)("div",{className:"col-span-2 flex items-center gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:!1!==y.is_active,onChange:e=>f(t=>({...t,is_active:e.target.checked}))}),(0,a.jsx)("span",{className:"text-sm",children:"启用"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:y.is_recommended||!1,onChange:e=>f(t=>({...t,is_recommended:e.target.checked}))}),(0,a.jsx)("span",{className:"text-sm",children:"推荐"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>{x(!1),f({})},children:"取消"}),(0,a.jsx)(i.zx,{variant:"primary",size:"sm",onClick:k,disabled:d.new,children:d.new?"创建中...":"创建计划"})]})]}),s.map(e=>{var t,s,r,n,l,o,c,p,x,y,f,v,k,w;return(0,a.jsx)("div",{className:"border rounded-lg p-4 space-y-4",children:u===e.id?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"计划名称"}),(0,a.jsx)(i.II,{value:null!==(t=g.plan_name)&&void 0!==t?t:e.plan_name,onChange:e=>h(t=>({...t,plan_name:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"计划类型"}),(0,a.jsxs)("select",{value:null!==(s=g.plan_type)&&void 0!==s?s:e.plan_type,onChange:e=>h(t=>({...t,plan_type:e.target.value})),className:"w-full px-3 py-2 border rounded-md",children:[(0,a.jsx)("option",{value:"basic",children:"Basic"}),(0,a.jsx)("option",{value:"professional",children:"Professional"}),(0,a.jsx)("option",{value:"custom",children:"Custom"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"价格 ($)"}),(0,a.jsx)(i.II,{type:"number",step:"0.01",value:null!==(r=g.amount)&&void 0!==r?r:e.amount,onChange:e=>h(t=>({...t,amount:parseFloat(e.target.value)}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"视频数量"}),(0,a.jsx)(i.II,{type:"number",value:null!==(n=g.videos)&&void 0!==n?n:e.videos,onChange:e=>h(t=>({...t,videos:parseInt(e.target.value)}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"积分数量"}),(0,a.jsx)(i.II,{type:"number",value:null!==(l=g.credits)&&void 0!==l?l:e.credits,onChange:e=>h(t=>({...t,credits:parseInt(e.target.value)}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"显示顺序"}),(0,a.jsx)(i.II,{type:"number",value:null!==(o=g.display_order)&&void 0!==o?o:e.display_order,onChange:e=>h(t=>({...t,display_order:parseInt(e.target.value)}))})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"描述"}),(0,a.jsx)(i.gx,{value:null!==(p=null!==(c=g.description)&&void 0!==c?c:e.description)&&void 0!==p?p:"",onChange:e=>h(t=>({...t,description:e.target.value})),rows:2})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stripe Buy Button ID"}),(0,a.jsx)(i.II,{value:null!==(y=null!==(x=g.stripe_buy_button_id)&&void 0!==x?x:e.stripe_buy_button_id)&&void 0!==y?y:"",onChange:e=>h(t=>({...t,stripe_buy_button_id:e.target.value}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Stripe Payment Link ID"}),(0,a.jsx)(i.II,{value:null!==(v=null!==(f=g.stripe_payment_link_id)&&void 0!==f?f:e.stripe_payment_link_id)&&void 0!==v?v:"",onChange:e=>h(t=>({...t,stripe_payment_link_id:b(e.target.value)}))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"徽章文本（可选）"}),(0,a.jsx)(i.II,{value:null!==(w=null!==(k=g.badge_text)&&void 0!==k?k:e.badge_text)&&void 0!==w?w:"",onChange:e=>h(t=>({...t,badge_text:e.target.value}))})]}),(0,a.jsxs)("div",{className:"col-span-2 flex items-center gap-4",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:void 0!==g.is_active?g.is_active:e.is_active,onChange:e=>h(t=>({...t,is_active:e.target.checked}))}),(0,a.jsx)("span",{className:"text-sm",children:"启用"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:void 0!==g.is_recommended?g.is_recommended:e.is_recommended,onChange:e=>h(t=>({...t,is_recommended:e.target.checked}))}),(0,a.jsx)("span",{className:"text-sm",children:"推荐"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>{m(null),h({})},children:"取消"}),(0,a.jsx)(i.zx,{variant:"primary",size:"sm",onClick:()=>j(e),disabled:d[e.id],children:d[e.id]?"保存中...":"保存"})]})]}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-lg",children:e.plan_name}),e.badge_text&&(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-energy-water text-white rounded",children:e.badge_text})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(e.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.is_active?"启用":"禁用"}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>{m(e.id),h({})},children:"编辑"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"价格:"}),(0,a.jsxs)("span",{className:"ml-2 font-semibold",children:["$",e.amount," ",e.currency.toUpperCase()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"视频:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold",children:e.videos})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"积分:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold",children:e.credits})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"单价:"}),(0,a.jsxs)("span",{className:"ml-2 font-semibold",children:["~ $",(e.amount/e.videos).toFixed(2),"/video"]})]})]}),e.description&&(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[e.stripe_buy_button_id&&(0,a.jsxs)("div",{children:["Stripe Button ID: ",(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:e.stripe_buy_button_id})]}),e.stripe_payment_link_id&&(0,a.jsxs)("div",{children:["Payment Link ID: ",(0,a.jsx)("code",{className:"bg-gray-100 px-1 rounded",children:e.stripe_payment_link_id})]})]})]})},e.id)})]})]})}let W={slug:"",title:"",description:"",h1:"",content:"",published_at:"",isPublished:!0,related_posts:"",seo_keywords:""},Y={published:{label:"Published",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},draft:{label:"Draft",className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}};function J(e){return e.split(",").map(e=>e.trim()).filter(e=>e.length>0)}function G(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(""),[g,p]=(0,r.useState)("all"),[b,v]=(0,r.useState)(W),[j,k]=(0,r.useState)(!1),[w,N]=(0,r.useState)(""),[_,C]=(0,r.useState)(!1),[S,I]=(0,r.useState)(null),[E,T]=(0,r.useState)(W),[P,D]=(0,r.useState)(!1),[A,z]=(0,r.useState)(null),O=(0,r.useCallback)(async()=>{o(!0),c(null);try{let e=await fetch("/api/admin/blog-posts"),t=await e.json().catch(()=>({}));if(!e.ok){let e=[];"string"==typeof t.error&&t.error.trim().length>0&&e.push(t.error.trim()),"string"==typeof t.details&&t.details.trim().length>0&&e.push(t.details.trim());let s=e.join(": ")||"Failed to fetch blog posts";throw Error(s)}let s=(Array.isArray(t.blogPosts)?t.blogPosts:[]).map(e=>(function(e){if(!e||"object"!=typeof e)return null;let t="string"==typeof e.id?e.id:null,s="string"==typeof e.slug?e.slug:"",a="string"==typeof e.title?e.title:"",r="string"==typeof e.description?e.description:"",n="string"==typeof e.h1?e.h1:"",i="string"==typeof e.content?e.content:"";return t&&s&&a&&r&&n&&i?{id:t,slug:s,title:a,description:r,h1:n,content:i,published_at:"string"==typeof e.published_at?e.published_at:null,is_published:"boolean"!=typeof e.is_published||e.is_published,related_posts:Array.isArray(e.related_posts)?e.related_posts.filter(e=>"string"==typeof e):[],seo_keywords:Array.isArray(e.seo_keywords)?e.seo_keywords.filter(e=>"string"==typeof e):[],created_at:"string"==typeof e.created_at?e.created_at:new Date().toISOString(),updated_at:"string"==typeof e.updated_at?e.updated_at:new Date().toISOString()}:null})(e)).filter(e=>!!e);n(s)}catch(e){console.error("Failed to fetch blog posts:",e),c(e instanceof Error?e.message:"Failed to fetch blog posts"),n([])}finally{o(!1)}},[]);(0,r.useEffect)(()=>{O()},[O]);let L=(0,r.useCallback)(async e=>{if(e.trim()){C(!0);try{let s=function(e){let t={},s=y(e,["slug","URL别名","url alias","URL","url","别名","alias","路径","path"]);s&&(t.slug=s.toLowerCase().replace(/[^a-z0-9-]/g,"-"));let a=y(e,["title","标题","Title","页面标题","page title","文章标题","article title","post title"]);a&&(t.title=a);let r=y(e,["description","描述","Description","元描述","meta description","摘要","summary","简介","introduction"]);r&&(t.description=r);let n=y(e,["h1","H1","H1标题","h1 title","主标题","main heading"]);n&&(t.h1=n);let i=y(e,["content","内容","Content","正文","body","文章内容","article content"]);if(!i){let t=e.match(/(?:content|内容|正文|body|文章内容)[：:]\s*([\s\S]+?)(?=\n\s*(?:slug|title|description|h1|published|related|seo|$))/i);if(t&&t[1])i=x(t[1]);else{let t=e.split("\n"),s=-1;for(let e=0;e<t.length;e++){let a=t[e].toLowerCase();if(a.includes("content")||a.includes("内容")||a.includes("正文")){s=e+1;break}}s>=0&&(i=x(t.slice(s).join("\n")))}}i&&(t.content=i);let l=y(e,["published_at","published","发布时间","publish date","发布日期","date"]);if(l){let e=new Date(l);isNaN(e.getTime())||(t.published_at=e.toISOString().split("T")[0])}let o=y(e,["is_published","isPublished","published","发布状态","publish status","status"]);if(o){let e=o.toLowerCase();t.isPublished=e.includes("true")||e.includes("是")||e.includes("yes")||e.includes("published")}return t.related_posts=f(e,["related_posts","related posts","相关文章","related articles","related"]),t.seo_keywords=f(e,["seo_keywords","seo keywords","SEO关键词","keywords","关键词","tags","标签"]),t}(e);v(e=>{let t={...e};return s.slug&&(t.slug=s.slug),s.title&&(t.title=s.title),s.description&&(t.description=s.description),s.h1&&(t.h1=s.h1),s.content&&(t.content=s.content),s.published_at&&(t.published_at=s.published_at),void 0!==s.isPublished&&(t.isPublished=s.isPublished),s.related_posts&&s.related_posts.length>0&&(t.related_posts=s.related_posts.join(", ")),s.seo_keywords&&s.seo_keywords.length>0&&(t.seo_keywords=s.seo_keywords.join(", ")),t});let a=Object.keys(s).filter(e=>{let t=s[e];return Array.isArray(t)?t.length>0:null!=t&&""!==t}).length;t("success","Successfully recognized and filled ".concat(a," fields"))}catch(e){console.error("Text recognition failed:",e),t("error",e instanceof Error?e.message:"Text recognition failed")}finally{C(!1)}}},[t]),R=(0,r.useMemo)(()=>{let e=u.trim().toLowerCase();return s.filter(t=>{let s="all"===g||("published"===g?t.is_published:!t.is_published),a=""===e||t.slug.toLowerCase().includes(e)||t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.h1.toLowerCase().includes(e);return s&&a})},[s,u,g]),B=async e=>{if(e.preventDefault(),!b.slug.trim()){t("error","Please enter article slug");return}if(!b.title.trim()){t("error","Please enter article title");return}if(!b.h1.trim()){t("error","Please enter H1 title");return}if(!b.content.trim()){t("error","Please enter article content");return}k(!0);try{let e=await fetch("/api/admin/blog-posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:b.slug.trim(),title:b.title.trim(),description:b.description.trim(),h1:b.h1.trim(),content:b.content.trim(),published_at:b.published_at||null,is_published:b.isPublished,related_posts:J(b.related_posts),seo_keywords:J(b.seo_keywords)})}),s=await e.json().catch(()=>({}));if(!e.ok){let e=[];"string"==typeof s.error&&s.error.trim().length>0&&e.push(s.error.trim()),"string"==typeof s.details&&s.details.trim().length>0&&e.push(s.details.trim());let t=e.join(": ")||"Failed to create blog post";throw Error(t)}t("success","Blog post created successfully"),v(W),await O()}catch(e){console.error("Failed to create blog post:",e),t("error",e instanceof Error?e.message:"Failed to create blog post")}finally{k(!1)}},M=e=>{I(e.id),T({slug:e.slug,title:e.title,description:e.description,h1:e.h1,content:e.content,published_at:e.published_at?e.published_at.split("T")[0]:"",isPublished:e.is_published,related_posts:e.related_posts.join(", "),seo_keywords:e.seo_keywords.join(", ")})},F=()=>{I(null),T(W)},H=async e=>{if(!E.slug.trim()||!E.title.trim()||!E.h1.trim()||!E.content.trim()){t("error","Please fill in all required fields");return}D(!0);try{let s=await fetch("/api/admin/blog-posts/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:E.slug.trim(),title:E.title.trim(),description:E.description.trim(),h1:E.h1.trim(),content:E.content.trim(),published_at:E.published_at||null,is_published:E.isPublished,related_posts:J(E.related_posts),seo_keywords:J(E.seo_keywords)})}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join(": ")||"Failed to update blog post";throw Error(t)}t("success","Blog post updated successfully"),I(null),T(W),await O()}catch(e){console.error("Failed to update blog post:",e),t("error",e instanceof Error?e.message:"Failed to update blog post")}finally{D(!1)}},q=async e=>{if(confirm("Are you sure you want to delete this blog post? This action cannot be undone.")){z(e);try{let s=await fetch("/api/admin/blog-posts/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join(": ")||"Failed to delete blog post";throw Error(t)}t("success","Blog post deleted successfully"),await O()}catch(e){console.error("Failed to delete blog post:",e),t("error",e instanceof Error?e.message:"Failed to delete blog post")}finally{z(null)}}};return l?(0,a.jsx)("div",{className:"p-6",children:"Loading..."}):d?(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:["Error: ",d]}),(0,a.jsx)(i.zx,{onClick:O,className:"mt-4",children:"Retry"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"Create New Blog Post"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,a.jsx)(h,{textInput:w,onTextInputChange:N,onRecognize:L,isRecognizing:_,onShowBanner:t}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Slug *"}),(0,a.jsx)(i.II,{value:b.slug,onChange:e=>v({...b,slug:e.target.value}),placeholder:"best-sora-alternatives",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Publish Date"}),(0,a.jsx)(i.II,{type:"date",value:b.published_at,onChange:e=>v({...b,published_at:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Title *"}),(0,a.jsx)(i.II,{value:b.title,onChange:e=>v({...b,title:e.target.value}),placeholder:"Best Sora Alternatives for Creators in 2025",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Description *"}),(0,a.jsx)(i.gx,{value:b.description,onChange:e=>v({...b,description:e.target.value}),placeholder:"Discover the best Sora alternatives...",rows:2,required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"H1 Title *"}),(0,a.jsx)(i.II,{value:b.h1,onChange:e=>v({...b,h1:e.target.value}),placeholder:"Best Sora Alternatives for Creators in 2025",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Content (HTML) *"}),(0,a.jsx)(i.gx,{value:b.content,onChange:e=>v({...b,content:e.target.value}),placeholder:"<p>Article content...</p>",rows:10,required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Related Posts (comma-separated)"}),(0,a.jsx)(i.II,{value:b.related_posts,onChange:e=>v({...b,related_posts:e.target.value}),placeholder:"free-sora-alternative, sora-vs-runway"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"SEO Keywords (comma-separated)"}),(0,a.jsx)(i.II,{value:b.seo_keywords,onChange:e=>v({...b,seo_keywords:e.target.value}),placeholder:"sora alternative, ai video generator"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"new-is-published",checked:b.isPublished,onChange:e=>v({...b,isPublished:e.target.checked}),className:"rounded"}),(0,a.jsx)("label",{htmlFor:"new-is-published",className:"text-sm",children:"Publish immediately"})]}),(0,a.jsx)(i.zx,{type:"submit",disabled:j,children:j?"Creating...":"Create Blog Post"})]})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{children:["Blog Posts List (",R.length,")"]})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(i.II,{placeholder:"Search...",value:u,onChange:e=>m(e.target.value),className:"flex-1"}),(0,a.jsxs)("select",{value:g,onChange:e=>p(e.target.value),className:"px-3 py-2 border rounded",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"published",children:"Published"}),(0,a.jsx)("option",{value:"draft",children:"Draft"})]})]}),(0,a.jsx)("div",{className:"space-y-2",children:R.map(e=>(0,a.jsx)("div",{className:"border rounded-lg p-4 flex items-start justify-between gap-4",children:S===e.id?(0,a.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(i.II,{value:E.slug,onChange:e=>T({...E,slug:e.target.value}),placeholder:"slug"}),(0,a.jsx)(i.II,{type:"date",value:E.published_at,onChange:e=>T({...E,published_at:e.target.value})})]}),(0,a.jsx)(i.II,{value:E.title,onChange:e=>T({...E,title:e.target.value}),placeholder:"Title"}),(0,a.jsx)(i.gx,{value:E.description,onChange:e=>T({...E,description:e.target.value}),placeholder:"Description",rows:2}),(0,a.jsx)(i.II,{value:E.h1,onChange:e=>T({...E,h1:e.target.value}),placeholder:"H1"}),(0,a.jsx)(i.gx,{value:E.content,onChange:e=>T({...E,content:e.target.value}),placeholder:"Content (HTML)",rows:6}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:E.isPublished,onChange:e=>T({...E,isPublished:e.target.checked}),className:"rounded"}),(0,a.jsx)("label",{className:"text-sm",children:"Published"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",onClick:()=>H(e.id),disabled:P,children:P?"Saving...":"Save"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:F,children:"Cancel"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.title}),(0,a.jsx)(i.Ct,{className:Y[e.is_published?"published":"draft"].className,children:Y[e.is_published?"published":"draft"].label})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:["Slug: ",(0,a.jsx)("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:e.slug})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:e.description}),e.published_at&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Published: ",new Date(e.published_at).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>M(e),children:"Edit"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>q(e.id),disabled:A===e.id,children:A===e.id?"Deleting...":"Delete"})]})]})},e.id))})]})})]})]})}let $=["advertising-promotion","social-media-content","product-demo-showcase","brand-storytelling","education-explainer","ugc-creator-content"],Z=["Social Media Marketing","TikTok Creators","Instagram Creators","YouTube Creators","Digital Marketing Agencies","E-commerce Stores","E-commerce Brands","Dropshipping Businesses","SaaS Companies","Product Marketing","Personal Branding","Personal IP Building"],K=["Online Courses","Coaches & Consultants","Coaching & Consulting","Real Estate Marketing","Fitness Trainers","Beauty & Skincare Brands","Beauty Brands","Skincare Brands","Fashion Brands","Restaurants & Cafes","Restaurants","Cafes","Travel Agencies","Travel & Tourism","Hotels & Resorts","Hotels","Event Promotion","Event Planning"],Q=["Mobile Apps","Startups","Gaming Content Creators","Education Content Creators","Photography & Videography","Wedding Planning","Interior Design","Architecture Firms","Automotive Marketing","Local Businesses"],X=["NGOs","Non-profit Campaigns","Museums & Exhibitions","Art Projects","Music Promotion","Podcasts","Book Publishing","Language Learning","Career Coaching","HR & Recruitment"],ee=["Gambling","Casinos","Lottery","Adult Content","Pornography","Crack Software","Illegal Finance","Money Laundering","Private Servers"],et=[...Z,...K,...Q];[...Z,...K,...Q,...X];let es=new Map([...Z.map(e=>[e,5]),...K.map(e=>[e,4]),...Q.map(e=>[e,3]),...X.map(e=>[e,2]),...["Healthcare Clinics","Dental Clinics","Medical Services","Legal Services","Insurance","Finance Consulting","Crypto Education","Investment Courses","Government Programs","Universities"].map(e=>[e,1])]),ea=["TikTok Creators","YouTube Creators","Instagram Reels Creators","Short Video Matrix Accounts","AI Content Creators","Personal IP Building","Knowledge Bloggers","Tutorial Creators","Emotional Resonance Accounts","Storytelling Accounts","Motivation Accounts","Meditation & Relaxation Content","Music Visualization Creators","ASMR Creators","Animated Short Video Accounts","Drama Short Creators","Meme Content Accounts","AI Tool Review Bloggers","Tech Review Bloggers","Lifestyle Bloggers","E-commerce Brands","DTC Brands","Beauty Brands","Skincare Brands","Perfume Brands","Jewelry Brands","Watch Brands","Fashion Brands","Shoe Brands","Bag Brands","Home Goods Brands","Furniture Brands","Smart Home Brands","Kitchenware Brands","Consumer Electronics","Phone Accessories Brands","AI Hardware Brands","Toy Brands","Collectible Toy Brands","Pet Products Brands","Pet Food Brands","Baby Products Brands","Healthy Lifestyle Brands","Outdoor Gear Brands","Sports Equipment Brands","Marketing Agencies","Advertising Agencies","Social Media Management","Brand Consulting","Content Marketing Companies","Startup Promotion","SaaS Product Marketing","AI Tool Promotion","App Promotion","Game Promotion","Mobile App Showcase","Online Platform Promotion","Membership Product Promotion","Subscription Products","Online Course Promotion","Education Product Marketing","Language Learning Products","Coding Learning Platforms","Professional Skills Training","Personal Growth Courses","Restaurant Brands","Cafes","Bars","Bubble Tea Brands","Hotel Brands","Boutique Hotels","Travel Destinations","Travel Agencies","Outdoor Experience Brands","Adventure Experience Brands","Wedding Planning","Event Planning","Exhibition Events","Brand Pop-ups","Urban Lifestyle Promotion","Music Labels","Independent Musicians","Visual Art Projects","Digital Artists","NFT & Digital Collectibles","Animation IP","Comic IP","Game World Content","Virtual Character IP","Virtual Idols","Script Writing Accounts","Novel IP Promotion","Film Concept Promotion","Trailer Production","Sci-Fi Content Creation","Emotional Healing Content","Meditation Space Content","Aesthetic Video Accounts","Premium Visual Content","Abstract Art Content"],er=["Real Estate","E-commerce","Fashion","Beauty & Cosmetics","Fitness","Health & Wellness","Education","Online Courses","Coaching & Consulting","Restaurants","Cafes","Hotels","Travel & Tourism","Automotive","Technology","Software & SaaS","Marketing Agencies","Digital Creators","YouTube Channels","TikTok Creators","Instagram Influencers","Photography","Wedding Planning","Event Planning","Jewelry","Home Decor","Furniture","Architecture","Interior Design","Construction","Finance","Insurance","Gaming","Mobile Apps","Industrial Manufacturing","Logistics","Transportation","Sports Teams","Personal Training","Nutrition","Parenting","Pets","Veterinary Clinics","Nonprofits","Universities","High Schools","Language Learning","Music","Art","Animation","Comics & Manga","Publishing","Authors & Writers","HR & Recruitment","Corporate Training","Cybersecurity","AI & Machine Learning","Robotics","Agriculture","Food Production","Beverage Brands","Consumer Electronics","Home Appliances","Renewable Energy","Solar Panels","Fitness Equipment","Outdoor Gear","Sports Equipment","Toys","Kids Education","Museums","Libraries","Spirituality","Meditation","Yoga","Science","Biology Education","Chemistry Education","Physics Education","Environment","Wildlife","Car Dealerships","Motorcycle Brands","Fashion Designers","Make-up Artists","Hair Salons","Spas","Tattoo Artists","Barber Shops","Florists","Bakeries","Bookstores","Printing Companies"];function en(e){if(!e||"string"!=typeof e)return"";let t=(e.length>150?e.substring(0,150):e).trim().toLowerCase().replace(/[\s_]+/g,"-").replace(/[^a-z0-9-]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"");return t.length>100?t.substring(0,100):t}let ei=[{industry:"Digital Marketing Agencies",businessTier:"premium",recommendedPlatforms:[{platform:"All",scenarios:["Client ads","White-label videos","Multi-brand campaigns","Performance creatives"]}],pricingStrategy:{suggestedPlans:["Enterprise","Team","Annual"],featureLevel:"enterprise",notes:'强调"转化"，推高阶套餐，年付+团队账号'},contentStrategy:{focus:["转化率","ROI","客户案例","批量生成"],avoid:["基础教程"],notes:"重点强调转化效果和批量生产能力"}},{industry:"E-commerce Stores",businessTier:"premium",recommendedPlatforms:[{platform:"TikTok",scenarios:["Product demo","UGC-style ads","Dropshipping videos"]},{platform:"Instagram",scenarios:["Product demo","UGC-style ads","Seasonal promotions"]},{platform:"Ads",scenarios:["Performance creatives","Conversion ads"]}],pricingStrategy:{suggestedPlans:["Professional","Annual"],featureLevel:"professional",notes:'强调"转化"，推高阶套餐'},contentStrategy:{focus:["产品展示","转化率","季节性营销"],avoid:["艺术性内容"],notes:"重点强调销售转化"}},{industry:"SaaS Companies",businessTier:"premium",recommendedPlatforms:[{platform:"YouTube",scenarios:["Product demo","Feature explainer","Onboarding videos"]},{platform:"Website",scenarios:["Landing page videos","Product demo"]},{platform:"Ads",scenarios:["Performance creatives"]}],pricingStrategy:{suggestedPlans:["Enterprise","Team","Annual"],featureLevel:"enterprise",notes:"更高积分消耗，高阶模型，团队&API"},contentStrategy:{focus:["产品演示","功能说明","用户引导"],avoid:["娱乐内容"],notes:"专业、清晰、转化导向"}},{industry:"Personal Branding",businessTier:"premium",recommendedPlatforms:[{platform:"Instagram",scenarios:["Authority building","Thought leadership","Aesthetic videos"]},{platform:"TikTok",scenarios:["Faceless content","Daily short videos"]},{platform:"YouTube",scenarios:["Authority building","Thought leadership"]}],pricingStrategy:{suggestedPlans:["Professional","Annual"],featureLevel:"professional",notes:"年付+团队账号"},contentStrategy:{focus:["个人品牌","权威性","持续输出"],avoid:["一次性内容"],notes:"强调品牌一致性和长期价值"}},{industry:"Coaches & Consultants",businessTier:"premium",recommendedPlatforms:[{platform:"YouTube",scenarios:["Educational content","Authority building"]},{platform:"Instagram",scenarios:["Educational shorts","Authority building"]}],pricingStrategy:{suggestedPlans:["Professional","Annual"],featureLevel:"professional",notes:"年付+团队账号"},contentStrategy:{focus:["教育内容","权威性","客户案例"],avoid:["娱乐内容"],notes:"专业、有价值、转化导向"}},{industry:"Beauty & Skincare Brands",businessTier:"premium",recommendedPlatforms:[{platform:"Instagram",scenarios:["Product visuals","Before/after storytelling","Brand aesthetic videos"]},{platform:"TikTok",scenarios:["Product visuals","Before/after storytelling"]}],pricingStrategy:{suggestedPlans:["Professional","Annual"],featureLevel:"professional",notes:'强调"转化"，推高阶套餐'},contentStrategy:{focus:["产品视觉效果","前后对比","品牌美学"],avoid:["低质量内容"],notes:"高质量视觉，品牌一致性"}},{industry:"Real Estate Marketing",businessTier:"premium",recommendedPlatforms:[{platform:"YouTube",scenarios:["Property showcase","Listing videos","Realtor branding"]},{platform:"Instagram",scenarios:["Property showcase","Realtor branding"]}],pricingStrategy:{suggestedPlans:["Professional","Annual"],featureLevel:"professional",notes:'强调"转化"，推高阶套餐'},contentStrategy:{focus:["房产展示","房源视频","经纪人品牌"],avoid:["不相关内容"],notes:"专业、清晰、转化导向"}},{industry:"Fitness Trainers",businessTier:"standard",recommendedPlatforms:[{platform:"Instagram",scenarios:["Workout previews","Motivation clips","Program promotion"]},{platform:"TikTok",scenarios:["Workout previews","Motivation clips","Short-form education"]},{platform:"YouTube",scenarios:["Workout previews","Short-form education"]}],pricingStrategy:{suggestedPlans:["Monthly","Starter"],featureLevel:"starter",notes:"月订阅，场景模板，平台型套餐"},contentStrategy:{focus:["训练预览","激励内容","项目推广"],avoid:["完整课程"],notes:"短格式，高频更新"}},{industry:"Fashion Brands",businessTier:"standard",recommendedPlatforms:[{platform:"Instagram",scenarios:["Lookbook videos","Seasonal campaigns","Outfit inspiration"]},{platform:"TikTok",scenarios:["Lookbook videos","Seasonal campaigns"]}],pricingStrategy:{suggestedPlans:["Monthly","Starter"],featureLevel:"starter",notes:"月订阅，场景模板"},contentStrategy:{focus:["造型展示","季节性营销","穿搭灵感"],avoid:["非季节性内容"],notes:"时尚感，季节性"}},{industry:"Online Courses",businessTier:"standard",recommendedPlatforms:[{platform:"YouTube",scenarios:["Course promotion","Educational shorts","Webinar trailers"]},{platform:"Instagram",scenarios:["Course promotion","Educational shorts","Student testimonials"]}],pricingStrategy:{suggestedPlans:["Monthly","Starter"],featureLevel:"starter",notes:"月订阅，场景模板"},contentStrategy:{focus:["课程推广","教育短片","学员见证"],avoid:["完整课程内容"],notes:"推广导向，教育价值"}},{industry:"Restaurants & Cafes",businessTier:"standard",recommendedPlatforms:[{platform:"Instagram",scenarios:["Menu promotion","Atmosphere videos","Local ads"]},{platform:"TikTok",scenarios:["Menu promotion","Atmosphere videos"]}],pricingStrategy:{suggestedPlans:["Monthly","Starter"],featureLevel:"starter",notes:"月订阅，场景模板"},contentStrategy:{focus:["菜单推广","氛围视频","本地广告"],avoid:["不相关内容"],notes:"本地化，氛围感"}},{industry:"Travel Agencies",businessTier:"standard",recommendedPlatforms:[{platform:"Instagram",scenarios:["Destination videos","Hotel promotion","Experience storytelling"]},{platform:"YouTube",scenarios:["Destination videos","Experience storytelling"]}],pricingStrategy:{suggestedPlans:["Monthly","Starter"],featureLevel:"starter",notes:"月订阅，场景模板"},contentStrategy:{focus:["目的地视频","酒店推广","体验故事"],avoid:["不相关内容"],notes:"视觉冲击，体验感"}},{industry:"Students",businessTier:"traffic",recommendedPlatforms:[{platform:"TikTok",scenarios:["Educational content","Study tips"]},{platform:"Instagram",scenarios:["Educational content"]}],pricingStrategy:{suggestedPlans:["Free","Starter"],featureLevel:"starter",notes:"免费额度，模板限制，引导升级"},contentStrategy:{focus:["教育内容","学习技巧"],avoid:["商业内容"],notes:"免费内容为主，引导升级"}},{industry:"Hobby Creators",businessTier:"traffic",recommendedPlatforms:[{platform:"TikTok",scenarios:["Creative content"]},{platform:"Instagram",scenarios:["Creative content"]}],pricingStrategy:{suggestedPlans:["Free","Starter"],featureLevel:"starter",notes:"免费额度，模板限制"},contentStrategy:{focus:["创意内容"],avoid:["商业内容"],notes:"免费内容为主"}},{industry:"NGOs",businessTier:"traffic",recommendedPlatforms:[{platform:"All",scenarios:["Awareness campaigns","Storytelling"]}],pricingStrategy:{suggestedPlans:["Free","Starter"],featureLevel:"starter",notes:"免费额度，公益折扣"},contentStrategy:{focus:["意识提升","故事讲述"],avoid:["商业内容"],notes:"公益导向"}},{industry:"Artists",businessTier:"traffic",recommendedPlatforms:[{platform:"Instagram",scenarios:["Portfolio showcase"]},{platform:"TikTok",scenarios:["Creative process"]}],pricingStrategy:{suggestedPlans:["Free","Starter"],featureLevel:"starter",notes:"免费额度，模板限制"},contentStrategy:{focus:["作品展示","创作过程"],avoid:["商业内容"],notes:"艺术导向"}},{industry:"Small Local Shops",businessTier:"traffic",recommendedPlatforms:[{platform:"Instagram",scenarios:["Local ads","Product showcase"]},{platform:"TikTok",scenarios:["Local ads"]}],pricingStrategy:{suggestedPlans:["Free","Starter"],featureLevel:"starter",notes:"免费额度，引导升级"},contentStrategy:{focus:["本地广告","产品展示"],avoid:["大范围营销"],notes:"本地化，小规模"}}];function el(e){return ei.find(t=>t.industry===e)}function eo(e){if(!e)return null;let t=e&&es.get(e)||0;return 5===t?{label:"S级",color:"text-yellow-700 dark:text-yellow-300",bgColor:"bg-yellow-100 dark:bg-yellow-900/30"}:4===t?{label:"A+级",color:"text-green-700 dark:text-green-300",bgColor:"bg-green-100 dark:bg-green-900/30"}:3===t?{label:"A级",color:"text-blue-700 dark:text-blue-300",bgColor:"bg-blue-100 dark:bg-blue-900/30"}:2===t?{label:"B级",color:"text-gray-700 dark:text-gray-300",bgColor:"bg-gray-100 dark:bg-gray-900/30"}:1===t?{label:"C级",color:"text-gray-600 dark:text-gray-400",bgColor:"bg-gray-50 dark:bg-gray-800/30"}:null}function ed(e){if(!e)return null;let t=el(e);return t?"premium"===t.businessTier?{label:"高价行业",color:"text-purple-700 dark:text-purple-300",bgColor:"bg-purple-100 dark:bg-purple-900/30",icon:"\uD83D\uDCB0"}:"standard"===t.businessTier?{label:"中价行业",color:"text-blue-700 dark:text-blue-300",bgColor:"bg-blue-100 dark:bg-blue-900/30",icon:"⚖️"}:"traffic"===t.businessTier?{label:"流量行业",color:"text-green-700 dark:text-green-300",bgColor:"bg-green-100 dark:bg-green-900/30",icon:"\uD83D\uDCC8"}:null:null}function ec(e){return!(!e||e&&ee.includes(e))&&!!e&&et.includes(e)}function eu(e){let{onShowBanner:t,onGenerated:s,onFilterChange:n}=e,[l,o]=(0,r.useState)("marketing"),[d,c]=(0,r.useState)("grid"),u=(0,r.useMemo)(()=>"marketing"===l?ea:er,[l]),m=(0,r.useMemo)(()=>{let e=Array.from(u);return[...Z.map(e=>({industry:e,seoTier:5,recommended:!0})),...K.map(e=>({industry:e,seoTier:4,recommended:!0})),...Q.map(e=>({industry:e,seoTier:3,recommended:!0}))].map(e=>{let t=el(e.industry);return{...e,businessTier:(null==t?void 0:t.businessTier)||"none"}}).sort((e,t)=>e.seoTier!==t.seoTier?t.seoTier-e.seoTier:"premium"===e.businessTier&&"premium"!==t.businessTier?-1:"premium"===t.businessTier&&"premium"!==e.businessTier?1:e.industry.localeCompare(t.industry)).map(e=>e.industry).filter(t=>e.includes(t))},[u]),[g,h]=(0,r.useState)([]),[p,x]=(0,r.useState)(100),[y,f]=(0,r.useState)("advertising-promotion"),[b,v]=(0,r.useState)("US"),[j,k]=(0,r.useState)([]),[w,N]=(0,r.useState)(!1),[_,C]=(0,r.useState)(-1),[S,I]=(0,r.useState)(!1),[E,T]=(0,r.useState)(null),[P,D]=(0,r.useState)(null),[A,z]=(0,r.useState)(!0),O=(0,r.useRef)(!1),L=(0,r.useRef)(!1),R=(0,r.useRef)(y),B=(0,r.useRef)(!1),M=(0,r.useRef)(!0),F=(0,r.useRef)(null);R.current=y,(0,r.useEffect)(()=>{h([])},[l]);let H=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=1e3*(s+1);try{var r;let n;let i=t.use_case.length>100?t.use_case.substring(0,100)+"...":t.use_case,l=t.use_case.length>80?t.use_case.substring(0,80):t.use_case,o=en("".concat(e,"-").concat(l)),d="AI Video Generation for ".concat(t.use_case," in ").concat(e),c="Learn how to use AI video generation for ".concat(t.use_case," in the ").concat(e," industry. Create professional videos with Sora2."),u=t.use_case,m="# ".concat(d,"\n\n## Introduction\n\n").concat(u,"\n\n## Why AI Video is Perfect for This Scenario\n\nAI video generation offers several key advantages for ").concat(t.use_case," in the ").concat(e," industry:\n\n- **Fast Production**: Create professional videos in minutes instead of days or weeks\n- **Cost-Effective**: No need for expensive video production teams, equipment, or locations\n- **Consistent Quality**: AI ensures professional output every time, maintaining brand consistency\n- **Scalable**: Generate multiple variations easily for A/B testing or different markets\n- **Flexible**: Quickly adapt videos for different platforms (YouTube, TikTok, Instagram, etc.)\n\n## How to Use Sora2 for ").concat(t.use_case,"\n\n### Step 1: Create Your Video Prompt\n\nDescribe your ").concat(t.use_case," video needs in detail. Be specific about:\n- The scene or setting\n- The mood or tone\n- Key elements or actions\n- Style preferences (realistic, cinematic, animated, etc.)\n\n### Step 2: Choose Video Settings\n\nSelect your preferred aspect ratio:\n- **16:9** for YouTube, websites, presentations\n- **9:16** for TikTok, Instagram Stories, Shorts\n- **1:1** for Instagram posts, Facebook\n\nChoose video duration: **10 seconds** or **15 seconds** based on your needs.\n\n### Step 3: Generate Your Video\n\nClick generate and wait a few moments. Sora2's AI will create your professional video with high-quality visuals and smooth transitions.\n\n### Step 4: Download and Use\n\nOnce generated, download your video and use it immediately in your ").concat(e," marketing, training, or content strategy.\n\n## Example Prompt for ").concat(t.use_case,"\n\nHere's an example prompt you can use with Sora2 to generate a **10-second or 15-second** video:\n\n```\n[Example prompt based on the use case - will be generated based on scene description]\n```\n\n**Note**: All videos generated by Sora2 are available in 10-second or 15-second durations. Choose the duration that best fits your content needs.\n\n## Get Started Today\n\nStart creating professional ").concat(t.use_case," videos for ").concat(e," today with Sora2 AI video generation platform. No technical skills required, no expensive equipment needed - just describe what you want, and AI will create it for you.");try{console.log("[".concat(e,"] 开始质量检查..."),{titleLength:(null==i?void 0:i.length)||0,h1Length:(null==d?void 0:d.length)||0,descriptionLength:(null==c?void 0:c.length)||0,contentLength:(null==m?void 0:m.length)||0}),n=function(e){var t,s,a,r,n,i;try{let s=[],a=[],r=100;e.h1&&0!==e.h1.trim().length?e.h1.length<10&&(a.push("H1 标题过短"),r-=5):(s.push("missing_h1"),r-=20),e.title&&0!==e.title.trim().length||(s.push("missing_title"),r-=15),e.description&&0!==e.description.trim().length?e.description.length<50?(a.push("描述过短（建议至少 50 字）"),r-=5):e.description.length>300&&(a.push("描述过长（建议不超过 300 字）"),r-=3):(s.push("missing_description"),r-=15);let n=(null===(t=e.content)||void 0===t?void 0:t.length)||0;if(0===n?(s.push("content_too_short"),r-=30):n<300?(s.push("content_too_short"),r-=20):n<500?(a.push("内容较短（建议至少 500 字）"),r-=10):n>5e3&&(a.push("内容过长（建议不超过 5000 字）"),r-=5),e.seo_keywords&&0!==e.seo_keywords.length?e.seo_keywords.length<2&&(a.push("SEO 关键词过少（建议至少 2 个）"),r-=5):(s.push("missing_keywords"),r-=10),e.content){let t=(e.content.match(/^##\s+/gm)||[]).length;if(0===t?(s.push("poor_formatting"),r-=15):t<3&&(a.push("内容结构不完整（建议至少 3 个 H2 标题）"),r-=5),e.content.toLowerCase().includes("example prompt")||e.content.toLowerCase().includes("prompt example")||e.content.includes("```")||(s.push("missing_example_prompt"),r-=10),e.seo_keywords&&e.seo_keywords.length>0){let t=e.seo_keywords[0].toLowerCase();(e.content.toLowerCase().match(RegExp(t,"g"))||[]).length>10&&(s.push("keyword_stuffing"),r-=15)}let n=e.content.split("\n\n");n.filter(e=>e.length>300).length>.3*n.length&&(a.push("部分段落过长，可能影响可读性"),r-=5);let i=(e.content||"").toLowerCase(),l=(e.title||"").toLowerCase(),o=(e.description||"").toLowerCase(),d=(e.h1||"").toLowerCase(),c=!1;if(i)try{let e="".concat(l,"\n").concat(o,"\n").concat(i),t=["video duration","duration","seconds long","second video","video length","clip","时长","视频时长","generated video","生成一个"];if(["video","generate","create","prompt","duration","seconds","second","clip","视频","生成","时长"].some(t=>e.includes(t))){let s;let a=/\b([2-9][0-9]|[1-9]\d{2,})\s*[-\s]*(seconds?|sec|s|秒)\b/gi;for(;null!==(s=a.exec(e));){let e=parseInt(s[1],10);if(10!==e&&15!==e){c=!0;break}}if(!c){let a=/\b(\d+)\s*[-\s]*(minutes?|mins?|分钟)\b/gi;for(;null!==(s=a.exec(e));){let a=s.index,r=e.slice(Math.max(0,a-80),Math.min(e.length,a+80)),n=t.some(e=>r.includes(e)),i=["service","express","appointment","预约","服务","wait"].some(e=>r.includes(e)),l=["walk","drive","away","from","nearby","distance"].some(e=>r.includes(e));if(n&&!i&&!l){c=!0;break}}}}}catch(e){console.error("[checkContentQuality] video duration check failed:",e),c=!1}c&&(s.push("incorrect_video_duration"),r-=20,a.push("内容中提到了错误的视频时长（应该是 10 秒或 15 秒，不是分钟）"));let u=e=>{let t=new Set(["the","a","an","and","or","but","in","on","at","to","for","of","with","by","from","as","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","could","should","may","might","must","can","this","that","these","those","how","what","when","where","why","which","who","whom","whose","ai","video","generation","create","generate","use","using","used"]);return e.split(/\s+/).map(e=>e.replace(/[^\w]/g,"").toLowerCase()).filter(e=>e.length>=3&&!t.has(e))},m=u(l),g=u(o),h=u(d),p=[...new Set([...m,...g,...h])];if(p.length>0){let e=p.filter(e=>i.includes(e)).length/p.length;e<.3?(s.push("content_mismatch"),r-=25,a.push("内容与标题/描述不匹配（仅匹配 ".concat(Math.round(100*e),"% 的关键词）"))):e<.5&&(a.push("内容与标题/描述匹配度较低（仅匹配 ".concat(Math.round(100*e),"% 的关键词）")),r-=10)}}return r=Math.max(0,Math.min(100,r)),{passed:0===s.length&&r>=60,score:r,issues:s,warnings:a}}catch(t){return console.error("[checkContentQuality] 质量检查过程中发生错误:",t),console.error("[checkContentQuality] 错误堆栈:",t instanceof Error?t.stack:"No stack trace"),console.error("[checkContentQuality] 输入内容:",{titleLength:(null===(s=e.title)||void 0===s?void 0:s.length)||0,h1Length:(null===(a=e.h1)||void 0===a?void 0:a.length)||0,descriptionLength:(null===(r=e.description)||void 0===r?void 0:r.length)||0,contentLength:(null===(n=e.content)||void 0===n?void 0:n.length)||0,keywordsCount:(null===(i=e.seo_keywords)||void 0===i?void 0:i.length)||0}),{passed:!1,score:0,issues:["quality_check_error"],warnings:["质量检查失败: ".concat(t instanceof Error?t.message:String(t))]}}}({title:i,h1:d,description:c,content:m,seo_keywords:[t.use_case,e,"".concat(e," AI video")]}),console.log("[".concat(e,"] 质量检查完成:"),{score:n.score,issues:n.issues,passed:n.passed})}catch(t){console.error("[".concat(e,"] 质量检查失败:"),t),n={passed:!1,score:50,issues:["quality_check_error"],warnings:[]}}let g=n.passed&&n.score>=70?"approved":"pending",h={slug:o,title:i,h1:d,description:c,content:m,use_case_type:R.current,industry:e,is_published:"approved"===g,seo_keywords:[t.use_case,e,"".concat(e," AI video")],quality_status:g,quality_score:n.score,quality_issues:n.issues};console.log("[".concat(e,"] 发送保存请求:"),{slug:o.substring(0,50),titleLength:(null==i?void 0:i.length)||0,contentLength:(null==m?void 0:m.length)||0,useCaseType:R.current,qualityStatus:g,qualityScore:n.score});let p=await fetch("/api/admin/use-cases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)});if(0===s&&console.log("[".concat(e,"] 保存场景词成功:"),{slug:o,use_case_type:R.current,industry:e,title:i.substring(0,50)}),!p.ok){if((0===p.status||p.status>=500)&&s<3)return console.warn("[".concat(e,"] 保存场景词失败 (HTTP ").concat(p.status,")，").concat(a,"ms 后重试 (").concat(s+1,"/").concat(3,")...")),await new Promise(e=>setTimeout(e,a)),H(e,t,s+1);let r=await p.json().catch(()=>({}));throw Error(r.error||r.details||"保存失败: HTTP ".concat(p.status))}let x=await p.json();if(!(null===(r=x.useCase)||void 0===r?void 0:r.id))throw Error("保存成功但未返回 ID");return{id:x.useCase.id,slug:x.useCase.slug||o}}catch(r){if((r instanceof TypeError&&(r.message.includes("fetch")||r.message.includes("Failed to fetch")||r.message.includes("network")||r.message.includes("CONNECTION")||r.message.includes("ERR_CONNECTION"))||r instanceof Error&&(r.message.includes("ERR_CONNECTION_CLOSED")||r.message.includes("ERR_CONNECTION_REFUSED")||r.message.includes("ERR_CONNECTION_RESET")||r.message.includes("network")||r.message.includes("timeout")))&&s<3)return console.warn("[".concat(e,"] 网络错误 (").concat(r instanceof Error?r.message:"未知",")，").concat(a,"ms 后重试 (").concat(s+1,"/").concat(3,")...")),await new Promise(e=>setTimeout(e,a)),H(e,t,s+1);throw console.error("[".concat(e,"] 保存场景词最终失败:"),r),r}},q=async()=>{if(0===g.length){t("error","请至少选择一个行业");return}try{var e,s;let a=await fetch("/api/admin/batch-generation/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({industries:g,scenesPerIndustry:p,useCaseType:R.current,geo:b})}),r=await a.json().catch(()=>({error:"无法解析服务器响应，可能是服务器错误",details:"请检查 Vercel 日志或联系技术支持"}));if(!a.ok){let e=r.error||"启动任务失败";throw"PGRST205"===r.code||(null===(s=r.message)||void 0===s?void 0:s.includes("batch_generation_tasks"))?e="数据库表不存在！请在 Supabase Dashboard 中执行迁移 SQL。详情请查看 DATABASE_MIGRATION_BATCH_GENERATION_TASKS.md":r.details?e="".concat(e,": ").concat(r.details):r.hint&&(e="".concat(e," (提示: ").concat(r.hint,")")),Error(e)}(null===(e=r.task)||void 0===e?void 0:e.id)&&(localStorage.setItem("lastBatchTaskId",r.task.id),T(r.task.id));let n=g.map((e,t)=>({id:"industry-task-".concat(r.task.id,"-").concat(t),industry:e,status:"pending"}));k(n),N(!0),O.current=!1,L.current=!1,I(!1),W(r.task.id),t("success","任务已启动！任务ID: ".concat(r.task.id.substring(0,8),"... 即使关闭页面，任务也会在后台继续运行。"))}catch(s){console.error("启动任务失败:",s);let e="启动任务失败";s instanceof Error&&(e=s.message,(s.message.includes("Failed to fetch")||s.message.includes("500"))&&(e="服务器错误：可能是数据库表未创建。请检查 Vercel 日志或执行数据库迁移。")),t("error",e)}},V=(0,r.useCallback)(async()=>{try{return(await fetch("/api/auth/admin-refresh-session",{method:"POST"})).ok}catch(e){return!1}},[]),U=(0,r.useCallback)(async(e,t)=>{let s=await fetch(e,t);return(401===s.status||403===s.status)&&await V()?await fetch(e,t):s},[V]),W=e=>{F.current&&(clearInterval(F.current),F.current=null);let a=0,r=async(e,t)=>{let s=e.headers.get("content-type")||"",a=await e.text().catch(()=>"");try{return{ok:e.ok,status:e.status,contentType:s,data:a?JSON.parse(a):null,rawText:a}}catch(r){throw console.error("[batch-generation/poll] Invalid JSON response:",{url:t,status:e.status,ok:e.ok,contentType:s,preview:a.slice(0,500),error:r instanceof Error?r.message:String(r)}),Error("Invalid JSON from ".concat(t," (status ").concat(e.status,")"))}};F.current=setInterval(async()=>{if(!M.current){F.current&&(clearInterval(F.current),F.current=null);return}try{let n="/api/admin/batch-generation/status/".concat(e),i=await U(n,{headers:{"X-Requested-With":"XMLHttpRequest"}}),l=(await r(i,n)).data;if(!M.current)return;if(!i.ok){401===i.status||403===i.status?t("error","管理员会话已过期且无法自动续期，请重新登录。"):console.error("获取任务状态失败:",(null==l?void 0:l.error)||l),F.current&&(clearInterval(F.current),F.current=null);return}let o=l.task;if(a=0,!M.current)return;if(D(o.updated_at||null),void 0!==o.current_industry_index&&o.total_industries&&(C(o.current_industry_index),k(e=>{if(!M.current)return e;if(!o.industries||!Array.isArray(o.industries))return console.warn("[batch-generation/poll] task.industries 无效，跳过更新"),e;let t=o.industries,s=o.scenes_per_industry||100,a=o.current_industry_index;if(0===e.length||e.length!==t.length)return t.map((e,t)=>{let r;let n=t<a,i=t===a;return n?r=s:i&&void 0!==o.total_scenes_saved&&(r=Math.min(s,Math.max(0,o.total_scenes_saved-a*s))),{id:"".concat(t),industry:e,status:n?"completed":i?"processing":"pending",savedCount:r}});if(e.some((e,s)=>e.industry!==t[s]))return t.map((e,t)=>{let r;let n=t<a,i=t===a;return n?r=s:i&&void 0!==o.total_scenes_saved&&(r=Math.min(s,Math.max(0,o.total_scenes_saved-a*s))),{id:"".concat(t),industry:e,status:n?"completed":i?"processing":"pending",savedCount:r}});let r=e.map((e,t)=>{if(t<a)return{...e,status:"completed",savedCount:s};if(t===a){let t=void 0!==o.total_scenes_saved?Math.min(s,Math.max(0,o.total_scenes_saved-a*s)):void 0,r=void 0!==o.total_scenes_generated?Math.min(s,Math.max(0,o.total_scenes_generated-a*s)):void 0,n=void 0!==r&&void 0!==t&&r>t,i=void 0!==t&&t>=s;return e.status!==(i?"completed":"processing")||e.savedCount!==t||e.generatedCount!==r||e.isSaving!==n?{...e,status:i?"completed":"processing",savedCount:t,generatedCount:r,isSaving:n}:e}return"pending"===e.status&&void 0===e.savedCount?e:{...e,status:"pending",savedCount:void 0}});return r.some((t,s)=>{let a=e[s];return!a||a.status!==t.status||a.savedCount!==t.savedCount||a.generatedCount!==t.generatedCount||a.isSaving!==t.isSaving})?r:e})),["completed","failed","cancelled"].includes(o.status)&&(F.current&&(clearInterval(F.current),F.current=null),M.current&&N(!1),M.current&&("completed"===o.status?(k(e=>e.map(e=>({...e,status:"completed"}))),t("success","任务完成！共生成 ".concat(o.total_scenes_saved||0," 条场景词")),s()):"failed"===o.status?t("error","任务失败: ".concat(o.error_message||"未知错误")):"cancelled"===o.status&&t("info","任务已取消")),localStorage.removeItem("lastBatchTaskId")),M.current&&("paused"===o.status?(I(!0),L.current=!0):"processing"===o.status&&(I(!1),L.current=!1)),M.current&&A&&!B.current){let s=o.updated_at?new Date(o.updated_at).getTime():0,a=s?(Date.now()-s)/6e4:1/0;["processing","pending","paused"].includes(o.status)&&a>=10&&(B.current=!0,fetch("/api/admin/batch-generation/recover",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e,force:!0})}).then(async e=>({ok:e.ok,data:await e.json().catch(()=>({}))})).then(e=>{let{ok:s,data:a}=e;M.current&&(s?t("info","检测到任务长时间未更新，已自动触发恢复"):t("error",(null==a?void 0:a.error)||"自动恢复失败"))}).catch(e=>{console.error("[auto-recover] failed:",e)}).finally(()=>{setTimeout(()=>{B.current=!1},15e3)}))}}catch(r){a++;let s=r instanceof Error?r.message:String(r);if(s.includes("Maximum call stack size exceeded")||s.includes("stack overflow")||s.includes("too much recursion")){console.error("\uD83D\uDEA8 检测到栈溢出错误！停止轮询以防止无限循环:",{error:s,taskId:e,consecutiveErrors:a,stack:r instanceof Error?r.stack:void 0}),F.current&&(clearInterval(F.current),F.current=null),t("error","检测到递归调用错误，已停止自动轮询。请刷新页面后重试。"),localStorage.removeItem("lastBatchTaskId");return}console.error("轮询任务状态失败:",{error:s,taskId:e,consecutiveErrors:a}),a>=5&&(F.current&&(clearInterval(F.current),F.current=null),t("error","任务状态轮询连续失败（可能网络/服务异常）。已停止自动轮询，请稍后刷新页面继续。"))}},2e3)};(0,r.useEffect)(()=>(M.current=!0,()=>{M.current=!1,F.current&&(clearInterval(F.current),F.current=null)}),[]),(0,r.useEffect)(()=>{let e=!1,s=async()=>{let s=localStorage.getItem("lastBatchTaskId");console.log("[恢复任务] 检查 localStorage:",s);let a=null;if(s)try{console.log("[恢复任务] 从 localStorage 获取任务状态:",s);let t="/api/admin/batch-generation/status/".concat(s),r=await U(t,{headers:{"X-Requested-With":"XMLHttpRequest"}}),n=r.headers.get("content-type")||"",i=await r.text().catch(()=>""),l=null;try{l=i?JSON.parse(i):null}catch(e){console.error("[恢复任务] Invalid JSON response:",{url:t,status:r.status,ok:r.ok,contentType:n,preview:i.slice(0,300),error:e instanceof Error?e.message:String(e)})}let o=l&&"object"==typeof l?l.task:null,d=o&&"object"==typeof o&&!Array.isArray(o)?o:null,c=d&&"string"==typeof d.status?d.status:null;r.ok&&d&&c&&["pending","processing","paused"].includes(c)?(a={...d,id:s},console.log("[恢复任务] 从 localStorage 找到任务:",a.id)):404===r.status?(console.log("[恢复任务] localStorage 中的任务不存在，清除"),localStorage.removeItem("lastBatchTaskId"),e||(N(!1),I(!1),k([]))):r.ok||(console.log("[恢复任务] 获取任务状态失败，重置状态"),localStorage.removeItem("lastBatchTaskId"),e||(N(!1),I(!1),k([])))}catch(t){console.error("[恢复任务] 从 localStorage 恢复失败:",t),localStorage.removeItem("lastBatchTaskId"),e||(N(!1),I(!1),k([]))}if(!a)try{console.log("[恢复任务] 从数据库查询最近的任务");let t=await fetch("/api/admin/batch-generation/latest"),s=await t.json();t.ok&&s.task&&["pending","processing","paused"].includes(s.task.status)?(a=s.task,console.log("[恢复任务] 从数据库找到任务:",a.id),localStorage.setItem("lastBatchTaskId",a.id)):(console.log("[恢复任务] 数据库中没有正在运行的任务"),e||(N(!1),I(!1),k([])))}catch(t){console.error("[恢复任务] 从数据库查询失败:",t),e||(N(!1),I(!1),k([]))}if(a&&!e){let s=a;if(console.log("[恢复任务] 开始恢复任务:",s.id,"状态:",s.status),e)return;if(T(s.id),D(s.updated_at||null),N(!0),C(s.current_industry_index||0),s.industries&&Array.isArray(s.industries)){h(s.industries),x(s.scenes_per_industry||100),f(s.use_case_type||"advertising-promotion");let t=s.industries.map((e,t)=>{let a=t<(s.current_industry_index||0),r=t===(s.current_industry_index||0);return{id:"".concat(t),industry:e,status:a?"completed":r?"processing":"pending",savedCount:a?s.scenes_per_industry||100:void 0}});e||(k(t),console.log("[恢复任务] 已恢复任务列表，共",t.length,"个行业"))}if(e)return;"paused"===s.status?(I(!0),L.current=!0):(I(!1),L.current=!1),e||(W(s.id),t("info","检测到正在运行的任务，已恢复监控 (".concat(s.current_industry_index||0,"/").concat(s.total_industries||0,")")))}else e||(console.log("[恢复任务] 没有找到需要恢复的任务"),N(!1),I(!1),k([]),O.current=!1,L.current=!1)},a=setTimeout(()=>{s()},500);return()=>{e=!0,clearTimeout(a)}},[]);let Y=async()=>{let e=localStorage.getItem("lastBatchTaskId");if(!e){t("error","未找到任务 ID");return}try{let s=S?"resume":"pause",a=await fetch("/api/admin/batch-generation/control",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e,action:s})}),r=await a.json();if(!a.ok)throw Error(r.error||"操作失败");I(!S),L.current=!L.current,t("success",r.message||("pause"===s?"任务已暂停":"任务已恢复"))}catch(e){console.error("操作任务失败:",e),t("error",e instanceof Error?e.message:"操作失败")}},J=async()=>{let e=localStorage.getItem("lastBatchTaskId");if(!e){t("error","未找到任务 ID");return}try{let s=await fetch("/api/admin/batch-generation/control",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e,action:"cancel"})}),a=await s.json();if(!s.ok)throw Error(a.error||"操作失败");N(!1),O.current=!0,localStorage.removeItem("lastBatchTaskId"),k([]),C(-1),t("success",a.message||"任务已终止")}catch(e){console.error("终止任务失败:",e),t("error",e instanceof Error?e.message:"终止失败")}},G=async()=>{let e=E||localStorage.getItem("lastBatchTaskId");if(!e){t("error","未找到任务 ID");return}try{let s=await fetch("/api/admin/batch-generation/recover",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e,force:!0})}),a=await s.json().catch(()=>({}));if(!s.ok)throw Error((null==a?void 0:a.error)||"恢复失败");t("info","已触发恢复：后台将继续处理队列/下一个行业")}catch(e){console.error("恢复任务失败:",e),t("error",e instanceof Error?e.message:"恢复失败")}},$=(()=>{let e=g.length*p,t=g.length,s=26*t;return{totalScenes:e,apiCalls:t,totalCredits:s,cost:8e-5*s}})();return(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"行业场景词批量生成（10,000 条内容计划）"})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"每个行业生成数量"}),(0,a.jsx)(i.II,{type:"number",min:"10",max:"200",value:p,onChange:e=>x(Math.min(200,Math.max(10,parseInt(e.target.value)||100))),disabled:w}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"建议：100 条/行业"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"使用场景类型"}),(0,a.jsxs)("select",{className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800",value:y,onChange:e=>f(e.target.value),disabled:w,children:[(0,a.jsx)("option",{value:"advertising-promotion",children:"Advertising & Promotion"}),(0,a.jsx)("option",{value:"social-media-content",children:"Social Media Content"}),(0,a.jsx)("option",{value:"product-demo-showcase",children:"Product Demo & Showcase"}),(0,a.jsx)("option",{value:"brand-storytelling",children:"Brand Storytelling"}),(0,a.jsx)("option",{value:"education-explainer",children:"Education & Explainer"}),(0,a.jsx)("option",{value:"ugc-creator-content",children:"UGC & Creator Content"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"GEO地区"}),(0,a.jsxs)("select",{className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm dark:border-gray-600 dark:bg-gray-800",value:b,onChange:e=>v(e.target.value),disabled:w,children:[(0,a.jsx)("option",{value:"US",children:"\uD83C\uDDFA\uD83C\uDDF8 United States"}),(0,a.jsx)("option",{value:"CN",children:"\uD83C\uDDE8\uD83C\uDDF3 China"}),(0,a.jsx)("option",{value:"GB",children:"\uD83C\uDDEC\uD83C\uDDE7 United Kingdom"}),(0,a.jsx)("option",{value:"CA",children:"\uD83C\uDDE8\uD83C\uDDE6 Canada"}),(0,a.jsx)("option",{value:"AU",children:"\uD83C\uDDE6\uD83C\uDDFA Australia"}),(0,a.jsx)("option",{value:"JP",children:"\uD83C\uDDEF\uD83C\uDDF5 Japan"}),(0,a.jsx)("option",{value:"DE",children:"\uD83C\uDDE9\uD83C\uDDEA Germany"}),(0,a.jsx)("option",{value:"FR",children:"\uD83C\uDDEB\uD83C\uDDF7 France"}),(0,a.jsx)("option",{value:"IN",children:"\uD83C\uDDEE\uD83C\uDDF3 India"}),(0,a.jsx)("option",{value:"BR",children:"\uD83C\uDDE7\uD83C\uDDF7 Brazil"})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"用于模型选择策略"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"快速选择"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{h([...u])},disabled:w,className:"rounded border border-blue-500 bg-blue-500 px-3 py-1.5 text-xs font-medium text-white hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",children:"✓ 全选"}),(0,a.jsx)("button",{type:"button",onClick:()=>{h([])},disabled:w,className:"rounded border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",children:"✗ 全不选"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(u.slice(0,10).map(e=>e)),disabled:w,className:"rounded border border-gray-300 bg-white px-2 py-1 text-xs hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800",children:"前 10 个"}),(0,a.jsx)("button",{type:"button",onClick:()=>h(u.slice(0,50).map(e=>e)),disabled:w,className:"rounded border border-gray-300 bg-white px-2 py-1 text-xs hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800",children:"前 50 个"}),(0,a.jsxs)("button",{type:"button",onClick:()=>h(m),disabled:w,className:"rounded border border-purple-500 bg-purple-500 px-3 py-1.5 text-xs font-medium text-white hover:bg-purple-600 dark:bg-purple-600 dark:hover:bg-purple-700",title:"选择S/A+/A级优先行业（推荐）",children:["⭐ 优先行业 (",m.length,")"]})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg bg-green-50 p-4 dark:bg-green-900/20",children:[(0,a.jsx)("div",{className:"font-medium text-green-800 dark:text-green-200",children:"\uD83D\uDCB0 成本估算"}),(0,a.jsxs)("div",{className:"mt-2 space-y-1 text-sm text-green-700 dark:text-green-300",children:[(0,a.jsxs)("div",{children:["选择行业：",g.length," 个"]}),(0,a.jsxs)("div",{children:["总场景词数：",$.totalScenes," 条"]}),(0,a.jsxs)("div",{children:["API 调用次数：",$.apiCalls," 次"]}),(0,a.jsxs)("div",{children:["预计消耗：",$.totalCredits," 积分"]}),(0,a.jsxs)("div",{className:"font-semibold",children:["预计成本：\xa5",$.cost.toFixed(4)," 元"]}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400",children:["\uD83D\uDCA1 提示：每个行业一次 API 调用生成 ",p," 条场景词，成本极低"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-700 dark:bg-gray-800/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"模式切换："}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>o("marketing"),disabled:w,className:"rounded-lg border px-4 py-1.5 text-sm font-medium transition ".concat("marketing"===l?"border-energy-water bg-energy-water text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),children:["\uD83C\uDFAF 营销场景 (",ea.length,")"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>o("traditional"),disabled:w,className:"rounded-lg border px-4 py-1.5 text-sm font-medium transition ".concat("traditional"===l?"border-energy-water bg-energy-water text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),children:["\uD83D\uDCCA 传统行业 (",er.length,")"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"视图切换："}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>c("grid"),disabled:w,className:"rounded-lg border px-4 py-1.5 text-sm font-medium transition ".concat("grid"===d?"border-energy-water bg-energy-water text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),children:"⊞ 网格"}),(0,a.jsx)("button",{type:"button",onClick:()=>c("list"),disabled:w,className:"rounded-lg border px-4 py-1.5 text-sm font-medium transition ".concat("list"===d?"border-energy-water bg-energy-water text-white":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),children:"☰ 列表"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["选择行业（已选择 ",g.length," / ",u.length,"）"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>h([...u]),disabled:w,className:"rounded border border-blue-500 bg-blue-500 px-3 py-1 text-xs font-medium text-white hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700",children:"✓ 全选"}),(0,a.jsx)("button",{type:"button",onClick:()=>h([]),disabled:w,className:"rounded border border-gray-300 bg-white px-3 py-1 text-xs font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",children:"✗ 全不选"})]})]}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200 p-3 dark:border-gray-700",children:"grid"===d?(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map(e=>{let t=eo(e),s=ed(e),r=ec(e);return(0,a.jsx)("button",{type:"button",onClick:()=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},disabled:w,className:"group relative rounded-lg border px-3 py-1.5 text-sm transition ".concat(g.includes(e)?"border-energy-water bg-energy-water text-white":r?"border-purple-300 bg-purple-50 text-gray-800 hover:bg-purple-100 dark:border-purple-700 dark:bg-purple-900/20 dark:text-gray-200 dark:hover:bg-purple-900/30":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),title:r?"推荐行业（S/A+/A级）":void 0,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e}),t&&(0,a.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs font-medium ".concat(t.color," ").concat(t.bgColor),children:t.label}),s&&(0,a.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs font-medium ".concat(s.color," ").concat(s.bgColor),title:s.label,children:s.icon})]})},e)})}):(0,a.jsx)("div",{className:"space-y-1",children:u.map(e=>{let t=eo(e),s=ed(e),r=ec(e);return(0,a.jsxs)("button",{type:"button",onClick:()=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},disabled:w,className:"flex w-full items-center justify-between rounded-lg border px-3 py-2 text-sm transition ".concat(g.includes(e)?"border-energy-water bg-energy-water text-white":r?"border-purple-300 bg-purple-50 text-gray-800 hover:bg-purple-100 dark:border-purple-700 dark:bg-purple-900/20 dark:text-gray-200 dark:hover:bg-purple-900/30":"border-gray-300 bg-white text-gray-700 hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200"),title:r?"推荐行业（S/A+/A级）":void 0,children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:e}),t&&(0,a.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs font-medium ".concat(t.color," ").concat(t.bgColor),children:t.label}),s&&(0,a.jsx)("span",{className:"rounded px-1.5 py-0.5 text-xs font-medium ".concat(s.color," ").concat(s.bgColor),title:s.label,children:s.icon})]}),g.includes(e)&&(0,a.jsx)("span",{className:"ml-2 text-xs",children:"✓"})]},e)})})})]}),(0,a.jsx)("div",{className:"flex items-center gap-4",children:w?(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:Y,variant:S?"secondary":"outline",className:S?"bg-yellow-500 hover:bg-yellow-600 text-white":"",children:S?"▶️ 恢复生成":"⏸️ 暂停生成"}),(0,a.jsx)(i.zx,{onClick:G,variant:"outline",children:"\uD83D\uDD27 恢复卡住"}),(0,a.jsx)(i.zx,{onClick:J,variant:"danger",children:"⏹️ 终止生成"})]}):(0,a.jsxs)(i.zx,{onClick:q,disabled:0===g.length,className:"bg-energy-water hover:bg-energy-water/90",children:["开始批量生成 (",g.length," 个行业 \xd7 ",p," 条 = ",$.totalScenes," 条)"]})}),w&&(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-300",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:A,onChange:e=>z(e.target.checked)}),"自动恢复卡住（10分钟无更新）"]}),(0,a.jsxs)("div",{children:["最后更新：",P?"".concat(Math.max(0,Math.round((Date.now()-new Date(P).getTime())/6e4))," 分钟前"):"未知"]})]}),j.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["生成进度 (已完成行业数 / 总行业数)：",j.filter(e=>"completed"===e.status).length," / ",j.length]}),(0,a.jsx)("div",{className:"max-h-64 space-y-2 overflow-y-auto",children:j.map((e,t)=>(0,a.jsx)("div",{className:"rounded-lg border p-3 ".concat("saved"===e.status?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"processing"===e.status?"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-900/20":"failed"===e.status?"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20":"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white",children:[t+1,". ",e.industry]}),(0,a.jsxs)("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:["processing"===e.status&&(e.isSaving&&void 0!==e.generatedCount?"已生成 ".concat(e.generatedCount," 条场景词，正在保存... (已保存 ").concat(e.savedCount||0," 条)"):void 0!==e.savedCount&&e.savedCount>0?"正在生成场景词... (已保存 ".concat(e.savedCount," 条)"):"正在生成场景词..."),"completed"===e.status&&void 0!==e.savedCount&&e.savedCount>0&&"✅ 已完成，已保存 ".concat(e.savedCount," 条场景词"),"completed"===e.status&&(void 0===e.savedCount||0===e.savedCount)&&"⚠️ 生成返回 0 条场景词，已自动切换到联网搜索模型...","saved"===e.status&&"✅ 已保存 ".concat(e.savedCount||0," 条场景词"),"failed"===e.status&&"❌ 失败: ".concat(e.error),"pending"===e.status&&"等待处理..."]})]}),"processing"===e.status&&t===_&&(0,a.jsx)("div",{className:"ml-4 h-4 w-4 animate-spin rounded-full border-2 border-energy-water border-t-transparent"})]})},e.id))})]})]})]})}let em={slug:"",title:"",h1:"",description:"",content:"",use_case_type:"advertising-promotion",industry:"",featured_prompt_ids:"",related_use_case_ids:"",seo_keywords:"",isPublished:!0},eg=[{value:"advertising-promotion",label:"Advertising & Promotion"},{value:"social-media-content",label:"Social Media Content"},{value:"product-demo-showcase",label:"Product Demo & Showcase"},{value:"brand-storytelling",label:"Brand Storytelling"},{value:"education-explainer",label:"Education & Explainer"},{value:"ugc-creator-content",label:"UGC & Creator Content"}],eh={published:{label:"已发布",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},draft:{label:"草稿",className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}};function ep(e){if(!e||"object"!=typeof e)return null;let t="string"==typeof e.id?e.id:null,s="string"==typeof e.slug?e.slug:"",a="string"==typeof e.title?e.title:"",r="string"==typeof e.h1?e.h1:"",n="string"==typeof e.description?e.description:"",i="string"==typeof e.content?e.content:"";return t&&s&&a&&r&&n?{id:t,slug:s,title:a,h1:r,description:n,content:i,use_case_type:e.use_case_type||"other",industry:"string"==typeof e.industry?e.industry:null,featured_prompt_ids:Array.isArray(e.featured_prompt_ids)?e.featured_prompt_ids.filter(e=>"string"==typeof e):[],related_use_case_ids:Array.isArray(e.related_use_case_ids)?e.related_use_case_ids.filter(e=>"string"==typeof e):[],seo_keywords:Array.isArray(e.seo_keywords)?e.seo_keywords.filter(e=>"string"==typeof e):[],is_published:"boolean"!=typeof e.is_published||e.is_published,quality_status:"string"==typeof e.quality_status&&["pending","approved","rejected","needs_review"].includes(e.quality_status)?e.quality_status:null,quality_issues:Array.isArray(e.quality_issues)?e.quality_issues.map(String):null,quality_score:"number"==typeof e.quality_score?e.quality_score:null,quality_notes:"string"==typeof e.quality_notes?e.quality_notes:null,reviewed_by_admin_id:"string"==typeof e.reviewed_by_admin_id?e.reviewed_by_admin_id:null,reviewed_at:"string"==typeof e.reviewed_at?e.reviewed_at:null,created_at:"string"==typeof e.created_at?e.created_at:new Date().toISOString(),updated_at:"string"==typeof e.updated_at?e.updated_at:new Date().toISOString()}:null}function ex(e){return{slug:e.slug,title:e.title,h1:e.h1,description:e.description,content:e.content,use_case_type:e.use_case_type,industry:e.industry||"",featured_prompt_ids:e.featured_prompt_ids.join(", "),related_use_case_ids:e.related_use_case_ids.join(", "),seo_keywords:e.seo_keywords.join(", "),isPublished:e.is_published}}function ey(e){return e.split(",").map(e=>e.trim()).filter(e=>e.length>0)}function ef(e){let{onShowBanner:t}=e,s=(0,n.useSearchParams)(),l=(0,r.useRef)(!0),[o,d]=(0,r.useState)([]),[c,u]=(0,r.useState)(!0),[m,g]=(0,r.useState)(null);(0,r.useEffect)(()=>(l.current=!0,()=>{l.current=!1}),[]);let p=(0,r.useMemo)(()=>Array.from(new Set([...ea,...er])).sort(),[]),[b,v]=(0,r.useState)(""),[j,k]=(0,r.useState)("all"),[w,N]=(0,r.useState)("all"),[_,C]=(0,r.useState)("all"),[S,I]=(0,r.useState)("all"),[E,T]=(0,r.useState)("industry"),[P,D]=(0,r.useState)(new Set),[A,z]=(0,r.useState)(1),[O,L]=(0,r.useState)(50),[R,B]=(0,r.useState)(0),M=(null==s?void 0:s.get("edit"))||null,[F,H]=(0,r.useState)(em),[q,V]=(0,r.useState)(!1),[U,W]=(0,r.useState)(""),[Y,J]=(0,r.useState)(!1),[G,Z]=(0,r.useState)(null),[K,Q]=(0,r.useState)(em),[X,ee]=(0,r.useState)(!1),[et,es]=(0,r.useState)(null),en=(0,r.useCallback)(async()=>{if(l.current){u(!0),g(null);try{let e=new URLSearchParams;"all"!==j&&e.append("type",j),"all"!==w&&""!==w&&e.append("industry",w),"all"!==_&&e.append("status",_),"all"!==S&&e.append("quality_status",S),b.trim()&&e.append("search",b.trim());let t=(A-1)*O;e.append("limit",O.toString()),e.append("offset",t.toString());let s=await fetch("/api/admin/use-cases?".concat(e.toString())),a=await s.json().catch(()=>({}));if(!l.current)return;if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join("：")||"获取使用场景列表失败";throw Error(t)}let r=(Array.isArray(a.useCases)?a.useCases:[]).map(e=>ep(e)).filter(e=>!!e);if(!l.current)return;d(r),B("number"==typeof a.totalCount?a.totalCount:r.length)}catch(e){if(!l.current)return;console.error("获取使用场景列表失败:",e),g(e instanceof Error?e.message:"获取使用场景列表失败"),d([]),B(0)}finally{l.current&&u(!1)}}},[b,j,w,_,S,A,O]);(0,r.useEffect)(()=>{console.log("开始获取使用场景列表..."),en()},[en]),(0,r.useEffect)(()=>{z(1)},[b,j,w,_,S]),(0,r.useEffect)(()=>{if(M&&o.length>0&&!G){let e=o.find(e=>e.id===M);e&&(ec(e),setTimeout(()=>{let e=document.getElementById("edit-form-".concat(M));null==e||e.scrollIntoView({behavior:"smooth",block:"center"})},300))}},[M,o]);let ei=(0,r.useCallback)(async e=>{if(e.trim()){J(!0);try{let s=function(e){let t={},s=y(e,["slug","URL别名","url alias","URL","url","别名","alias","路径","path"]);s&&(t.slug=s.toLowerCase().replace(/[^a-z0-9-]/g,"-"));let a=y(e,["title","标题","Title","页面标题","page title"]);a&&(t.title=a);let r=y(e,["h1","H1","H1标题","h1 title","主标题","main heading"]);r&&(t.h1=r);let n=y(e,["description","描述","Description","元描述","meta description","摘要","summary","简介","introduction"]);n&&(t.description=n);let i=y(e,["content","内容","Content","正文","body","场景内容","use case content"]);if(!i){let t=e.match(/(?:content|内容|正文|body)[：:]\s*([\s\S]+?)(?=\n\s*(?:use_case_type|featured|related|seo|$))/i);t&&t[1]&&(i=x(t[1]))}i&&(t.content=i);let l=y(e,["use_case_type","use case type","类型","Type","场景类型","scenario type"]);if(l){let e=l.toLowerCase().replace(/[^a-z-]/g,""),s=$.find(t=>e.includes(t)||"advertising-promotion"===t&&(e.includes("advertising")||e.includes("ads")||e.includes("promotion"))||"social-media-content"===t&&(e.includes("social")||e.includes("media")||e.includes("youtube")||e.includes("tiktok")||e.includes("instagram")||e.includes("twitter")||e.includes("x"))||"product-demo-showcase"===t&&(e.includes("product")||e.includes("demo")||e.includes("showcase"))||"brand-storytelling"===t&&(e.includes("brand")||e.includes("storytelling"))||"education-explainer"===t&&(e.includes("education")||e.includes("explainer")||e.includes("tutorial"))||"ugc-creator-content"===t&&(e.includes("ugc")||e.includes("creator")||e.includes("user-generated")));s?t.use_case_type=s:t.use_case_type=$[0]}t.featured_prompt_ids=f(e,["featured_prompt_ids","featured prompts","推荐提示词","featured prompt ids"]),t.related_use_case_ids=f(e,["related_use_case_ids","related use cases","相关场景","related use case ids"]),t.seo_keywords=f(e,["seo_keywords","seo keywords","SEO关键词","keywords","关键词","tags","标签"]);let o=y(e,["is_published","isPublished","published","发布状态","publish status","status"]);if(o){let e=o.toLowerCase();t.isPublished=e.includes("true")||e.includes("是")||e.includes("yes")||e.includes("published")}return t}(e);H(e=>{let t={...e};return s.slug&&(t.slug=s.slug),s.title&&(t.title=s.title),s.h1&&(t.h1=s.h1),s.description&&(t.description=s.description),s.content&&(t.content=s.content),s.use_case_type&&(t.use_case_type=s.use_case_type),s.featured_prompt_ids&&s.featured_prompt_ids.length>0&&(t.featured_prompt_ids=s.featured_prompt_ids.join(", ")),s.related_use_case_ids&&s.related_use_case_ids.length>0&&(t.related_use_case_ids=s.related_use_case_ids.join(", ")),s.seo_keywords&&s.seo_keywords.length>0&&(t.seo_keywords=s.seo_keywords.join(", ")),void 0!==s.isPublished&&(t.isPublished=s.isPublished),t});let a=Object.keys(s).filter(e=>{let t=s[e];return Array.isArray(t)?t.length>0:null!=t&&""!==t}).length;t("success","成功识别并填充了 ".concat(a," 个字段"))}catch(e){console.error("Text recognition failed:",e),t("error",e instanceof Error?e.message:"文本识别失败")}finally{J(!1)}}},[t]),el=Math.ceil(R/O),eo=(0,r.useMemo)(()=>{if("none"===E)return[{key:"all",label:"All",items:o}];let e=new Map;for(let t of o){let s="";s="type"===E?t.use_case_type||"other":"industry"===E?t.industry||"Uncategorized":t.quality_status||"null",e.set(s,[...e.get(s)||[],t])}let t=e=>{if("type"===E){var t;return(null===(t=eg.find(t=>t.value===e))||void 0===t?void 0:t.label)||e}return"industry"===E?e:"approved"===e?"✅ 已批准":"pending"===e?"⏳ 待审核":"needs_review"===e?"\uD83D\uDD0D 需要审核":"rejected"===e?"❌ 已拒绝":"未检查"};return[...e.entries()].sort((e,t)=>t[1].length-e[1].length).map(e=>{let[s,a]=e;return{key:s,label:t(s),items:a}})},[E,o]),ed=async e=>{if(e.preventDefault(),!F.slug.trim()){t("error","请输入slug");return}if(!F.title.trim()){t("error","请输入标题");return}if(!F.h1.trim()){t("error","请输入H1标题");return}if(!F.content.trim()){t("error","请输入内容");return}V(!0);try{let e=await fetch("/api/admin/use-cases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:F.slug.trim(),title:F.title.trim(),h1:F.h1.trim(),description:F.description.trim(),content:F.content.trim(),use_case_type:F.use_case_type,industry:F.industry.trim()||null,featured_prompt_ids:ey(F.featured_prompt_ids),related_use_case_ids:ey(F.related_use_case_ids),seo_keywords:ey(F.seo_keywords),is_published:F.isPublished})}),s=await e.json().catch(()=>({}));if(!e.ok){let e=[];"string"==typeof s.error&&s.error.trim().length>0&&e.push(s.error.trim()),"string"==typeof s.details&&s.details.trim().length>0&&e.push(s.details.trim());let t=e.join("：")||"创建使用场景失败";throw Error(t)}t("success","使用场景创建成功"),H(em),await en()}catch(e){console.error("创建使用场景失败:",e),t("error",e instanceof Error?e.message:"创建使用场景失败")}finally{V(!1)}},ec=async e=>{if(Z(e.id),!e.content||""===e.content.trim())try{let t=await fetch("/api/admin/use-cases/".concat(e.id)),s=await t.json();if(t.ok&&s.useCase){let e=ep(s.useCase);if(e){Q(ex(e));return}}}catch(e){console.error("获取完整使用场景数据失败:",e)}Q(ex(e))},ef=()=>{Z(null),Q(em)},eb=async e=>{if(!K.slug.trim()||!K.title.trim()||!K.h1.trim()||!K.content.trim()){t("error","请填写所有必需字段");return}ee(!0);try{let s=await fetch("/api/admin/use-cases/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:K.slug.trim(),title:K.title.trim(),h1:K.h1.trim(),description:K.description.trim(),content:K.content.trim(),use_case_type:K.use_case_type,industry:K.industry.trim()||null,featured_prompt_ids:ey(K.featured_prompt_ids),related_use_case_ids:ey(K.related_use_case_ids),seo_keywords:ey(K.seo_keywords),is_published:K.isPublished})}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join("：")||"更新使用场景失败";throw Error(t)}t("success","使用场景更新成功"),Z(null),await en()}catch(e){console.error("更新使用场景失败:",e),t("error",e instanceof Error?e.message:"更新使用场景失败")}finally{ee(!1)}},ev=async(e,s)=>{let a=s?"下架":"上架";if(confirm("确定要".concat(a,"这个使用场景吗？")))try{let r=await fetch("/api/admin/use-cases/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({is_published:!s})}),n=await r.json().catch(()=>({}));if(!r.ok){let e=[];"string"==typeof n.error&&n.error.trim().length>0&&e.push(n.error.trim()),"string"==typeof n.details&&n.details.trim().length>0&&e.push(n.details.trim());let t=e.join("：")||"".concat(a,"使用场景失败");throw Error(t)}t("success","使用场景已".concat(a)),await en()}catch(e){console.error("".concat(a,"使用场景失败:"),e),t("error",e instanceof Error?e.message:"".concat(a,"使用场景失败"))}},ej=async e=>{if(confirm("确定要删除这个使用场景吗？此操作无法撤销。")){es(e);try{let s=await fetch("/api/admin/use-cases/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join("：")||"删除使用场景失败";throw Error(t)}t("success","使用场景已删除"),await en()}catch(e){console.error("删除使用场景失败:",e),t("error",e instanceof Error?e.message:"删除使用场景失败")}finally{es(null)}}};return(0,r.useEffect)(()=>{console.log("AdminUseCasesManager 组件已加载")},[]),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(eu,{onShowBanner:t,onGenerated:en,onFilterChange:(e,t)=>{console.log("批量生成完成，自动应用筛选条件:",{type:e,industry:t}),k(e),t&&N(t),setTimeout(()=>{en()},200)}}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(i.ll,{children:"使用场景管理"}),(0,a.jsx)(i.zx,{onClick:async()=>{try{let e=await fetch("/api/admin/use-cases/export-csv");if(!e.ok)throw Error("导出失败");let s=await e.blob(),a=window.URL.createObjectURL(s),r=document.createElement("a");if(r.href=a,r.download="use-cases-export-".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(a),r.parentNode)try{r.parentNode.contains(r)?r.parentNode.removeChild(r):r.remove&&"function"==typeof r.remove&&r.remove()}catch(e){try{r.remove&&"function"==typeof r.remove&&r.remove()}catch(e){console.debug("元素移除失败（可安全忽略）:",e)}}t("success","CSV 导出成功")}catch(e){console.error("导出失败:",e),t("error","导出失败，请重试")}},variant:"outline",className:"text-sm",children:"\uD83D\uDCE5 导出 CSV"})]})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-6",children:[(0,a.jsx)(i.II,{placeholder:"搜索 slug、标题、描述...",value:b,onChange:e=>v(e.target.value)}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:j,onChange:e=>k(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"所有类型"}),eg.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:w,onChange:e=>N(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"所有行业"}),(0,a.jsx)("option",{value:"",children:"不限制行业"}),p.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:_,onChange:e=>C(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"所有状态"}),(0,a.jsx)("option",{value:"published",children:"已发布"}),(0,a.jsx)("option",{value:"draft",children:"草稿"})]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:S,onChange:e=>I(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"所有质量状态"}),(0,a.jsx)("option",{value:"null",children:"未检查"}),(0,a.jsx)("option",{value:"pending",children:"待审核"}),(0,a.jsx)("option",{value:"approved",children:"已批准"}),(0,a.jsx)("option",{value:"rejected",children:"已拒绝"}),(0,a.jsx)("option",{value:"needs_review",children:"需要审核"})]}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:E,onChange:e=>T(e.target.value),title:"按分类分组展示",children:[(0,a.jsx)("option",{value:"industry",children:"按行业分组"}),(0,a.jsx)("option",{value:"type",children:"按类型分组"}),(0,a.jsx)("option",{value:"quality_status",children:"按质量状态分组"}),(0,a.jsx)("option",{value:"none",children:"不分组"})]})]}),P.size>0&&(0,a.jsxs)("div",{className:"flex items-center gap-4 rounded-lg border border-energy-water bg-energy-water/10 p-4",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["已选择 ",P.size," 项"]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsx)(i.zx,{size:"sm",onClick:async()=>{try{let e=await fetch("/api/admin/use-cases/batch-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(P),action:"publish"})}),s=await e.json();e.ok?(t("success",s.message||"批量上架成功"),D(new Set),en()):t("error",s.error||"批量上架失败")}catch(e){console.error("批量上架失败:",e),t("error","批量上架失败")}},className:"bg-blue-600 hover:bg-blue-700 text-white",children:"\uD83D\uDCE4 批量上架"}),(0,a.jsx)(i.zx,{size:"sm",onClick:async()=>{try{let e=await fetch("/api/admin/use-cases/batch-publish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(P),action:"unpublish"})}),s=await e.json();e.ok?(t("success",s.message||"批量下架成功"),D(new Set),en()):t("error",s.error||"批量下架失败")}catch(e){console.error("批量下架失败:",e),t("error","批量下架失败")}},className:"bg-gray-600 hover:bg-gray-700 text-white",children:"\uD83D\uDCE5 批量下架"}),(0,a.jsx)(i.zx,{size:"sm",onClick:async()=>{try{let e=await fetch("/api/admin/use-cases/batch-review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(P),action:"approve"})}),s=await e.json();e.ok?(t("success",s.message||"批量批准成功"),D(new Set),en()):t("error",s.error||"批量批准失败")}catch(e){console.error("批量批准失败:",e),t("error","批量批准失败")}},className:"bg-green-600 hover:bg-green-700 text-white",children:"✅ 批量批准"}),(0,a.jsx)(i.zx,{size:"sm",onClick:async()=>{try{let e=await fetch("/api/admin/use-cases/batch-review",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:Array.from(P),action:"reject"})}),s=await e.json();e.ok?(t("success",s.message||"批量拒绝成功"),D(new Set),en()):t("error",s.error||"批量拒绝失败")}catch(e){console.error("批量拒绝失败:",e),t("error","批量拒绝失败")}},className:"bg-red-600 hover:bg-red-700 text-white",children:"❌ 批量拒绝"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>D(new Set),children:"取消选择"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"每页显示:"}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm dark:border-gray-700 dark:bg-gray-800",value:O,onChange:e=>{L(Number(e.target.value)),z(1)},children:[(0,a.jsx)("option",{value:"10",children:"10"}),(0,a.jsx)("option",{value:"30",children:"30"}),(0,a.jsx)("option",{value:"50",children:"50"}),(0,a.jsx)("option",{value:"100",children:"100"}),(0,a.jsx)("option",{value:"500",children:"500"}),(0,a.jsx)("option",{value:"1000",children:"1000"})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["共 ",R," 条，第 ",A," / ",el||1," 页"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(1),disabled:1===A||c,children:"首页"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(e=>Math.max(1,e-1)),disabled:1===A||c,children:"上一页"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["第 ",(0,a.jsx)("input",{type:"number",min:"1",max:el||1,value:A,onChange:e=>{z(Math.max(1,Math.min(el||1,Number(e.target.value)||1)))},className:"w-16 rounded border border-gray-300 px-2 py-1 text-center text-sm dark:border-gray-700 dark:bg-gray-800"})," 页"]}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(e=>Math.min(el||1,e+1)),disabled:A>=(el||1)||c,children:"下一页"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(el||1),disabled:A>=(el||1)||c,children:"末页"})]})]}),c?(0,a.jsx)("div",{className:"py-8 text-center text-gray-500",children:"加载中..."}):m?(0,a.jsx)("div",{className:"py-8 text-center text-red-500",children:m}):0===o.length?(0,a.jsx)("div",{className:"py-8 text-center text-gray-500",children:"暂无使用场景"}):(0,a.jsx)("div",{className:"space-y-6",children:eo.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:["none"!==E&&(0,a.jsx)("div",{className:"flex items-center justify-between px-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"text-xs",children:e.items.length})]})}),(0,a.jsx)("div",{className:"space-y-2",children:e.items.map(e=>{let t=G===e.id,s=et===e.id,r=M===e.id;return t?(0,a.jsx)(i.Zb,{id:"edit-form-".concat(e.id),className:"border-blue-300",children:(0,a.jsxs)(i.aY,{className:"space-y-4 p-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(i.II,{placeholder:"Slug",value:K.slug,onChange:e=>Q({...K,slug:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"标题",value:K.title,onChange:e=>Q({...K,title:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"H1",value:K.h1,onChange:e=>Q({...K,h1:e.target.value})}),(0,a.jsx)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:K.use_case_type,onChange:e=>Q({...K,use_case_type:e.target.value}),children:eg.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:K.industry,onChange:e=>Q({...K,industry:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"不限制行业"}),p.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsx)(i.gx,{placeholder:"描述",value:K.description,onChange:e=>Q({...K,description:e.target.value}),rows:2}),(0,a.jsx)(i.gx,{placeholder:"内容 (HTML)",value:K.content,onChange:e=>Q({...K,content:e.target.value}),rows:10}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(i.II,{placeholder:"Featured Prompt IDs (逗号分隔)",value:K.featured_prompt_ids,onChange:e=>Q({...K,featured_prompt_ids:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"Related Use Case IDs (逗号分隔)",value:K.related_use_case_ids,onChange:e=>Q({...K,related_use_case_ids:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"SEO Keywords (逗号分隔)",value:K.seo_keywords,onChange:e=>Q({...K,seo_keywords:e.target.value})})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:K.isPublished,onChange:e=>Q({...K,isPublished:e.target.checked})}),(0,a.jsx)("span",{className:"text-sm",children:"已发布"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:()=>eb(e.id),disabled:X,size:"sm",children:X?"更新中...":"保存"}),(0,a.jsx)(i.zx,{onClick:ef,variant:"secondary",size:"sm",children:"取消"})]})]})},e.id):(0,a.jsx)(i.Zb,{id:"use-case-".concat(e.id),className:r?"border-energy-water bg-energy-water/10 ring-2 ring-energy-water":"",children:(0,a.jsx)(i.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:P.has(e.id),onChange:t=>{let s=new Set(P);t.target.checked?s.add(e.id):s.delete(e.id),D(s)},className:"mt-1 h-4 w-4 rounded border-gray-300 text-energy-water focus:ring-energy-water"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,a.jsx)("a",{href:"/use-cases/".concat(e.slug),target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-gray-900 hover:underline dark:text-white",title:"点击标题打开内容页（新窗口）",children:e.title}),(0,a.jsx)(i.Ct,{className:eh[e.is_published?"published":"draft"].className,children:eh[e.is_published?"published":"draft"].label}),(0,a.jsx)(i.Ct,{variant:"default",children:e.use_case_type}),e.industry&&(0,a.jsx)(i.Ct,{variant:"secondary",className:"text-xs",children:e.industry}),e.quality_status&&(0,a.jsx)(i.Ct,{className:"approved"===e.quality_status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"rejected"===e.quality_status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"pending"===e.quality_status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"approved"===e.quality_status?"✅ 已批准":"rejected"===e.quality_status?"❌ 已拒绝":"pending"===e.quality_status?"⏳ 待审核":"\uD83D\uDD0D 需要审核"}),null!==e.quality_score&&(0,a.jsxs)(i.Ct,{className:e.quality_score>=80?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":e.quality_score>=60?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:["质量: ",e.quality_score]}),e.quality_issues&&e.quality_issues.length>0&&(0,a.jsxs)(i.Ct,{className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",children:["⚠️ ",e.quality_issues.length]})]})})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:()=>ec(e),size:"sm",variant:"secondary",children:"✏️ 编辑"}),(0,a.jsx)(i.zx,{onClick:()=>ev(e.id,e.is_published),size:"sm",className:e.is_published?"bg-gray-600 hover:bg-gray-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white",children:e.is_published?"\uD83D\uDCE5 下架":"\uD83D\uDCE4 上架"}),(0,a.jsx)(i.zx,{onClick:()=>ej(e.id),disabled:s,size:"sm",variant:"danger",children:s?"删除中...":"删除"})]})]})})},e.id)})})]},e.key))}),!c&&!m&&o.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4 pt-4 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"每页显示:"}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm dark:border-gray-700 dark:bg-gray-800",value:O,onChange:e=>{L(Number(e.target.value)),z(1)},children:[(0,a.jsx)("option",{value:"10",children:"10"}),(0,a.jsx)("option",{value:"30",children:"30"}),(0,a.jsx)("option",{value:"50",children:"50"}),(0,a.jsx)("option",{value:"100",children:"100"}),(0,a.jsx)("option",{value:"500",children:"500"}),(0,a.jsx)("option",{value:"1000",children:"1000"})]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["共 ",R," 条，第 ",A," / ",el||1," 页"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(1),disabled:1===A,children:"首页"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(e=>Math.max(1,e-1)),disabled:1===A,children:"上一页"}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["第 ",(0,a.jsx)("input",{type:"number",min:"1",max:el||1,value:A,onChange:e=>{z(Math.max(1,Math.min(el||1,Number(e.target.value)||1)))},className:"w-16 rounded border border-gray-300 px-2 py-1 text-center text-sm dark:border-gray-700 dark:bg-gray-800"})," 页"]}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(e=>Math.min(el||1,e+1)),disabled:A>=(el||1),children:"下一页"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>z(el||1),disabled:A>=(el||1),children:"末页"})]})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"创建新使用场景"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{onSubmit:ed,className:"space-y-4",children:[(0,a.jsx)(h,{textInput:U,onTextInputChange:W,onRecognize:ei,isRecognizing:Y,onShowBanner:t}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(i.II,{placeholder:"Slug *",value:F.slug,onChange:e=>H({...F,slug:e.target.value}),required:!0}),(0,a.jsx)(i.II,{placeholder:"标题 *",value:F.title,onChange:e=>H({...F,title:e.target.value}),required:!0}),(0,a.jsx)(i.II,{placeholder:"H1 *",value:F.h1,onChange:e=>H({...F,h1:e.target.value}),required:!0}),(0,a.jsx)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:F.use_case_type,onChange:e=>H({...F,use_case_type:e.target.value}),children:eg.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:F.industry,onChange:e=>H({...F,industry:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"不限制行业（可选）"}),p.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsx)(i.gx,{placeholder:"描述 *",value:F.description,onChange:e=>H({...F,description:e.target.value}),rows:2,required:!0}),(0,a.jsx)(i.gx,{placeholder:"内容 (HTML) *",value:F.content,onChange:e=>H({...F,content:e.target.value}),rows:10,required:!0}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsx)(i.II,{placeholder:"Featured Prompt IDs (逗号分隔)",value:F.featured_prompt_ids,onChange:e=>H({...F,featured_prompt_ids:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"Related Use Case IDs (逗号分隔)",value:F.related_use_case_ids,onChange:e=>H({...F,related_use_case_ids:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"SEO Keywords (逗号分隔)",value:F.seo_keywords,onChange:e=>H({...F,seo_keywords:e.target.value})})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:F.isPublished,onChange:e=>H({...F,isPublished:e.target.checked})}),(0,a.jsx)("span",{className:"text-sm",children:"已发布"})]})}),(0,a.jsx)(i.zx,{type:"submit",disabled:q,children:q?"创建中...":"创建使用场景"})]})})]})]})}let eb={slug:"",title:"",h1:"",description:"",content:"",tool_a_name:"OpenAI Sora",tool_b_name:"",comparison_points:"[]",winner:"",seo_keywords:"",isPublished:!0},ev={published:{label:"已发布",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},draft:{label:"草稿",className:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}};function ej(e){return e.split(",").map(e=>e.trim()).filter(e=>e.length>0)}function ek(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[d,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(""),[g,p]=(0,r.useState)("all"),[b,v]=(0,r.useState)(eb),[j,k]=(0,r.useState)(!1),[w,N]=(0,r.useState)(""),[_,C]=(0,r.useState)(!1),[S,I]=(0,r.useState)(null),[E,T]=(0,r.useState)(eb),[P,D]=(0,r.useState)(!1),[A,z]=(0,r.useState)(null),O=(0,r.useCallback)(async()=>{o(!0),c(null);try{let e=new URLSearchParams;"all"!==g&&e.append("status",g),u.trim()&&e.append("search",u.trim());let t=await fetch("/api/admin/compare-pages?".concat(e.toString())),s=await t.json().catch(()=>({}));if(!t.ok){let e=[];"string"==typeof s.error&&s.error.trim().length>0&&e.push(s.error.trim()),"string"==typeof s.details&&s.details.trim().length>0&&e.push(s.details.trim());let t=e.join("：")||"获取对比页列表失败";throw Error(t)}let a=(Array.isArray(s.comparePages)?s.comparePages:[]).map(e=>(function(e){if(!e||"object"!=typeof e)return null;let t="string"==typeof e.id?e.id:null,s="string"==typeof e.slug?e.slug:"",a="string"==typeof e.title?e.title:"",r="string"==typeof e.h1?e.h1:"",n="string"==typeof e.description?e.description:"",i="string"==typeof e.content?e.content:"";return t&&s&&a&&r&&n&&i?{id:t,slug:s,title:a,h1:r,description:n,content:i,tool_a_name:"string"==typeof e.tool_a_name?e.tool_a_name:"OpenAI Sora",tool_b_name:"string"==typeof e.tool_b_name?e.tool_b_name:"",comparison_points:e.comparison_points||[],winner:e.winner||null,seo_keywords:Array.isArray(e.seo_keywords)?e.seo_keywords.filter(e=>"string"==typeof e):[],is_published:"boolean"!=typeof e.is_published||e.is_published,created_at:"string"==typeof e.created_at?e.created_at:new Date().toISOString(),updated_at:"string"==typeof e.updated_at?e.updated_at:new Date().toISOString()}:null})(e)).filter(e=>!!e);n(a)}catch(e){console.error("获取对比页列表失败:",e),c(e instanceof Error?e.message:"获取对比页列表失败"),n([])}finally{o(!1)}},[u,g]);(0,r.useEffect)(()=>{O()},[O]);let L=(0,r.useCallback)(async e=>{if(e.trim()){C(!0);try{let s=function(e){let t={},s=y(e,["slug","URL别名","url alias","URL","url","别名","alias","路径","path"]);s&&(t.slug=s.toLowerCase().replace(/[^a-z0-9-]/g,"-"));let a=y(e,["title","标题","Title","页面标题","page title"]);a&&(t.title=a);let r=y(e,["h1","H1","H1标题","h1 title","主标题","main heading"]);r&&(t.h1=r);let n=y(e,["description","描述","Description","元描述","meta description","摘要","summary","简介","introduction"]);n&&(t.description=n);let i=y(e,["content","内容","Content","正文","body","对比内容","comparison content"]);if(!i){let t=e.match(/(?:content|内容|正文|body)[：:]\s*([\s\S]+?)(?=\n\s*(?:tool_a|tool_b|comparison_points|winner|seo|$))/i);t&&t[1]&&(i=x(t[1]))}i&&(t.content=i);let l=y(e,["tool_a_name","tool a","工具A","Tool A","第一个工具","first tool","tool_a","toolA","工具1","tool 1"]);l&&(t.tool_a_name=l);let o=y(e,["tool_b_name","tool b","工具B","Tool B","第二个工具","second tool","tool_b","toolB","工具2","tool 2"]);o&&(t.tool_b_name=o);let d=y(e,["comparison_points","comparison points","对比点","对比项","comparison items","对比内容","comparison content","points","points"]);if(d)try{let e=JSON.parse(d);Array.isArray(e)?t.comparison_points=JSON.stringify(e):t.comparison_points=d}catch(e){t.comparison_points=d}let c=y(e,["winner","获胜者","Winner","胜出","最佳","best","推荐","recommended"]);if(c){let e=c.toLowerCase();e.includes("tool_a")||e.includes("工具a")||e.includes("tool a")||e.includes("a")?t.winner="tool_a":e.includes("tool_b")||e.includes("工具b")||e.includes("tool b")||e.includes("b")?t.winner="tool_b":e.includes("tie")||e.includes("平局")||e.includes("平手")||e.includes("both")?t.winner="tie":t.winner=c.toLowerCase()}t.seo_keywords=f(e,["seo_keywords","seo keywords","SEO关键词","keywords","关键词","tags","标签"]);let u=y(e,["is_published","isPublished","published","发布状态","publish status","status"]);if(u){let e=u.toLowerCase();t.isPublished=e.includes("true")||e.includes("是")||e.includes("yes")||e.includes("published")}return t}(e);v(e=>{let t={...e};return s.slug&&(t.slug=s.slug),s.title&&(t.title=s.title),s.h1&&(t.h1=s.h1),s.description&&(t.description=s.description),s.content&&(t.content=s.content),s.tool_a_name&&(t.tool_a_name=s.tool_a_name),s.tool_b_name&&(t.tool_b_name=s.tool_b_name),s.comparison_points&&(t.comparison_points=s.comparison_points),s.winner&&(t.winner=s.winner),s.seo_keywords&&s.seo_keywords.length>0&&(t.seo_keywords=s.seo_keywords.join(", ")),void 0!==s.isPublished&&(t.isPublished=s.isPublished),t});let a=Object.keys(s).filter(e=>{let t=s[e];return Array.isArray(t)?t.length>0:null!=t&&""!==t}).length;t("success","成功识别并填充了 ".concat(a," 个字段"))}catch(e){console.error("Text recognition failed:",e),t("error",e instanceof Error?e.message:"文本识别失败")}finally{C(!1)}}},[t]),R=(0,r.useMemo)(()=>{let e=u.trim().toLowerCase();return s.filter(t=>{let s="all"===g||("published"===g?t.is_published:!t.is_published),a=""===e||t.slug.toLowerCase().includes(e)||t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.h1.toLowerCase().includes(e)||t.tool_b_name.toLowerCase().includes(e);return s&&a})},[s,u,g]),B=async e=>{if(e.preventDefault(),!b.slug.trim()){t("error","请输入slug");return}if(!b.title.trim()){t("error","请输入标题");return}if(!b.h1.trim()){t("error","请输入H1标题");return}if(!b.content.trim()){t("error","请输入内容");return}if(!b.tool_b_name.trim()){t("error","请输入工具B名称");return}k(!0);try{let e;try{e=JSON.parse(b.comparison_points)}catch(t){e=[]}let s=await fetch("/api/admin/compare-pages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:b.slug.trim(),title:b.title.trim(),h1:b.h1.trim(),description:b.description.trim(),content:b.content.trim(),tool_a_name:b.tool_a_name.trim(),tool_b_name:b.tool_b_name.trim(),comparison_points:e,winner:b.winner||null,seo_keywords:ej(b.seo_keywords),is_published:b.isPublished})}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join("：")||"创建对比页失败";throw Error(t)}t("success","对比页创建成功"),v(eb),await O()}catch(e){console.error("创建对比页失败:",e),t("error",e instanceof Error?e.message:"创建对比页失败")}finally{k(!1)}},M=e=>{I(e.id),T({slug:e.slug,title:e.title,h1:e.h1,description:e.description,content:e.content,tool_a_name:e.tool_a_name,tool_b_name:e.tool_b_name,comparison_points:JSON.stringify(e.comparison_points,null,2),winner:e.winner||"",seo_keywords:e.seo_keywords.join(", "),isPublished:e.is_published})},F=()=>{I(null),T(eb)},H=async e=>{if(!E.slug.trim()||!E.title.trim()||!E.h1.trim()||!E.content.trim()){t("error","请填写所有必需字段");return}D(!0);try{let s;try{s=JSON.parse(E.comparison_points)}catch(e){s=[]}let a=await fetch("/api/admin/compare-pages/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:E.slug.trim(),title:E.title.trim(),h1:E.h1.trim(),description:E.description.trim(),content:E.content.trim(),tool_a_name:E.tool_a_name.trim(),tool_b_name:E.tool_b_name.trim(),comparison_points:s,winner:E.winner||null,seo_keywords:ej(E.seo_keywords),is_published:E.isPublished})}),r=await a.json().catch(()=>({}));if(!a.ok){let e=[];"string"==typeof r.error&&r.error.trim().length>0&&e.push(r.error.trim()),"string"==typeof r.details&&r.details.trim().length>0&&e.push(r.details.trim());let t=e.join("：")||"更新对比页失败";throw Error(t)}t("success","对比页更新成功"),I(null),await O()}catch(e){console.error("更新对比页失败:",e),t("error",e instanceof Error?e.message:"更新对比页失败")}finally{D(!1)}},q=async e=>{if(confirm("确定要删除这个对比页吗？此操作无法撤销。")){z(e);try{let s=await fetch("/api/admin/compare-pages/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok){let e=[];"string"==typeof a.error&&a.error.trim().length>0&&e.push(a.error.trim()),"string"==typeof a.details&&a.details.trim().length>0&&e.push(a.details.trim());let t=e.join("：")||"删除对比页失败";throw Error(t)}t("success","对比页已删除"),await O()}catch(e){console.error("删除对比页失败:",e),t("error",e instanceof Error?e.message:"删除对比页失败")}finally{z(null)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"对比页管理"})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(i.II,{placeholder:"搜索 slug、标题、描述...",value:u,onChange:e=>m(e.target.value)}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:g,onChange:e=>p(e.target.value),children:[(0,a.jsx)("option",{value:"all",children:"所有状态"}),(0,a.jsx)("option",{value:"published",children:"已发布"}),(0,a.jsx)("option",{value:"draft",children:"草稿"})]})]}),l?(0,a.jsx)("div",{className:"py-8 text-center text-gray-500",children:"加载中..."}):d?(0,a.jsx)("div",{className:"py-8 text-center text-red-500",children:d}):0===R.length?(0,a.jsx)("div",{className:"py-8 text-center text-gray-500",children:"暂无对比页"}):(0,a.jsx)("div",{className:"space-y-2",children:R.map(e=>{let t=S===e.id,s=A===e.id;return t?(0,a.jsx)(i.Zb,{className:"border-blue-300",children:(0,a.jsxs)(i.aY,{className:"space-y-4 p-4",children:[(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(i.II,{placeholder:"Slug",value:E.slug,onChange:e=>T({...E,slug:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"标题",value:E.title,onChange:e=>T({...E,title:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"H1",value:E.h1,onChange:e=>T({...E,h1:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"工具A名称",value:E.tool_a_name,onChange:e=>T({...E,tool_a_name:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"工具B名称",value:E.tool_b_name,onChange:e=>T({...E,tool_b_name:e.target.value})}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:E.winner,onChange:e=>T({...E,winner:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"无"}),(0,a.jsx)("option",{value:"tool_a",children:"工具A获胜"}),(0,a.jsx)("option",{value:"tool_b",children:"工具B获胜"}),(0,a.jsx)("option",{value:"tie",children:"平局"})]})]}),(0,a.jsx)(i.gx,{placeholder:"描述",value:E.description,onChange:e=>T({...E,description:e.target.value}),rows:2}),(0,a.jsx)(i.gx,{placeholder:"内容 (HTML)",value:E.content,onChange:e=>T({...E,content:e.target.value}),rows:10}),(0,a.jsx)(i.gx,{placeholder:"对比点 (JSON数组)",value:E.comparison_points,onChange:e=>T({...E,comparison_points:e.target.value}),rows:5}),(0,a.jsx)(i.II,{placeholder:"SEO Keywords (逗号分隔)",value:E.seo_keywords,onChange:e=>T({...E,seo_keywords:e.target.value})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:E.isPublished,onChange:e=>T({...E,isPublished:e.target.checked})}),(0,a.jsx)("span",{className:"text-sm",children:"已发布"})]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:()=>H(e.id),disabled:P,size:"sm",children:P?"更新中...":"保存"}),(0,a.jsx)(i.zx,{onClick:F,variant:"secondary",size:"sm",children:"取消"})]})]})},e.id):(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.title}),(0,a.jsx)(i.Ct,{className:ev[e.is_published?"published":"draft"].className,children:ev[e.is_published?"published":"draft"].label})]}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:["Slug: ",e.slug]}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-500",children:[e.tool_a_name," vs ",e.tool_b_name]}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-500",children:e.description})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:()=>M(e),size:"sm",variant:"secondary",children:"编辑"}),(0,a.jsx)(i.zx,{onClick:()=>q(e.id),disabled:s,size:"sm",variant:"danger",children:s?"删除中...":"删除"})]})]})})},e.id)})})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"创建新对比页"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,a.jsx)(h,{textInput:w,onTextInputChange:N,onRecognize:L,isRecognizing:_,onShowBanner:t}),(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsx)(i.II,{placeholder:"Slug *",value:b.slug,onChange:e=>v({...b,slug:e.target.value}),required:!0}),(0,a.jsx)(i.II,{placeholder:"标题 *",value:b.title,onChange:e=>v({...b,title:e.target.value}),required:!0}),(0,a.jsx)(i.II,{placeholder:"H1 *",value:b.h1,onChange:e=>v({...b,h1:e.target.value}),required:!0}),(0,a.jsx)(i.II,{placeholder:"工具A名称",value:b.tool_a_name,onChange:e=>v({...b,tool_a_name:e.target.value})}),(0,a.jsx)(i.II,{placeholder:"工具B名称 *",value:b.tool_b_name,onChange:e=>v({...b,tool_b_name:e.target.value}),required:!0}),(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 dark:border-gray-700 dark:bg-gray-800",value:b.winner,onChange:e=>v({...b,winner:e.target.value}),children:[(0,a.jsx)("option",{value:"",children:"无"}),(0,a.jsx)("option",{value:"tool_a",children:"工具A获胜"}),(0,a.jsx)("option",{value:"tool_b",children:"工具B获胜"}),(0,a.jsx)("option",{value:"tie",children:"平局"})]})]}),(0,a.jsx)(i.gx,{placeholder:"描述 *",value:b.description,onChange:e=>v({...b,description:e.target.value}),rows:2,required:!0}),(0,a.jsx)(i.gx,{placeholder:"内容 (HTML) *",value:b.content,onChange:e=>v({...b,content:e.target.value}),rows:10,required:!0}),(0,a.jsx)(i.gx,{placeholder:'对比点 (JSON数组，例如: [{"feature": "价格", "tool_a": "免费", "tool_b": "付费"}])',value:b.comparison_points,onChange:e=>v({...b,comparison_points:e.target.value}),rows:5}),(0,a.jsx)(i.II,{placeholder:"SEO Keywords (逗号分隔)",value:b.seo_keywords,onChange:e=>v({...b,seo_keywords:e.target.value})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:b.isPublished,onChange:e=>v({...b,isPublished:e.target.checked})}),(0,a.jsx)("span",{className:"text-sm",children:"已发布"})]})}),(0,a.jsx)(i.zx,{type:"submit",disabled:j,children:j?"创建中...":"创建对比页"})]})})]})]})}var ew=s(3953);function eN(e){var t;let{onShowBanner:s}=e,[n,l]=(0,r.useState)("use-case"),[o,d]=(0,r.useState)(""),[c,u]=(0,r.useState)([]),[m,g]=(0,r.useState)(!1),[h,p]=(0,r.useState)(-1),[x,y]=(0,r.useState)(!0),[f,b]=(0,r.useState)(!1),v=(0,r.useRef)(null),j=["Fitness Course Video","Pet Short Video","Amazon Product Video","Education Course Video","Marketing Ad Video","TikTok Viral Video","YouTube Tutorial Video","Product Demo Video","Real Estate Tour Video","Food Recipe Video","Travel Vlog Video","Fashion Showcase Video","Tech Product Review","Gaming Highlight Video","Music Video","Corporate Training Video","Event Promotion Video","Charity Campaign Video","News Summary Video","Sports Highlight Video","Beauty Tutorial Video","Home Decor Video","Car Review Video","Book Trailer Video","App Demo Video","Website Intro Video","Podcast Video","Webinar Recording Video","Customer Testimonial Video","Brand Story Video","Holiday Greeting Video","Birthday Video","Wedding Highlight Video","Graduation Video","Anniversary Video","New Product Launch Video","Sale Promotion Video","Event Recap Video","Behind The Scenes Video","Team Introduction Video","Company Culture Video","Service Explanation Video","FAQ Video","How-to Guide Video","Unboxing Video","Comparison Video","Before After Video","Transformation Video","Success Story Video","Case Study Video"],k=["Fitness & Sports","Pet Care","E-commerce","Education","Marketing & Advertising","Social Media","Entertainment","Technology","Real Estate","Food & Beverage","Travel & Tourism","Fashion & Beauty","Gaming","Music","Corporate","Events","Charity","News & Media","Automotive","Publishing","Mobile Apps","Web Services","Healthcare","Finance","Retail"],w=["ai fitness video generator","ai pet video maker","ai product video creator","ai education video tool","ai marketing video generator","ai tiktok video maker","ai youtube video generator","ai product demo creator","ai real estate video tool","ai food video generator","ai travel vlog maker","ai fashion video creator","ai tech review generator","ai gaming video maker","ai music video creator","ai corporate training video","ai event video generator","ai charity video maker","ai news video creator","ai sports video generator","ai beauty tutorial maker","ai home decor video","ai car review generator","ai book trailer maker","ai app demo video","ai website intro generator","ai podcast video maker","ai webinar video creator","ai testimonial video","ai brand story generator","ai holiday video maker","ai birthday video creator","ai wedding video generator","ai graduation video maker","ai anniversary video","ai product launch video","ai sale video generator","ai event recap video","ai behind scenes video","ai team intro video","ai company culture video","ai service explanation video","ai faq video generator","ai how to video maker","ai unboxing video creator","ai comparison video","ai before after video","ai transformation video","ai success story video","ai case study video"],N=["realistic","cinematic","animated","commercial","educational","creative","professional","casual"],_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=ew.Le.find(e=>e.id===n);if(!t)return"";let s=t.parameters.map(e=>e.key).join(","),a=[];for(let s=0;s<e;s++){let e=[];t.parameters.forEach(t=>{if("scene"===t.key)e.push(j[s%j.length]);else if("industry"===t.key)e.push(k[s%k.length]);else if("keyword"===t.key)e.push(w[s%w.length]);else if("style"===t.key)e.push(N[s%N.length]);else if("title"===t.key){let t=["Best AI Video Generator for Creators","How to Create Stunning Videos with AI","AI Video Generation: Complete Guide","Top AI Video Tools for Marketing","Creating Professional Videos with AI","AI Video Maker: Tips and Tricks","Transform Your Content with AI Video","AI Video Generation Made Easy","Master AI Video Creation","AI Video Tools: Everything You Need to Know"];e.push(t[s%t.length])}else if("audience"===t.key){let t=["Content Creators","Marketing Professionals","Business Owners","Educators","Social Media Managers","Video Editors","Entrepreneurs","Small Business Owners","Agencies","Freelancers"];e.push(t[s%t.length])}else if("tool_a"===t.key)e.push("OpenAI Sora");else if("tool_b"===t.key){let t=["Runway","Pika Labs","Luma AI","Stable Video","Kling AI"];e.push(t[s%t.length])}else e.push("")}),a.push(e.join(","))}return[s,...a].join("\n")},C=e=>{let t=e.trim().split("\n");if(t.length<2)return[];let s=t[0].split(",").map(e=>e.trim()),a=[];for(let e=1;e<t.length;e++){let r=t[e].split(",").map(e=>e.trim()),n={};s.forEach((e,t)=>{n[e]=r[t]||""}),a.push(n)}return a},S=async e=>{let t=ew.Le.find(t=>t.id===e.templateId);if(!t)throw Error("Template not found");let s=(0,ew.SM)(t.template,e.params),a=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemini-2.5-flash",stream:!1,messages:[{role:"system",content:"You are a professional SEO content writer. Please generate content strictly according to the requirements. All output must be in English."},{role:"user",content:s}]})});if(!a.ok)throw Error((await a.json().catch(()=>({}))).error||"HTTP ".concat(a.status));let r=await a.json();if(r.success&&r.data){var n,i,l;let e=(null===(l=r.data.choices)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:null===(n=i.message)||void 0===n?void 0:n.content)||"";if(!e)throw Error("Generated content is empty");return e}throw Error(r.error||"Generation failed")},I=(e,t)=>{var s;let a=e.match(/^#\s+(.+)$/m)||e.match(/<h1[^>]*>(.+?)<\/h1>/i);if(a)return a[1].trim().replace(/<[^>]+>/g,"");let r=e.match(/^##\s+(.+)$/m)||e.match(/<h2[^>]*>(.+?)<\/h2>/i);if(r)return r[1].trim().replace(/<[^>]+>/g,"");if(t)return t;let n=(null===(s=e.split("\n")[0])||void 0===s?void 0:s.trim())||"";return n&&!n.startsWith("#")?n.substring(0,100):""},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,s=e.replace(/^#+\s+.+$/gm,"").replace(/<[^>]+>/g,"").replace(/\n+/g," ").trim(),a=s.split(/\n\n/)[0]||s;return a.length<=t?a:a.substring(0,t)+"..."},T=e=>!e||e.trim().length<100?{valid:!1,error:"Content is too short (less than 100 characters)"}:/^#\s+.+$/m.test(e)||/<h1[^>]*>.+?<\/h1>/i.test(e)?(e.match(/^##\s+.+$/gm)||[]).length+(e.match(/<h2[^>]*>.+?<\/h2>/gi)||[]).length<2?{valid:!1,error:"Content structure is incomplete (at least 2 H2 headings required)"}:{valid:!0}:{valid:!1,error:"Missing H1 title"},P=async(e,t)=>{let s=T(t);if(!s.valid)throw Error(s.error||"Content validation failed");try{var a,r,n,i;let s=e.params.title||e.params.scene||e.params.keyword||"Untitled",l=I(t,s)||s,o=e.params.title||e.params.scene||e.params.keyword||l,d=E(t),c=en(e.params.keyword||e.params.scene||e.params.title||l);if(!l||""===l.trim())throw Error("Unable to extract H1 title. Please ensure the generated content includes a title");if(!c)throw Error("Unable to generate a valid slug");let u="",m="";if("use-case"===e.templateId){let s=await fetch("/api/admin/use-cases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:c,title:o,h1:l,description:d,content:t,use_case_type:"advertising-promotion",is_published:!0,seo_keywords:e.params.keyword?[e.params.keyword]:[]})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Save failed: HTTP ".concat(s.status))}let r=await s.json();if(u=(null===(a=r.useCase)||void 0===a?void 0:a.id)||"",m="use_cases",!u)throw Error("Save succeeded but no ID was returned")}else if("long-tail-keyword"===e.templateId){let s=await fetch("/api/admin/keywords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyword:e.params.keyword||o,intent:"information",page_slug:c,title:o,h1:l,meta_description:d,intro_paragraph:E(t,500),status:"published"})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Save failed: HTTP ".concat(s.status))}let a=await s.json();if(u=(null===(r=a.keyword)||void 0===r?void 0:r.id)||"",m="long_tail_keywords",!u)throw Error("Save succeeded but no ID was returned")}else if("blog-post"===e.templateId){let s=await fetch("/api/admin/blog-posts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:c,title:o,description:d,h1:l,content:t,is_published:!0,published_at:new Date().toISOString(),seo_keywords:e.params.keyword?[e.params.keyword]:[]})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Save failed: HTTP ".concat(s.status))}let a=await s.json();if(u=(null===(n=a.blogPost)||void 0===n?void 0:n.id)||"",m="blog_posts",!u)throw Error("Save succeeded but no ID was returned")}else if("compare-page"===e.templateId){let s=await fetch("/api/admin/compare-pages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({slug:c,title:o,h1:l,description:d,content:t,tool_a_name:e.params.tool_a||"OpenAI Sora",tool_b_name:e.params.tool_b||"",is_published:!0,seo_keywords:e.params.keyword?[e.params.keyword]:[]})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"Save failed: HTTP ".concat(s.status))}let a=await s.json();if(u=(null===(i=a.comparePage)||void 0===i?void 0:i.id)||"",m="compare_pages",!u)throw Error("Save succeeded but no ID was returned")}else throw Error("Unsupported template type: ".concat(e.templateId));return{id:u,table:m,slug:c}}catch(e){throw e}},D=async()=>{if(!o.trim()){s("error","Please enter CSV data");return}let e=C(o);if(0===e.length){s("error","CSV data format error");return}if(!ew.Le.find(e=>e.id===n)){s("error","Please select a template");return}let t=e.map((e,t)=>({id:"task-".concat(Date.now(),"-").concat(t),templateId:n,params:e,status:"pending"}));u(t),g(!0),b(!1);for(let e=0;e<t.length;e++){if(f){u(t=>{let s=[...t];for(let t=e;t<s.length;t++)"pending"===s[t].status&&(s[t]={...s[t],status:"failed",error:"Cancelled"});return s});break}let s=t[e];p(e),u(t=>{let s=[...t];return s[e]={...s[e],status:"processing"},s});try{let a=await S(s);if(u(t=>{let s=[...t];return s[e]={...s[e],status:"completed",result:a,model:"gemini-2.5-flash"},s}),x)try{let t=await P(s,a);u(s=>{let a=[...s];return a[e]={...a[e],status:"saved",savedId:t.id,savedTable:t.table,savedSlug:t.slug},a})}catch(s){console.error("保存失败:",s);let t=s instanceof Error?s.message:"Unknown error";u(s=>{let a=[...s];return a[e]={...a[e],error:"Save failed: ".concat(t)},a})}e<t.length-1&&await new Promise(e=>setTimeout(e,1e3))}catch(s){let t=s instanceof Error?s.message:"Unknown error";u(s=>{let a=[...s];return a[e]={...a[e],status:"failed",error:t},a})}}g(!1),p(-1),b(!1);let a=t.filter(e=>"completed"===e.status||"saved"===e.status).length;f?s("success","Batch generation stopped: ".concat(a,"/").concat(t.length," tasks completed")):s("success","Batch generation completed: ".concat(a,"/").concat(t.length," successful"))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"批量内容生成"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"使用 AI 批量生成 SEO 内容，支持使用场景、长尾词、博客文章等"})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"生成配置"})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"选择模板"}),(0,a.jsx)("select",{className:"w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:n,onChange:e=>l(e.target.value),disabled:m,children:ew.Le.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",e.description]},e.id))}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:null===(t=ew.Le.find(e=>e.id===n))||void 0===t?void 0:t.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"CSV 数据（第一行为表头）"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)("input",{ref:v,type:"file",accept:".csv,.txt",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let r=new FileReader;r.onload=e=>{var t;d(null===(t=e.target)||void 0===t?void 0:t.result),s("success","CSV file loaded")},r.readAsText(a),v.current&&(v.current.value="")},className:"hidden",id:"csv-upload",disabled:m}),(0,a.jsx)("label",{htmlFor:"csv-upload",className:"cursor-pointer rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-700 transition hover:bg-gray-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:hover:bg-gray-700",children:"\uD83D\uDCC1 上传 CSV"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>d("scene,industry,keyword,style\nFitness Course Video,Fitness & Sports,ai fitness video generator,realistic\nPet Short Video,Pet Care,ai pet tiktok video,animated\nAmazon Product Video,E-commerce,ai product video generator,commercial\nEducation Course Video,Education,ai education video generator,educational\nMarketing Ad Video,Marketing & Advertising,ai marketing video generator,professional"),disabled:m,children:"\uD83D\uDCCB 使用示例（5条）"}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>d(_(50)),disabled:m,className:"bg-energy-water text-white hover:bg-energy-water/90",children:"✨ 快速生成 50 条"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>d(_(100)),disabled:m,children:"\uD83D\uDE80 快速生成 100 条"})]})]}),(0,a.jsx)(i.gx,{value:o,onChange:e=>d(e.target.value),placeholder:"Paste CSV data, first row is header...",rows:8,className:"font-mono text-sm",disabled:m}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Tip: CSV format, first row is parameter names (e.g., scene,industry,keyword), subsequent rows are data"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",id:"auto-save",checked:x,onChange:e=>y(e.target.checked),disabled:m,className:"h-4 w-4 rounded border-gray-300 text-energy-water focus:ring-energy-water"}),(0,a.jsx)("label",{htmlFor:"auto-save",className:"text-sm text-gray-700 dark:text-gray-300",children:"自动保存到数据库（生成后自动保存到对应的使用场景/长尾词/博客等模块）"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[m?(0,a.jsx)(i.zx,{onClick:()=>{b(!0),s("success","Stopping batch generation, please wait...")},variant:"danger",className:"flex-1",children:"⏹️ 终止生成"}):(0,a.jsx)(i.zx,{onClick:D,disabled:!o.trim(),className:"flex-1",children:"\uD83D\uDE80 开始批量生成"}),c.length>0&&(0,a.jsx)(i.zx,{variant:"secondary",onClick:()=>{let e=c.filter(e=>"completed"===e.status&&e.result);if(0===e.length){s("error","No content available for export");return}let t=new Blob([JSON.stringify(e.map(e=>({params:e.params,content:e.result})),null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="batch-content-".concat(Date.now(),".json"),r.click(),URL.revokeObjectURL(a),s("success","Exported ".concat(e.length," items"))},disabled:m,children:"\uD83D\uDCE5 导出结果"})]})]})]}),c.length>0&&(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)(i.ll,{children:["生成任务 (",c.filter(e=>"saved"===e.status||"completed"===e.status).length,"/",c.length," 完成",x&&c.filter(e=>"saved"===e.status).length>0&&(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-green-600 dark:text-green-400",children:["(",c.filter(e=>"saved"===e.status).length," 已保存)"]}),m&&h>=0&&(0,a.jsxs)("span",{className:"ml-2 text-sm font-normal text-blue-600 dark:text-blue-400",children:["(正在处理: ",h+1,"/",c.length,")"]}),")"]})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:c.map((e,t)=>(0,a.jsxs)("div",{className:"rounded-lg border p-3 ".concat("saved"===e.status?"border-green-300 bg-green-100 dark:border-green-700 dark:bg-green-900/30":"completed"===e.status?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"failed"===e.status?"border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20":"processing"===e.status?"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-900/20":"border-gray-200 bg-gray-50 dark:border-gray-700 dark:bg-gray-800/50"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["任务 ",t+1]}),(0,a.jsx)("span",{className:"rounded-full px-2 py-0.5 text-xs ".concat("saved"===e.status?"bg-green-200 text-green-900 dark:bg-green-800 dark:text-green-100":"completed"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"failed"===e.status?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"processing"===e.status?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"),children:"saved"===e.status?"✓ Saved":"completed"===e.status?"✓ Completed":"failed"===e.status?"✗ Failed":"processing"===e.status?"⏳ Processing":"⏸ Waiting"})]}),(0,a.jsx)("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:Object.entries(e.params).filter(e=>{let[,t]=e;return t}).map(e=>{let[t,s]=e;return"".concat(t,": ").concat(s)}).join(" | ")}),e.error&&(0,a.jsxs)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:["错误: ",e.error]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:e.result&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>{let e=[...c];e[t]={...e[t],showContent:!e[t].showContent},u(e)},children:e.showContent?"\uD83D\uDC41️ Hide Content":"\uD83D\uDC41️ View Content"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(e.result||""),s("success","Content copied to clipboard")},children:"\uD83D\uDCCB 复制"})]})})]}),e.result&&(0,a.jsx)("div",{className:"mt-3",children:e.showContent?(0,a.jsxs)("div",{className:"max-h-96 overflow-y-auto rounded-lg border border-gray-200 bg-white p-4 text-sm dark:border-gray-700 dark:bg-gray-800",children:[(0,a.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"生成的内容预览（完整）"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:[e.result.length," 字符"]})]}),(0,a.jsx)("pre",{className:"whitespace-pre-wrap break-words text-gray-700 dark:text-gray-300",children:e.result})]}):(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-3 text-xs dark:border-gray-700 dark:bg-gray-800/50",children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"内容预览（前200字符）"}),(0,a.jsxs)("span",{className:"text-gray-500 dark:text-gray-500",children:[e.result.length," 字符"]})]}),(0,a.jsxs)("pre",{className:"whitespace-pre-wrap break-words text-gray-700 dark:text-gray-300",children:[e.result.substring(0,200),e.result.length>200&&"..."]}),(0,a.jsx)("button",{onClick:()=>{let e=[...c];e[t]={...e[t],showContent:!0},u(e)},className:"mt-2 text-xs text-energy-water hover:underline",children:"点击展开查看完整内容 →"})]})})]},e.id))})})]})]})}function e_(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(""),[g,h]=(0,r.useState)([]),[p,x]=(0,r.useState)(!1),y=(0,r.useRef)(null),f=(0,r.useRef)(null),b=(0,r.useRef)(null),v=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admin/chat/sessions"),t=await e.json();t.success&&(n(t.data||[]),t.data&&t.data.length>0&&!l&&o(t.data[0].id))}catch(e){console.error("加载会话列表失败:",e)}},[l]),j=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/admin/chat/messages?sessionId=".concat(e)),s=await t.json();s.success&&c(s.data||[])}catch(e){console.error("加载消息列表失败:",e)}},[]),k=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admin/chat/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"新对话"})}),t=await e.json();t.success&&(await v(),o(t.data.id),c([]),m(""),h([]))}catch(e){console.error("创建会话失败:",e),null==t||t("error","创建会话失败")}},[v,t]),w=(0,r.useCallback)(async e=>{if(confirm("确定要删除这个会话吗？"))try{let s=await fetch("/api/admin/chat/sessions?id=".concat(e),{method:"DELETE"});(await s.json()).success&&(await v(),l===e&&(o(null),c([])),null==t||t("success","会话已删除"))}catch(e){console.error("删除会话失败:",e),null==t||t("error","删除会话失败")}},[l,v,t]);(0,r.useEffect)(()=>{v()},[v]),(0,r.useEffect)(()=>{l?j(l):c([])},[l,j]),(0,r.useEffect)(()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[d,p]);let N=e=>{h(t=>t.filter((t,s)=>s!==e))},_=(0,r.useCallback)(async()=>{if(!u.trim()&&0===g.length||p)return;let e=l;if(!e)try{let t=await fetch("/api/admin/chat/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:u.substring(0,50)||"新对话"})}),s=await t.json();if(s.success)e=s.data.id,o(e),await v();else throw Error("创建会话失败")}catch(e){console.error("创建会话失败:",e),null==t||t("error","创建会话失败");return}let s={id:Date.now().toString(),role:"user",content:u.trim(),images:g.length>0?[...g]:void 0};c(e=>[...e,s]),m(""),h([]),x(!0);let a=(Date.now()+1).toString(),r={id:a,role:"assistant",content:""};c(e=>[...e,r]);try{var n,i,d,y,f,b,k,w,N;let s=await fetch("/api/admin/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,message:u.trim(),images:g,stream:!0,saveHistory:!0})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"HTTP ".concat(s.status))}let r=null===(n=s.body)||void 0===n?void 0:n.getReader();if(!r)throw Error("无法读取流式响应");let l=new TextDecoder,o="",m="",h=null;for(;;){let{done:e,value:t}=await r.read();if(e)break;let s=(o+=l.decode(t,{stream:!0})).split("\n");for(let e of(o=s.pop()||"",s)){let t=e.trim();if(t&&"data: [DONE]"!==t&&t.startsWith("data: "))try{let e=JSON.parse(t.slice(6));if(0===m.length&&console.log("[Admin Chat Client] 第一个chunk:",{hasError:!!e.error,hasChoices:!!e.choices,choicesLength:(null===(i=e.choices)||void 0===i?void 0:i.length)||0,hasDelta:!!(null===(y=e.choices)||void 0===y?void 0:null===(d=y[0])||void 0===d?void 0:d.delta),hasContent:!!(null===(k=e.choices)||void 0===k?void 0:null===(b=k[0])||void 0===b?void 0:null===(f=b.delta)||void 0===f?void 0:f.content),finishReason:null===(N=e.choices)||void 0===N?void 0:null===(w=N[0])||void 0===w?void 0:w.finish_reason,model:e.model,fullData:JSON.stringify(e,null,2)}),e.error){let t=e.error.message||e.error.code||"API返回错误",s=e.error.type||e.error.finishReason||"unknown";if(console.error("[Admin Chat] API错误:",{message:t,type:s,fullError:e.error}),"content_filter"===s||"safety"===s||e.error.finishReason)throw Error("内容被过滤，请尝试修改消息内容或使用不同的表达方式");throw Error(t)}if(e.model&&!h&&(h=e.model,console.log("[Admin Chat Client] 检测到模型:",e.model)),e.choices&&e.choices.length>0){let t=e.choices[0].delta,s=e.choices[0].finish_reason;if("content_filter"===s||"safety"===s)throw Error("内容被过滤或拒绝，请尝试修改消息内容");(null==t?void 0:t.content)?(m+=t.content,c(e=>{let t=[...e],s=t.length-1;return s>=0&&t[s].id===a&&(t[s]={...t[s],content:m,model:h||void 0}),t})):t&&Object.keys(t).length>0&&console.warn("[Admin Chat Client] Delta无content:",t,"finishReason:",s)}else console.warn("[Admin Chat Client] 无choices:",e)}catch(e){if(e instanceof Error&&(e.message.includes("API")||e.message.includes("内容被过滤")))throw e;console.warn("解析流式响应失败:",t,e)}}}if(0===m.length)throw console.error("[Admin Chat Client] ⚠️⚠️⚠️ 流式响应完成但内容为空！",{detectedModel:h,totalChunks:m.length}),Error("AI没有返回任何内容，请检查服务器日志");console.log("[Admin Chat Client] 流式响应完成:",{contentLength:m.length,model:h}),e&&await j(e),null==t||t("success","消息已发送")}catch(s){console.error("发送消息失败:",s);let e=s instanceof Error?s.message:"请求失败";c(t=>{let s=[...t],r=s.length-1;return r>=0&&s[r].id===a&&(s[r]={...s[r],content:"错误: ".concat(e)}),s}),null==t||t("error",e)}finally{x(!1)}},[u,g,p,l,j,t]);return(0,a.jsxs)("div",{className:"flex h-[calc(100vh-200px)] gap-4",children:[(0,a.jsxs)("div",{className:"w-64 shrink-0 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)(i.zx,{onClick:k,className:"w-full",size:"sm",children:"+ 新对话"})}),(0,a.jsx)("div",{className:"overflow-y-auto h-[calc(100%-80px)]",children:s.map(e=>(0,a.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ".concat(l===e.id?"bg-energy-water-surface dark:bg-energy-water-muted":""),onClick:()=>o(e.id),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.updated_at).toLocaleDateString()})]}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),w(e.id)},className:"ml-2 text-gray-400 hover:text-red-500",children:"\xd7"})]})},e.id))})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col bg-white dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===d.length?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"mb-2 text-2xl font-semibold text-gray-900 dark:text-white",children:"开始对话"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"输入你的问题，AI 助手会帮助你。支持上传多张图片进行分析。"})]})}):(0,a.jsxs)("div",{className:"space-y-6 max-w-4xl mx-auto",children:[d.map(e=>(0,a.jsxs)("div",{className:"flex gap-4 ".concat("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-energy-water text-white",children:"AI"}),(0,a.jsxs)("div",{className:"group relative max-w-[80%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-energy-water text-white":"bg-gray-100 text-gray-900 shadow-sm dark:bg-gray-800 dark:text-gray-100"),children:[e.images&&e.images.length>0&&(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:e.images.map((e,t)=>(0,a.jsx)("img",{src:e,alt:"Uploaded ".concat(t+1),className:"max-w-xs rounded-lg"},t))}),e.model&&"assistant"===e.role&&(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)(i.Ct,{variant:"secondary",className:"text-xs",children:e.model}),(0,a.jsx)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:function(e){switch(e){case"gemini-2-flash":return"快速响应，成本最低，适合一般对话";case"gemini-3-flash":return"支持联网搜索，适合成本对比、价格分析、同行分析";case"gemini-3-pro":return"最高质量，适合复杂分析任务";default:return"未知模型"}}(e.model)})]}),(0,a.jsx)("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:e.content||"..."}),"assistant"===e.role&&e.content&&(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(e.content),null==t||t("success","已复制到剪贴板")},className:"absolute right-2 top-2 opacity-0 transition-opacity group-hover:opacity-100",title:"复制",children:(0,a.jsx)("svg",{className:"h-4 w-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),"user"===e.role&&(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gray-300 text-gray-700 dark:bg-gray-700 dark:text-gray-200",children:"你"})]},e.id)),p&&(0,a.jsxs)("div",{className:"flex gap-4 justify-start",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-energy-water text-white",children:"AI"}),(0,a.jsx)("div",{className:"rounded-2xl bg-gray-100 px-4 py-3 shadow-sm dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.3s]"}),(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.15s]"}),(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400"})]})})]}),(0,a.jsx)("div",{ref:y})]})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 bg-white px-4 py-4 dark:border-gray-800 dark:bg-gray-900",children:[g.length>0&&(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:g.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"h-20 w-20 rounded-lg object-cover"}),(0,a.jsx)("button",{onClick:()=>N(t),className:"absolute -right-2 -top-2 rounded-full bg-red-500 text-white p-1 text-xs",children:"\xd7"})]},t))}),(0,a.jsxs)("div",{className:"flex items-end gap-2",children:[(0,a.jsx)("input",{ref:b,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;if(!t)return;let s=[],a=Array.from(t);a.forEach(e=>{if(e.type.startsWith("image/")){let t=new FileReader;t.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;s.push(r),s.length===a.length&&h(e=>[...e,...s])},t.readAsDataURL(e)}})},className:"hidden"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.click()},disabled:p,children:"\uD83D\uDCF7"}),(0,a.jsx)("div",{className:"flex-1 rounded-lg border border-gray-300 bg-white shadow-sm dark:border-gray-600 dark:bg-gray-800",children:(0,a.jsx)("textarea",{ref:f,value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),_())},placeholder:"输入你的问题... (Cmd/Ctrl + Enter 发送)",className:"w-full resize-none border-0 bg-transparent px-4 py-3 text-sm text-gray-900 placeholder-gray-500 focus:outline-none dark:text-gray-100 dark:placeholder-gray-400",rows:1,style:{minHeight:"52px",maxHeight:"200px"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height="".concat(Math.min(t.scrollHeight,200),"px")}})}),(0,a.jsx)(i.zx,{onClick:_,disabled:!u.trim()&&0===g.length||p,className:"h-12 px-6",children:p?(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):"发送"}),d.length>0&&(0,a.jsx)(i.zx,{variant:"ghost",onClick:()=>{m(""),h([])},disabled:p,className:"h-12",children:"清空"})]}),(0,a.jsx)("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"按 Cmd/Ctrl + Enter 发送，Shift + Enter 换行。支持上传多张图片进行分析。"})]})]})]})}function eC(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,o]=(0,r.useState)(null),[d,c]=(0,r.useState)([]),[u,m]=(0,r.useState)(""),[g,h]=(0,r.useState)([]),[p,x]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null),[j,k]=(0,r.useState)({}),w=(0,r.useRef)(null),N=(0,r.useRef)(null),_=(0,r.useRef)(null),C=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admin/chat/sessions"),t=await e.json();if(t.success){let e=(t.data||[]).filter(e=>e.title.includes("SEO")||e.title.includes("使用场景")||e.title.includes("关键词")||e.title.includes("博客")||e.title.includes("对比")||e.title.includes("行业"));n(e),e.length>0&&!l&&o(e[0].id)}}catch(e){console.error("加载会话列表失败:",e)}},[l]),S=(0,r.useCallback)(async e=>{try{let t=await fetch("/api/admin/chat/messages?sessionId=".concat(e)),s=await t.json();s.success&&c(s.data||[])}catch(e){console.error("加载消息列表失败:",e)}},[]),I=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admin/chat/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"SEO 对话"})}),t=await e.json();t.success&&(await C(),o(t.data.id),c([]),m(""),h([]),v(null),k({}))}catch(e){console.error("创建会话失败:",e),null==t||t("error","创建会话失败")}},[C,t]),E=(0,r.useCallback)(async e=>{if(confirm("确定要删除这个会话吗？"))try{let s=await fetch("/api/admin/chat/sessions?id=".concat(e),{method:"DELETE"});(await s.json()).success&&(await C(),l===e&&(o(null),c([])),null==t||t("success","会话已删除"))}catch(e){console.error("删除会话失败:",e),null==t||t("error","删除会话失败")}},[l,C,t]);(0,r.useEffect)(()=>{C()},[C]),(0,r.useEffect)(()=>{l?S(l):c([])},[l,S]),(0,r.useEffect)(()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[d,p]);let T=e=>{h(t=>t.filter((t,s)=>s!==e))},P=e=>{v(e),k({}),f(!1),m("使用模板：".concat(e.name,"\n").concat(e.description))},D=(0,r.useCallback)(async()=>{if(!u.trim()&&0===g.length||p)return;let e=l;if(!e)try{let t=await fetch("/api/admin/chat/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"SEO 对话"})}),s=await t.json();if(s.success)e=s.data.id,o(e),await C();else throw Error("创建会话失败")}catch(e){console.error("创建会话失败:",e),null==t||t("error","创建会话失败");return}let s={id:Date.now().toString(),role:"user",content:u.trim(),images:g.length>0?[...g]:void 0};c(e=>[...e,s]);let a=u.trim();m(""),h([]),x(!0);let r=(Date.now()+1).toString(),n={id:r,role:"assistant",content:""};c(e=>[...e,n]);try{var i;let s=await fetch("/api/admin/seo-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:e,message:a,images:g,stream:!0,saveHistory:!0,useTemplate:!!b,templateId:null==b?void 0:b.id,templateParams:j})});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"HTTP ".concat(s.status))}let n=null===(i=s.body)||void 0===i?void 0:i.getReader();if(!n)throw Error("无法读取流式响应");let l=new TextDecoder,o="",d="",u=null,m=null;for(;;){let{done:e,value:t}=await n.read();if(e)break;let s=(o+=l.decode(t,{stream:!0})).split("\n");for(let e of(o=s.pop()||"",s)){let t=e.trim();if(t&&"data: [DONE]"!==t&&t.startsWith("data: "))try{let e=JSON.parse(t.slice(6));if(e.model&&!u&&(u=e.model),e.taskType&&!m&&(m=e.taskType),e.choices&&e.choices.length>0){let t=e.choices[0].delta;(null==t?void 0:t.content)&&(d+=t.content,c(e=>{let t=[...e],s=t.length-1;return s>=0&&t[s].id===r&&(t[s]={...t[s],content:d,model:u||void 0,taskType:m||void 0}),t}))}}catch(e){console.warn("解析流式响应失败:",t,e)}}}e&&await S(e),null==t||t("success","消息已发送")}catch(s){console.error("发送消息失败:",s);let e=s instanceof Error?s.message:"请求失败";c(t=>{let s=[...t],a=s.length-1;return a>=0&&s[a].id===r&&(s[a]={...s[a],content:"错误: ".concat(e)}),s}),null==t||t("error",e)}finally{x(!1)}},[u,g,p,l,S,t,b,j]),A={"use-case":"使用场景",keyword:"关键词",blog:"博客文章",compare:"对比页面",industry:"行业页面",general:"一般对话"};return(0,a.jsxs)("div",{className:"flex h-[calc(100vh-200px)] gap-4",children:[(0,a.jsxs)("div",{className:"w-64 shrink-0 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,a.jsx)(i.zx,{onClick:I,className:"w-full",size:"sm",children:"+ 新 SEO 对话"})}),(0,a.jsx)("div",{className:"overflow-y-auto h-[calc(100%-80px)]",children:s.map(e=>(0,a.jsx)("div",{className:"p-3 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 ".concat(l===e.id?"bg-energy-water-surface dark:bg-energy-water-muted":""),onClick:()=>o(e.id),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(e.updated_at).toLocaleDateString()})]}),(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),E(e.id)},className:"ml-2 text-gray-400 hover:text-red-500",children:"\xd7"})]})},e.id))})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col bg-white dark:bg-gray-900",children:[y&&(0,a.jsxs)(i.Zb,{className:"m-4 mb-0",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm",children:"选择 SEO 模板"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:ew.Le.map(e=>(0,a.jsx)(i.zx,{variant:(null==b?void 0:b.id)===e.id?"primary":"outline",onClick:()=>P(e),className:"text-left h-auto p-3",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]})},e.id))})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:0===d.length?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"mb-2 text-2xl font-semibold text-gray-900 dark:text-white",children:"SEO 内容生成助手"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"专门为 SEO 场景优化的 AI 助手，支持使用场景、关键词、博客文章等内容的生成"}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)(i.zx,{onClick:()=>f(!y),children:"\uD83D\uDCDD 选择 SEO 模板"})})]})}):(0,a.jsxs)("div",{className:"space-y-6 max-w-4xl mx-auto",children:[d.map(e=>(0,a.jsxs)("div",{className:"flex gap-4 ".concat("user"===e.role?"justify-end":"justify-start"),children:["assistant"===e.role&&(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-energy-water text-white",children:"SEO"}),(0,a.jsxs)("div",{className:"group relative max-w-[80%] rounded-2xl px-4 py-3 ".concat("user"===e.role?"bg-energy-water text-white":"bg-gray-100 text-gray-900 shadow-sm dark:bg-gray-800 dark:text-gray-100"),children:[e.images&&e.images.length>0&&(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:e.images.map((e,t)=>(0,a.jsx)("img",{src:e,alt:"Uploaded ".concat(t+1),className:"max-w-xs rounded-lg"},t))}),e.model&&"assistant"===e.role&&(0,a.jsxs)("div",{className:"mb-2 flex flex-wrap gap-2 items-center",children:[e.taskType&&(0,a.jsx)(i.Ct,{variant:"secondary",className:"text-xs",children:A[e.taskType]||e.taskType}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"text-xs",children:e.model}),(0,a.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:function(e,t){let s=t?" (".concat(t,")"):"";switch(e){case"gemini-2-flash":return"快速响应，成本最低，适合批量 SEO 内容生成".concat(s);case"gemini-3-flash":return"支持联网搜索，适合复杂 SEO 策略和内容规划".concat(s);case"gemini-3-pro":return"最高质量，适合 Pillar Page、内容策略等复杂 SEO 任务".concat(s);default:return"未知模型"}}(e.model,e.taskType)})]}),(0,a.jsx)("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:e.content||"..."}),"assistant"===e.role&&e.content&&(0,a.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(e.content),null==t||t("success","已复制到剪贴板")},className:"absolute right-2 top-2 opacity-0 transition-opacity group-hover:opacity-100",title:"复制",children:(0,a.jsx)("svg",{className:"h-4 w-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})})]}),"user"===e.role&&(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gray-300 text-gray-700 dark:bg-gray-700 dark:text-gray-200",children:"你"})]},e.id)),p&&(0,a.jsxs)("div",{className:"flex gap-4 justify-start",children:[(0,a.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-energy-water text-white",children:"SEO"}),(0,a.jsx)("div",{className:"rounded-2xl bg-gray-100 px-4 py-3 shadow-sm dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.3s]"}),(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400 [animation-delay:-0.15s]"}),(0,a.jsx)("div",{className:"h-2 w-2 animate-bounce rounded-full bg-gray-400"})]})})]}),(0,a.jsx)("div",{ref:w})]})}),(0,a.jsxs)("div",{className:"border-t border-gray-200 bg-white px-4 py-4 dark:border-gray-800 dark:bg-gray-900",children:[b&&(0,a.jsxs)(i.Zb,{className:"mb-4",children:[(0,a.jsx)(i.Ol,{className:"pb-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(i.ll,{className:"text-sm",children:["模板参数：",b.name]}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>{v(null),k({})},children:"\xd7"})]})}),(0,a.jsx)(i.aY,{className:"space-y-2",children:b.parameters.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"text-xs text-gray-600 dark:text-gray-400",children:[e.label," ",e.required&&"*"]}),(0,a.jsx)(i.II,{placeholder:e.placeholder,value:j[e.key]||"",onChange:t=>k(s=>({...s,[e.key]:t.target.value}))})]},e.key))})]}),g.length>0&&(0,a.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:g.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"h-20 w-20 rounded-lg object-cover"}),(0,a.jsx)("button",{onClick:()=>T(t),className:"absolute -right-2 -top-2 rounded-full bg-red-500 text-white p-1 text-xs",children:"\xd7"})]},t))}),(0,a.jsxs)("div",{className:"flex items-end gap-2",children:[(0,a.jsx)("input",{ref:_,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let t=e.target.files;if(!t)return;let s=[],a=Array.from(t);a.forEach(e=>{if(e.type.startsWith("image/")){let t=new FileReader;t.onload=e=>{var t;let r=null===(t=e.target)||void 0===t?void 0:t.result;s.push(r),s.length===a.length&&h(e=>[...e,...s])},t.readAsDataURL(e)}})},className:"hidden"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>f(!y),disabled:p,children:"\uD83D\uDCDD"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:()=>{var e;return null===(e=_.current)||void 0===e?void 0:e.click()},disabled:p,children:"\uD83D\uDCF7"}),(0,a.jsx)("div",{className:"flex-1 rounded-lg border border-gray-300 bg-white shadow-sm dark:border-gray-600 dark:bg-gray-800",children:(0,a.jsx)("textarea",{ref:N,value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),D())},placeholder:"输入 SEO 内容生成需求... (Cmd/Ctrl + Enter 发送)",className:"w-full resize-none border-0 bg-transparent px-4 py-3 text-sm text-gray-900 placeholder-gray-500 focus:outline-none dark:text-gray-100 dark:placeholder-gray-400",rows:1,style:{minHeight:"52px",maxHeight:"200px"},onInput:e=>{let t=e.target;t.style.height="auto",t.style.height="".concat(Math.min(t.scrollHeight,200),"px")}})}),(0,a.jsx)(i.zx,{onClick:D,disabled:!u.trim()&&0===g.length||p,className:"h-12 px-6",children:p?(0,a.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):"发送"}),d.length>0&&(0,a.jsx)(i.zx,{variant:"ghost",onClick:()=>{m(""),h([]),v(null),k({})},disabled:p,className:"h-12",children:"清空"})]}),(0,a.jsx)("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"按 Cmd/Ctrl + Enter 发送，Shift + Enter 换行。支持 SEO 模板和图片分析。"})]})]})]})}function eS(e){var t,s,n,l,o,d,c,u;let{onShowBanner:m}=e,[g,h]=(0,r.useState)(!1),[p,x]=(0,r.useState)(null),[y,f]=(0,r.useState)(null),b=async()=>{h(!0),x(null),f(null);try{let e=await fetch("/api/admin/chat/debug"),t=await e.json();x(t),t.success?null==m||m("success","诊断完成"):null==m||m("error",t.error||"诊断失败")}catch(e){console.error("诊断失败:",e),null==m||m("error","诊断请求失败")}finally{h(!1)}},v=async()=>{h(!0),f(null);try{let e=await fetch("/api/admin/chat/debug",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({testMessage:"Hello, this is a test message from debug tool"})}),t=await e.json();f(t),t.success?null==m||m("success","测试完成"):null==m||m("error",t.error||"测试失败")}catch(e){console.error("测试失败:",e),null==m||m("error","测试请求失败")}finally{h(!1)}},j=e=>{navigator.clipboard.writeText(e),null==m||m("success","已复制到剪贴板")};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"聊天功能调试工具"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"检查聊天功能的各个环节是否正常工作"})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(i.zx,{onClick:b,disabled:g,children:g?"检查中...":"\uD83D\uDD0D 运行诊断"}),(0,a.jsx)(i.zx,{onClick:v,disabled:g,variant:"outline",children:g?"测试中...":"\uD83E\uDDEA 运行测试"})]}),p&&(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"诊断结果"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[p.summary&&(0,a.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4 dark:bg-gray-800",children:[(0,a.jsx)("h3",{className:"mb-2 font-semibold",children:"检查摘要"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:["认证: ",p.summary.auth]}),(0,a.jsxs)("div",{children:["数据库: ",p.summary.database]}),(0,a.jsxs)("div",{children:["Gemini API: ",p.summary.geminiApi]}),(0,a.jsxs)("div",{children:["环境变量: ",p.summary.environment]})]})]}),(null===(t=p.debug)||void 0===t?void 0:t.checks)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"详细检查"}),p.debug.checks.auth&&(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsx)("div",{className:"mb-1 font-medium",children:"1. 管理员认证"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:p.debug.checks.auth.success?(0,a.jsxs)("span",{className:"text-green-600",children:["✅ 成功 - 管理员ID: ",p.debug.checks.auth.adminId]}):(0,a.jsx)("span",{className:"text-red-600",children:"❌ 失败 - 未授权"})})]}),p.debug.checks.database&&(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsx)("div",{className:"mb-1 font-medium",children:"2. 数据库连接"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{children:["会话表: ",(null===(s=p.debug.checks.database.sessionsTable)||void 0===s?void 0:s.exists)?(0,a.jsx)("span",{className:"text-green-600",children:"✅ 存在"}):(0,a.jsxs)("span",{className:"text-red-600",children:["❌ 不存在 - ",null===(n=p.debug.checks.database.sessionsTable)||void 0===n?void 0:n.error]})]}),(0,a.jsxs)("div",{children:["消息表: ",(null===(l=p.debug.checks.database.messagesTable)||void 0===l?void 0:l.exists)?(0,a.jsx)("span",{className:"text-green-600",children:"✅ 存在"}):(0,a.jsxs)("span",{className:"text-red-600",children:["❌ 不存在 - ",null===(o=p.debug.checks.database.messagesTable)||void 0===o?void 0:o.error]})]}),p.debug.checks.database.userSessions&&(0,a.jsxs)("div",{children:["你的会话数: ",p.debug.checks.database.userSessions.count," 个"]})]})]}),p.debug.checks.geminiApi&&(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsx)("div",{className:"mb-1 font-medium",children:"3. Gemini API 配置"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{children:["API Key: ",(null===(d=p.debug.checks.geminiApi.apiKey)||void 0===d?void 0:d.exists)?(0,a.jsxs)("span",{className:"text-green-600",children:["✅ 已配置 (长度: ",null===(c=p.debug.checks.geminiApi.apiKey)||void 0===c?void 0:c.length,")"]}):(0,a.jsx)("span",{className:"text-red-600",children:"❌ 未配置"})]}),(0,a.jsxs)("div",{children:["Chat Host: ",p.debug.checks.geminiApi.chatHost]}),p.debug.checks.geminiApi.testCall&&(0,a.jsxs)("div",{children:["连接测试: ",p.debug.checks.geminiApi.testCall.success?(0,a.jsxs)("span",{className:"text-green-600",children:["✅ 成功 (状态: ",p.debug.checks.geminiApi.testCall.status,")"]}):(0,a.jsxs)("span",{className:"text-red-600",children:["❌ 失败 - ",p.debug.checks.geminiApi.testCall.error]})]})]})]}),p.debug.checks.environment&&(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsx)("div",{className:"mb-1 font-medium",children:"4. 环境变量"}),(0,a.jsx)("div",{className:"space-y-1 text-sm",children:Object.entries(p.debug.checks.environment).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{children:[t,": ",s?(0,a.jsx)("span",{className:"text-green-600",children:"✅ 已设置"}):(0,a.jsx)("span",{className:"text-red-600",children:"❌ 未设置"})]},t)})})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>j(JSON.stringify(p,null,2)),children:"\uD83D\uDCCB 复制完整诊断信息"})})]})})]}),y&&(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"测试结果"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[y.summary&&(0,a.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4 dark:bg-gray-800",children:[(0,a.jsx)("h3",{className:"mb-2 font-semibold",children:"测试摘要"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,a.jsxs)("div",{children:["创建会话: ",y.summary.createSession]}),(0,a.jsxs)("div",{children:["聊天 API: ",y.summary.chatApi]}),(0,a.jsxs)("div",{children:["保存消息: ",y.summary.saveMessages]})]})]}),(null===(u=y.debug)||void 0===u?void 0:u.steps)&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"测试步骤"}),Object.entries(y.debug.steps).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsxs)("div",{className:"mb-1 font-medium",children:["createSession"===t&&"步骤 1: 创建会话","chatApi"===t&&"步骤 2: 调用聊天 API","saveMessages"===t&&"步骤 3: 保存消息"]}),(0,a.jsxs)("div",{className:"text-sm",children:[s.success?(0,a.jsx)("span",{className:"text-green-600",children:"✅ 成功"}):(0,a.jsxs)("span",{className:"text-red-600",children:["❌ 失败 - ",s.error]}),void 0!==s.messageCount&&(0,a.jsxs)("div",{className:"mt-1 text-gray-600 dark:text-gray-400",children:["消息数量: ",s.messageCount]})]})]},t)})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>j(JSON.stringify(y,null,2)),children:"\uD83D\uDCCB 复制完整测试信息"})})]})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"浏览器 Console 调试代码"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"在浏览器 Console 中运行以下代码来调试聊天功能："}),(0,a.jsx)("div",{className:"rounded-lg bg-gray-900 p-4 text-sm text-gray-100",children:(0,a.jsx)("pre",{className:"whitespace-pre-wrap",children:"// 1. 检查当前会话\nasync function checkSessions() {\n  const res = await fetch('/api/admin/chat/sessions');\n  const data = await res.json();\n  console.log('会话列表:', data);\n  return data;\n}\n\n// 2. 测试发送消息\nasync function testSendMessage(sessionId) {\n  const res = await fetch('/api/admin/chat', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      sessionId: sessionId || null,\n      message: '测试消息',\n      stream: false,\n      saveHistory: true,\n    }),\n  });\n  const data = await res.json();\n  console.log('发送消息结果:', data);\n  return data;\n}\n\n// 3. 运行完整诊断\nasync function runDiagnostics() {\n  const res = await fetch('/api/admin/chat/debug');\n  const data = await res.json();\n  console.log('诊断结果:', data);\n  return data;\n}\n\n// 4. 运行完整测试\nasync function runTest() {\n  const res = await fetch('/api/admin/chat/debug', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ testMessage: '测试消息' }),\n  });\n  const data = await res.json();\n  console.log('测试结果:', data);\n  return data;\n}\n\n// 使用示例：\n// checkSessions();\n// testSendMessage('your-session-id');\n// runDiagnostics();\n// runTest();"})}),(0,a.jsx)(i.zx,{variant:"outline",size:"sm",onClick:()=>j("// 1. 检查当前会话\nasync function checkSessions() {\n  const res = await fetch('/api/admin/chat/sessions');\n  const data = await res.json();\n  console.log('会话列表:', data);\n  return data;\n}\n\n// 2. 测试发送消息\nasync function testSendMessage(sessionId) {\n  const res = await fetch('/api/admin/chat', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({\n      sessionId: sessionId || null,\n      message: '测试消息',\n      stream: false,\n      saveHistory: true,\n    }),\n  });\n  const data = await res.json();\n  console.log('发送消息结果:', data);\n  return data;\n}\n\n// 3. 运行完整诊断\nasync function runDiagnostics() {\n  const res = await fetch('/api/admin/chat/debug');\n  const data = await res.json();\n  console.log('诊断结果:', data);\n  return data;\n}\n\n// 4. 运行完整测试\nasync function runTest() {\n  const res = await fetch('/api/admin/chat/debug', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ testMessage: '测试消息' }),\n  });\n  const data = await res.json();\n  console.log('测试结果:', data);\n  return data;\n}\n\n// 使用示例：\n// checkSessions();\n// testSendMessage('your-session-id');\n// runDiagnostics();\n// runTest();"),children:"\uD83D\uDCCB 复制 Console 代码"})]})})]})]})}let eI=[{value:"advertising-promotion",label:"Marketing / Ads",description:"广告转化、获客、投放 - 适合电商、SaaS、本地服务",icon:"\uD83C\uDFAF",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-2.5-flash"},{value:"social-media-content",label:"Social Media Shorts",description:"曝光、增长、涨粉 - 适合创作者、品牌、娱乐",icon:"\uD83D\uDCF1",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-2.5-flash"},{value:"product-demo-showcase",label:"Product Demo",description:"解释复杂产品 - 适合SaaS、工具类、AI产品",icon:"\uD83D\uDCBC",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-3-flash"},{value:"education-explainer",label:"Education",description:"教学、培训 - 适合在线教育、企业培训",icon:"\uD83D\uDCDA",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-2.5-flash"},{value:"brand-storytelling",label:"Branding",description:"品牌形象 - 适合中大型企业、消费品牌",icon:"✨",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-2.5-flash"},{value:"ugc-creator-content",label:"Local / Lead Gen",description:"到店/咨询 - 适合餐饮、牙科、房产、健身房",icon:"\uD83D\uDCCD",defaultModel:"gemini-2.5-flash",recommendedModel:"gemini-3-flash"}],eE=[{value:"gemini-2.5-flash",label:"gemini-2.5-flash（热门行业）",cost:"低"},{value:"gemini-3-flash",label:"gemini-3-flash（冷门专业）",cost:"中"},{value:"gemini-3-pro",label:"gemini-3-pro（终极卡点）",cost:"高"}];function eT(e){let{onShowBanner:t}=e,[s,n]=(0,r.useState)([]),[l,d]=(0,r.useState)(null),[c,u]=(0,r.useState)({use_case_type:"",default_model:"gemini-2.5-flash",fallback_model:"",ultimate_model:"",hot_industry_model:"",cold_industry_model:"",professional_industry_model:"",is_enabled:!0,notes:""}),m=(0,o.createClient)(),g=(0,r.useCallback)(async()=>{try{let{data:t,error:s}=await m.from("scene_model_configs").select("*").order("use_case_type",{ascending:!0});if(s){var e;if("PGRST116"===s.code||(null===(e=s.message)||void 0===e?void 0:e.includes("does not exist"))){n([]);return}throw s}n(t||[])}catch(e){console.error("获取配置失败:",e),t("error","获取配置失败: ".concat(e instanceof Error?e.message:"未知错误"))}},[m,t]);(0,r.useEffect)(()=>{g()},[g]);let h=e=>s.find(t=>t.use_case_type===e)||null,p=async e=>{try{let s=h(e),a={default_model:c.default_model,fallback_model:c.fallback_model||null,ultimate_model:c.ultimate_model||null,hot_industry_model:c.hot_industry_model||null,cold_industry_model:c.cold_industry_model||null,professional_industry_model:c.professional_industry_model||null,is_enabled:c.is_enabled,notes:c.notes||null},{error:r}=s?await m.from("scene_model_configs").update({...a,updated_at:new Date().toISOString()}).eq("use_case_type",e):await m.from("scene_model_configs").insert([{use_case_type:e,...a}]);if(r)throw r;t("success",s?"配置更新成功":"配置创建成功"),d(null),y(),g()}catch(e){console.error("保存配置失败:",e),t("error","保存失败: ".concat(e instanceof Error?e.message:"未知错误"))}},x=e=>{let t=h(e);if(d(e),t)u({use_case_type:t.use_case_type,default_model:t.default_model,fallback_model:t.fallback_model||"",ultimate_model:t.ultimate_model||"",hot_industry_model:t.hot_industry_model||"",cold_industry_model:t.cold_industry_model||"",professional_industry_model:t.professional_industry_model||"",is_enabled:t.is_enabled,notes:t.notes||""});else{let t=eI.find(t=>t.value===e);u({use_case_type:e,default_model:(null==t?void 0:t.defaultModel)||"gemini-2.5-flash",fallback_model:"",ultimate_model:"",hot_industry_model:"",cold_industry_model:"",professional_industry_model:"",is_enabled:!0,notes:""})}},y=()=>{d(null),u({use_case_type:"",default_model:"gemini-2.5-flash",fallback_model:"",ultimate_model:"",hot_industry_model:"",cold_industry_model:"",professional_industry_model:"",is_enabled:!0,notes:""})};return(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(i.Zb,{children:[(0,a.jsxs)(i.Ol,{children:[(0,a.jsx)(i.ll,{children:"场景应用模型配置"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"按场景应用配置模型，系统会自动应用到所有行业。热门行业用2.5-flash，冷门专业用3-flash，终极卡点用3-pro。"})]}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"space-y-4",children:eI.map(e=>{let t=h(e.value),s=l===e.value;return(0,a.jsxs)(i.Zb,{className:"border-2",children:[(0,a.jsx)(i.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-2xl",children:e.icon}),(0,a.jsxs)("div",{children:[(0,a.jsx)(i.ll,{className:"text-lg",children:e.label}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:e.description})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,a.jsx)(i.Ct,{variant:t.is_enabled?"success":"secondary",children:t.is_enabled?"已配置":"已禁用"}),(0,a.jsx)(i.zx,{size:"sm",variant:s?"secondary":"outline",onClick:()=>s?y():x(e.value),children:s?"取消":t?"编辑":"配置"})]})]})}),s&&(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"默认模型 *"}),(0,a.jsx)("select",{value:c.default_model,onChange:e=>u({...c,default_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:eE.map(e=>(0,a.jsxs)("option",{value:e.value,children:[e.label,"（",e.cost,"成本）"]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Fallback模型"}),(0,a.jsxs)("select",{value:c.fallback_model,onChange:e=>u({...c,fallback_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"",children:"无（使用默认策略）"}),eE.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"终极模型"}),(0,a.jsxs)("select",{value:c.ultimate_model,onChange:e=>u({...c,ultimate_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"",children:"无（使用默认策略）"}),eE.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"热门行业模型（可选）"}),(0,a.jsxs)("select",{value:c.hot_industry_model,onChange:e=>u({...c,hot_industry_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"",children:"使用默认模型"}),eE.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"热门行业（E-commerce, SaaS等）优先使用此模型"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"冷门行业模型（可选）"}),(0,a.jsxs)("select",{value:c.cold_industry_model,onChange:e=>u({...c,cold_industry_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"",children:"使用默认模型"}),eE.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"冷门行业优先使用此模型（推荐3-flash）"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"专业行业模型（可选）"}),(0,a.jsxs)("select",{value:c.professional_industry_model,onChange:e=>u({...c,professional_industry_model:e.target.value}),className:"w-full px-3 py-2 border rounded-lg",children:[(0,a.jsx)("option",{value:"",children:"使用默认模型"}),eE.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"专业行业（医疗、法律等）优先使用此模型（推荐3-flash或3-pro）"})]}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.is_enabled,onChange:e=>u({...c,is_enabled:e.target.checked}),className:"rounded"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"启用此配置"})]})}),(0,a.jsx)("div",{className:"md:col-span-2",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.zx,{onClick:()=>p(e.value),children:"保存配置"}),(0,a.jsx)(i.zx,{variant:"outline",onClick:y,children:"取消"})]})})]})}),!s&&t&&(0,a.jsx)(i.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"默认模型："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.default_model.replace("gemini-","")})]}),t.fallback_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Fallback："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.fallback_model.replace("gemini-","")})]}),t.ultimate_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"终极："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.ultimate_model.replace("gemini-","")})]}),t.hot_industry_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"热门行业："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.hot_industry_model.replace("gemini-","")})]}),t.cold_industry_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"冷门行业："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.cold_industry_model.replace("gemini-","")})]}),t.professional_industry_model&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"专业行业："}),(0,a.jsx)(i.Ct,{variant:"secondary",className:"ml-2",children:t.professional_industry_model.replace("gemini-","")})]})]})})]},e.value)})})})]})})}let eP="待处理",eD="处理中",eA="已解决",ez="已关闭",eO=[{value:"open",label:eP},{value:"in_progress",label:eD},{value:"resolved",label:eA},{value:"closed",label:ez}],eL={manual_increase:"手动增加",manual_decrease:"手动扣减",recharge_correction:"充值补发",recharge_refund:"充值退款扣减",consumption_refund:"消费退款",other:"其他"},eR={completed:{label:"已完成",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},pending:{label:"待处理",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"},failed:{label:"失败",className:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"},cancelled:{label:"已取消",className:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"},succeeded:{label:"成功",className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},processing:{label:"处理中",className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},refunded:{label:"已退款",className:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},open:{label:eP,className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"},in_progress:{label:eD,className:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},resolved:{label:eA,className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},closed:{label:ez,className:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};function eB(e){return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function eM(e){return new Intl.NumberFormat("zh-CN",{style:"currency",currency:"USD"}).format(e)}function eF(e){var t;let s=null!==(t=eR[e])&&void 0!==t?t:eR.pending;return(0,a.jsx)(i.Ct,{className:s.className,children:s.label})}function eH(e){let{adminUser:t}=e,s=(0,n.useRouter)(),[d,c]=(0,r.useState)(!0),[u,m]=(0,r.useState)(null),[g,h]=(0,r.useState)(null),[p,x]=(0,r.useState)([]),[y,f]=(0,r.useState)([]),[b,v]=(0,r.useState)([]),[j,k]=(0,r.useState)([]),[w,N]=(0,r.useState)({}),[_,C]=(0,r.useState)([]),S=(0,n.useSearchParams)(),I=(null==S?void 0:S.get("tab"))||"overview",[T,P]=(0,r.useState)(I||"overview");(0,r.useEffect)(()=>{I&&I!==T&&(console.log("从 URL 更新 activeTab:",I),P(I))},[I]),(0,r.useEffect)(()=>{console.log("activeTab 已更新为:",T)},[T]);let[D,A]=(0,r.useState)(!1),[z,O]=(0,r.useState)(!0),[L,R]=(0,r.useState)(!0),[B,M]=(0,r.useState)({}),[F,q]=(0,r.useState)(null),[U,W]=(0,r.useState)(null),[Y,J]=(0,r.useState)(null),[$,Z]=(0,r.useState)(null),[K,Q]=(0,r.useState)(null),[X,ee]=(0,r.useState)(!1),[et,es]=(0,r.useState)(null),ea=(0,r.useRef)(null),[er,en]=(0,r.useState)({identifierType:"email",identifier:"",amount:"",adjustmentType:"manual_increase",reason:"",relatedRechargeId:"",relatedConsumptionId:""}),ei=(0,r.useMemo)(()=>{try{return(0,o.createClient)()}catch(e){return console.error("[AdminClient] 创建 Supabase 客户端失败:",e),null}},[]),el=(0,r.useCallback)((e,t)=>{es({type:e,text:t}),ea.current&&clearTimeout(ea.current),ea.current=setTimeout(()=>{es(null),ea.current=null},4e3)},[]),eo=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&c(!0);let t=async(e,t)=>{try{let s=await e.json();if(!e.ok){let e=["string"==typeof(null==s?void 0:s.error)?s.error:"","string"==typeof(null==s?void 0:s.details)?s.details:""].map(e=>e.trim()).filter(Boolean),a=e.length>0?e.join("："):t;return el("error",a),null}return s}catch(e){return console.error(t,e),el("error",t),null}};try{let[e,s,a,r,n]=await Promise.all([fetch("/api/admin/stats"),fetch("/api/admin/recharges"),fetch("/api/admin/consumption"),fetch("/api/admin/videos"),fetch("/api/admin/use-cases?limit=0&offset=0")]),i=await t(e,"获取统计数据失败，请稍后再试");(null==i?void 0:i.success)&&m(i.stats);let l=await t(s,"获取充值记录失败，请稍后再试");(null==l?void 0:l.success)&&x(l.records||[]);let o=await t(a,"获取消耗记录失败，请稍后再试");(null==o?void 0:o.success)&&f(o.records||[]);let d=await t(r,"获取视频任务失败，请稍后再试");(null==d?void 0:d.success)&&v(d.tasks||[]);let c=await t(n,"获取场景应用统计失败，请稍后再试");if(null==c?void 0:c.success)try{let[e,t,s,a]=await Promise.all([fetch("/api/admin/use-cases?limit=0&offset=0&status=published"),fetch("/api/admin/use-cases?limit=0&offset=0&status=draft"),fetch("/api/admin/use-cases?limit=0&offset=0&quality_status=approved"),fetch("/api/admin/use-cases?limit=0&offset=0&quality_status=pending")]),r=await e.json().catch(()=>({count:0})),n=await t.json().catch(()=>({count:0})),i=await s.json().catch(()=>({count:0})),l=await a.json().catch(()=>({count:0}));h({total:c.count||0,published:r.count||0,draft:n.count||0,approved:i.count||0,pending:l.count||0})}catch(e){console.error("获取场景应用详细统计失败:",e),h({total:c.count||0,published:0,draft:0,approved:0,pending:0})}}catch(e){console.error("获取数据失败:",e),el("error","获取统计数据失败，请稍后再试")}finally{c(!1)}},[el]),ed=(0,r.useCallback)(async()=>{O(!0);try{var e,t,s;let a=await fetch("/api/admin/issues");if(!a.ok){let t=await a.json().catch(()=>({}));throw Error(null!==(e=t.error)&&void 0!==e?e:"获取售后列表失败")}let r=await a.json();k(null!==(t=r.issues)&&void 0!==t?t:[]),N(null!==(s=r.statusCounts)&&void 0!==s?s:{})}catch(e){console.error("获取售后反馈失败:",e),el("error",e instanceof Error?e.message:"获取售后反馈失败")}finally{O(!1)}},[el]),ec=(0,r.useCallback)(async()=>{R(!0);try{var e,t;let s=await fetch("/api/admin/credits");if(!s.ok){let t=await s.json().catch(()=>({}));throw Error(null!==(e=t.error)&&void 0!==e?e:"获取积分调整记录失败")}let a=await s.json();C(null!==(t=a.adjustments)&&void 0!==t?t:[])}catch(e){console.error("获取积分调整记录失败:",e),el("error",e instanceof Error?e.message:"获取积分调整记录失败")}finally{R(!1)}},[el]);(0,r.useEffect)(()=>{eo(!0),ed(),ec();let e=null;return D&&(e=setInterval(()=>{eo(),ed(),ec()},1e4)),()=>{e&&clearInterval(e)}},[D,eo,ed,ec]),(0,r.useEffect)(()=>{let e=null,t=!1,s=async()=>{if(!t)try{let s=await fetch("/api/auth/admin-refresh-session",{method:"POST"});if(s.ok)console.log("[AdminClient] 管理员会话已刷新");else{let a=s.status,r=await s.json().catch(()=>({}));if(401===a||"SESSION_EXPIRED"===r.code){console.warn("[AdminClient] 会话已过期，停止自动刷新并跳转到登录页"),t=!0,e&&clearInterval(e),document.cookie="admin_session_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/",window.location.href="/admin/login";return}500===a?console.error("[AdminClient] 会话刷新失败（服务器错误）:",r.error||r.details):console.warn("[AdminClient] 会话刷新失败:",a,r.error||"未知错误")}}catch(e){console.warn("[AdminClient] 会话刷新请求失败:",e)}},a=setTimeout(()=>{s()},5e3);return e=setInterval(s,18e5),()=>{t=!0,clearTimeout(a),e&&clearInterval(e)}},[]),(0,r.useEffect)(()=>{if(!ei)return;let e=ei.channel("admin-dashboard").on("postgres_changes",{event:"*",schema:"public",table:"recharge_records"},()=>{eo(),ec()}).on("postgres_changes",{event:"*",schema:"public",table:"consumption_records"},()=>{eo(),ec()}).on("postgres_changes",{event:"*",schema:"public",table:"credit_adjustments"},ec).on("postgres_changes",{event:"*",schema:"public",table:"after_sales_issues"},ed);return e.subscribe(e=>{"CHANNEL_ERROR"===e&&console.warn("订阅实时更新失败（不影响功能，将使用轮询方式更新）")}),()=>{ei&&ei.removeChannel(e)}},[ei,eo,ed,ec]),(0,r.useEffect)(()=>()=>{ea.current&&clearTimeout(ea.current)},[]),(0,r.useEffect)(()=>{M(e=>{let t={...e};return j.forEach(s=>{if(void 0===e[s.id]){var a;t[s.id]=null!==(a=s.admin_notes)&&void 0!==a?a:""}}),t})},[j]);let eu=(0,r.useCallback)(async(e,t)=>{q(e);try{let a=await fetch("/api/admin/issues/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})}),r=await a.json().catch(()=>({}));if(!a.ok){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"更新售后状态失败")}await ed(),el("success","售后状态已更新")}catch(e){console.error("更新售后问题失败:",e),el("error",e instanceof Error?e.message:"更新售后问题失败")}finally{q(null)}},[ed,el]),em=(0,r.useCallback)(async e=>{q(e);try{var t,s;let a=await fetch("/api/admin/issues/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminNotes:null!==(t=B[e])&&void 0!==t?t:""})}),r=await a.json().catch(()=>({}));if(!a.ok)throw Error(null!==(s=r.error)&&void 0!==s?s:"保存备注失败");await ed(),el("success","备注已保存")}catch(e){console.error("保存售后备注失败:",e),el("error",e instanceof Error?e.message:"保存售后备注失败")}finally{q(null)}},[ed,B,el]),eg=(0,r.useCallback)(async(e,t)=>{W(e);try{let a=await fetch("/api/admin/recharges/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json().catch(()=>({}));if(!a.ok){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"更新充值记录失败")}let n=r.recharge,i=r.adjustment;n&&x(t=>t.map(t=>t.id===e?{...t,...n,user_email:t.user_email,user_name:t.user_name}:t)),i&&ec(),eo(),el("success","充值记录已更新")}catch(e){console.error("更新充值记录失败:",e),el("error",e instanceof Error?e.message:"更新充值记录失败")}finally{W(null)}},[ec,eo,el]),eh=(0,r.useCallback)(async(e,t)=>{await eg(e,{status:t})},[eg]),ep=(0,r.useCallback)(async e=>{var t;let s=window.prompt("请输入管理员备注（留空清除）",null!==(t=e.admin_notes)&&void 0!==t?t:"");null!==s&&await eg(e.id,{adminNotes:""===s.trim()?null:s})},[eg]),ex=(0,r.useCallback)(async e=>{J(e);try{let s=await fetch("/api/admin/consumption/".concat(e,"/refund"),{method:"POST"}),a=await s.json().catch(()=>({}));if(!s.ok){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"退款失败")}let r=a.consumption;r&&f(t=>t.map(t=>t.id===e?{...t,...r,user_email:t.user_email,user_name:t.user_name}:t)),ec(),eo(),el("success","积分已返还给用户")}catch(e){console.error("退款失败:",e),el("error",e instanceof Error?e.message:"退款失败，请检查是否已经退款")}finally{J(null)}},[ec,eo,el]),ey=(0,r.useCallback)(async(e,t)=>{J(e);try{let a=await fetch("/api/admin/consumption/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json().catch(()=>({}));if(!a.ok||!r.success){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"更新失败")}let n=r.consumption;n&&f(t=>t.map(t=>t.id===e?{...t,...n,user_email:t.user_email,user_name:t.user_name}:t)),eo(),el("success","消耗记录已更新")}catch(e){console.error("更新消耗记录失败:",e),el("error",e instanceof Error?e.message:"更新消耗记录失败")}finally{J(null)}},[eo,el]),eb=(0,r.useCallback)(async e=>{if(window.confirm("确定要删除这条充值记录吗？此操作不可恢复。")){W(e);try{let s=await fetch("/api/admin/recharges/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok||!a.success){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"删除失败")}x(t=>t.filter(t=>t.id!==e)),eo(),el("success","充值记录已删除")}catch(e){console.error("删除充值记录失败:",e),el("error",e instanceof Error?e.message:"删除充值记录失败")}finally{W(null)}}},[eo,el]),ev=(0,r.useCallback)(async e=>{if(window.confirm("确定要删除这条消耗记录吗？此操作不可恢复。")){J(e);try{let s=await fetch("/api/admin/consumption/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok||!a.success){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"删除失败")}f(t=>t.filter(t=>t.id!==e)),eo(),el("success","消耗记录已删除")}catch(e){console.error("删除消耗记录失败:",e),el("error",e instanceof Error?e.message:"删除消耗记录失败")}finally{J(null)}}},[eo,el]),ej=(0,r.useCallback)(async(e,t)=>{Z(e);try{let a=await fetch("/api/admin/videos/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json().catch(()=>({}));if(!a.ok||!r.success){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"更新失败")}let n=r.task;n&&v(t=>t.map(t=>t.id===e?{...t,...n,user_email:t.user_email,user_name:t.user_name}:t)),eo(),el("success","视频任务已更新")}catch(e){console.error("更新视频任务失败:",e),el("error",e instanceof Error?e.message:"更新视频任务失败")}finally{Z(null)}},[eo,el]),ew=(0,r.useCallback)(async e=>{if(window.confirm("确定要删除这个视频任务吗？此操作不可恢复。")){Z(e);try{let s=await fetch("/api/admin/videos/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok||!a.success){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"删除失败")}v(t=>t.filter(t=>t.id!==e)),eo(),el("success","视频任务已删除")}catch(e){console.error("删除视频任务失败:",e),el("error",e instanceof Error?e.message:"删除视频任务失败")}finally{Z(null)}}},[eo,el]),eI=(0,r.useCallback)(async e=>{if(window.confirm("确定要删除这个售后反馈吗？此操作不可恢复。")){q(e);try{let s=await fetch("/api/admin/issues/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok||!a.success){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"删除失败")}k(t=>t.filter(t=>t.id!==e)),ed(),el("success","售后反馈已删除")}catch(e){console.error("删除售后反馈失败:",e),el("error",e instanceof Error?e.message:"删除售后反馈失败")}finally{q(null)}}},[ed,el]),eE=(0,r.useCallback)(async(e,t)=>{Q(e);try{let a=await fetch("/api/admin/credits/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json().catch(()=>({}));if(!a.ok||!r.success){var s;throw Error(null!==(s=r.error)&&void 0!==s?s:"更新失败")}ec(),el("success","积分调整记录已更新")}catch(e){console.error("更新积分调整记录失败:",e),el("error",e instanceof Error?e.message:"更新积分调整记录失败")}finally{Q(null)}},[ec,el]),eP=(0,r.useCallback)(async e=>{if(window.confirm("确定要删除这条积分调整记录吗？此操作不可恢复。注意：删除记录不会自动恢复用户积分。")){Q(e);try{let s=await fetch("/api/admin/credits/".concat(e),{method:"DELETE"}),a=await s.json().catch(()=>({}));if(!s.ok||!a.success){var t;throw Error(null!==(t=a.error)&&void 0!==t?t:"删除失败")}C(t=>t.filter(t=>t.id!==e)),ec(),el("success","积分调整记录已删除")}catch(e){console.error("删除积分调整记录失败:",e),el("error",e instanceof Error?e.message:"删除积分调整记录失败")}finally{Q(null)}}},[ec,el]),eD=(0,r.useCallback)(async e=>{if(e.preventDefault(),!er.identifier.trim()){el("error","请填写用户标识信息");return}if(!er.amount.trim()){el("error","请填写调整积分数量");return}let t=Number(er.amount);if(!Number.isFinite(t)){el("error","积分数量必须是数字");return}let s=Math.trunc(t);if(0===s){el("error","积分数量不能为0");return}let a=s;["manual_increase","recharge_correction","consumption_refund"].includes(er.adjustmentType)?a=Math.abs(s):["manual_decrease","recharge_refund"].includes(er.adjustmentType)&&(a=-Math.abs(s)),ee(!0);try{let e={delta:a,adjustmentType:er.adjustmentType,reason:er.reason.trim()||null};"email"===er.identifierType?e.userEmail=er.identifier.trim():e.userId=er.identifier.trim(),er.relatedRechargeId.trim()&&(e.relatedRechargeId=er.relatedRechargeId.trim()),er.relatedConsumptionId.trim()&&(e.relatedConsumptionId=er.relatedConsumptionId.trim());let t=await fetch("/api/admin/credits",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json().catch(()=>({}));if(!t.ok){let e=["string"==typeof s.error?s.error:"","string"==typeof s.details?s.details:""].map(e=>e.trim()).filter(Boolean).join("：");throw Error(e||"积分调整失败")}el("success","积分调整已完成"),en(e=>({...e,amount:"",reason:"",relatedRechargeId:"",relatedConsumptionId:""})),ec(),eo()}catch(e){console.error("积分调整失败:",e),el("error",e instanceof Error?e.message:"积分调整失败，请稍后重试")}finally{ee(!1)}},[er,ec,eo,el]);return(0,a.jsxs)("div",{className:"min-h-screen bg-energy-hero dark:bg-energy-hero-dark",children:[(0,a.jsx)("nav",{className:"border-b border-gray-200 bg-white/80 backdrop-blur-sm dark:border-gray-700 dark:bg-gray-800/80 sticky top-0 z-50",children:(0,a.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"管理员后台"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:[{value:"overview",label:"总览"},{value:"recharges",label:"充值记录"},{value:"consumption",label:"消耗记录"},{value:"videos",label:"视频任务"},{value:"issues",label:"售后反馈"},{value:"adjustments",label:"积分调整"},{value:"prompts",label:"提示词库"},{value:"keywords",label:"长尾词"},{value:"blog",label:"博客文章"},{value:"use-cases",label:"使用场景"},{value:"compare-pages",label:"对比页"},{value:"batch-generator",label:"批量生成"},{value:"seo-chat",label:"SEO 助手"},{value:"admin-chat",label:"AI 助手"},{value:"chat-debug",label:"聊天调试"},{value:"homepage",label:"首页管理"},{value:"scene-config",label:"场景配置"}].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>{console.log("切换标签页:",e.value);let t=e.value;P(t),s.push("/admin?tab=".concat(t),{scroll:!1})},className:"px-3 py-1.5 text-sm font-medium rounded-lg transition-colors ".concat(T===e.value?"bg-energy-water text-white":"text-gray-700 hover:bg-energy-water-surface dark:text-gray-300 dark:hover:bg-gray-700"),children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"hidden sm:flex flex-col items-end text-xs text-gray-500 dark:text-gray-400",children:[(0,a.jsxs)("span",{children:["当前管理员：",t.username]}),t.is_super_admin&&(0,a.jsx)("span",{className:"text-energy-water",children:"超级管理员"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,a.jsx)("input",{type:"checkbox",checked:D,onChange:e=>A(e.target.checked),className:"rounded"}),"自动刷新 (10秒)"]}),(0,a.jsx)(i.zx,{variant:"secondary",size:"sm",onClick:()=>eo(!0),disabled:d,children:d?"刷新中...":"手动刷新"}),(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",onClick:async()=>{try{await fetch("/api/auth/admin-logout",{method:"POST"})}finally{s.push("/admin"),s.refresh()}},children:"退出管理员"}),(0,a.jsx)(l.default,{href:"/",children:(0,a.jsx)(i.zx,{variant:"ghost",size:"sm",children:"返回首页"})})]})]})})}),(0,a.jsxs)("main",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[et&&(0,a.jsx)("div",{className:"mb-6 rounded-lg border px-4 py-3 text-sm ".concat("success"===et.type?"border-green-200 bg-green-50 text-green-700":"info"===et.type?"border-blue-200 bg-blue-50 text-blue-700":"border-red-200 bg-red-50 text-red-700"),children:et.text}),d&&!u?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-energy-water"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"加载中..."})]}):(0,a.jsxs)(a.Fragment,{children:["overview"===T&&u&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"数据总览"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"总用户数"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:u.total_users})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"总积分余额"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-energy-water dark:text-energy-soft",children:u.total_credits.toLocaleString()})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"总充值金额"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:eM(u.total_recharges)})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"总消耗积分"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:u.total_consumption.toLocaleString()})})]})]}),g&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"场景应用"}),(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>{P("use-cases"),s.push("/admin?tab=use-cases")},children:"管理场景应用 →"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"总场景数"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:g.total.toLocaleString()})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"已发布"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:g.published.toLocaleString()})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"已批准"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-energy-water dark:text-energy-soft",children:g.approved.toLocaleString()})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"草稿"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-500 dark:text-gray-400",children:g.draft.toLocaleString()})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"待审核"})}),(0,a.jsx)(i.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:g.pending.toLocaleString()})})]})]})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"最近充值记录"})}),(0,a.jsx)(i.aY,{children:0===p.length?(0,a.jsx)("p",{className:"py-4 text-center text-gray-500 dark:text-gray-400",children:"暂无充值记录"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-2 px-3 text-left",children:"时间"}),(0,a.jsx)("th",{className:"py-2 px-3 text-left",children:"用户"}),(0,a.jsx)("th",{className:"py-2 px-3 text-left",children:"金额"}),(0,a.jsx)("th",{className:"py-2 px-3 text-left",children:"积分"}),(0,a.jsx)("th",{className:"py-2 px-3 text-left",children:"状态"})]})}),(0,a.jsx)("tbody",{children:p.slice(0,10).map(e=>(0,a.jsxs)("tr",{className:"border-b border-gray-100 dark:border-gray-800",children:[(0,a.jsx)("td",{className:"py-2 px-3",children:eB(e.created_at)}),(0,a.jsx)("td",{className:"py-2 px-3",children:e.user_email||e.user_id.substring(0,8)}),(0,a.jsx)("td",{className:"py-2 px-3 font-medium",children:eM(e.amount)}),(0,a.jsxs)("td",{className:"py-2 px-3 text-energy-water dark:text-energy-soft",children:["+",e.credits]}),(0,a.jsx)("td",{className:"py-2 px-3",children:eF(e.status)})]},e.id))})]})})})]})]}),"recharges"===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"充值记录"}),(0,a.jsxs)(i.Ct,{className:"bg-energy-water-surface text-energy-water dark:bg-energy-water-muted dark:text-energy-soft",children:["共 ",p.length," 条"]})]}),(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"pt-6",children:0===p.length?(0,a.jsx)("p",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"暂无充值记录"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"时间"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"用户邮箱"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"金额"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"积分"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"支付方式"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"状态"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"备注"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"操作"})]})}),(0,a.jsx)("tbody",{children:p.map(e=>{var t;let s=U===e.id;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:eB(e.created_at)}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.user_email||"N/A"}),(0,a.jsx)("td",{className:"py-3 px-4 font-medium",children:eM(e.amount)}),(0,a.jsxs)("td",{className:"py-3 px-4 text-energy-water dark:text-energy-soft",children:["+",e.credits]}),(0,a.jsx)("td",{className:"py-3 px-4",children:null!==(t=e.payment_method)&&void 0!==t?t:"N/A"}),(0,a.jsx)("td",{className:"py-3 px-4",children:eF(e.status)}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.admin_notes||"无"})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["pending"===e.status&&(0,a.jsx)(i.zx,{size:"sm",onClick:()=>eh(e.id,"completed"),disabled:s,children:s?"处理中...":"标记完成"}),"completed"===e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>eh(e.id,"refunded"),disabled:s,children:s?"处理中...":"退款扣减"}),"cancelled"!==e.status&&"refunded"!==e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>eh(e.id,"cancelled"),disabled:s,children:s?"处理中...":"取消"}),(0,a.jsx)(i.zx,{size:"sm",variant:"ghost",onClick:()=>ep(e),disabled:s,children:"编辑备注"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>eb(e.id),disabled:s,children:s?"处理中...":"删除"})]})})]},e.id)})})]})})})})]}),"consumption"===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"消耗记录"}),(0,a.jsxs)(i.Ct,{className:"bg-energy-water-surface text-energy-water dark:bg-energy-water-muted dark:text-energy-soft",children:["共 ",y.length," 条"]})]}),(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"pt-6",children:0===y.length?(0,a.jsx)("p",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"暂无消耗记录"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"时间"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"用户邮箱"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"消耗积分"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"描述"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"状态"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"任务ID"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"操作"})]})}),(0,a.jsx)("tbody",{children:y.map(e=>{let t=Y===e.id;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:eB(e.created_at)}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.user_email||"N/A"}),(0,a.jsxs)("td",{className:"py-3 px-4 font-medium text-red-600 dark:text-red-400",children:["-",e.credits]}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.description||"无"}),(0,a.jsx)("td",{className:"py-3 px-4",children:eF(e.status)}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("p",{className:"max-w-[200px] truncate text-xs font-mono text-gray-500 dark:text-gray-400",children:e.video_task_id||"N/A"})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["completed"===e.status?(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>ex(e.id),disabled:t,children:t?"处理中...":"退款返还"}):(0,a.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"已退款"}),(0,a.jsx)(i.zx,{size:"sm",variant:"ghost",onClick:()=>{let t=window.prompt("编辑描述",e.description||"");null!==t&&ey(e.id,{description:t})},disabled:t,children:"编辑"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>ev(e.id),disabled:t,children:t?"处理中...":"删除"})]})})]},e.id)})})]})})})})]}),"videos"===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"视频任务"}),(0,a.jsxs)(i.Ct,{className:"bg-energy-water-surface text-energy-water dark:bg-energy-water-muted dark:text-energy-soft",children:["共 ",b.length," 条"]})]}),(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"pt-6",children:0===b.length?(0,a.jsx)("p",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"暂无视频任务"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"时间"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"用户邮箱"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"提示词"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"状态"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"进度"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"Grsai任务ID"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"操作"})]})}),(0,a.jsx)("tbody",{children:b.map(e=>{let t=$===e.id;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:eB(e.created_at)}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.user_email||"N/A"}),(0,a.jsx)("td",{className:"max-w-xs py-3 px-4 truncate",title:e.prompt,children:e.prompt}),(0,a.jsx)("td",{className:"py-3 px-4",children:eF(e.status)}),(0,a.jsxs)("td",{className:"py-3 px-4",children:[e.progress,"%"]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsx)("p",{className:"max-w-[200px] truncate text-xs font-mono text-gray-500 dark:text-gray-400",children:e.grsai_task_id||"N/A"})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"ghost",onClick:()=>{let t=window.prompt("编辑状态 (pending/processing/succeeded/failed)",e.status);t&&["pending","processing","succeeded","failed"].includes(t)&&ej(e.id,{status:t})},disabled:t,children:"编辑状态"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>ew(e.id),disabled:t,children:t?"处理中...":"删除"})]})})]},e.id)})})]})})})})]}),"issues"===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"售后反馈"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"处理用户充值、退款及其他售后问题，更新状态并记录处理备注。"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:eO.map(e=>{var t;return(0,a.jsxs)(i.Ct,{className:"bg-energy-water-surface text-energy-water dark:bg-energy-water-muted dark:text-energy-soft",children:[e.label,": ",null!==(t=w[e.value])&&void 0!==t?t:0]},e.value)})})]}),(0,a.jsx)(i.Zb,{children:(0,a.jsx)(i.aY,{className:"space-y-4",children:z?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("div",{className:"mr-3 h-6 w-6 animate-spin rounded-full border-b-2 border-energy-water"}),"正在加载售后数据..."]}):0===j.length?(0,a.jsx)("p",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"暂无售后反馈"}):j.map(e=>{var t;let s=F===e.id;return(0,a.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-5 shadow-sm transition hover:shadow-md dark:border-gray-700 dark:bg-gray-900/70",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:e.user_name}),eF(e.status)]}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["创建时间：",eB(e.created_at),e.resolved_at?" \xb7 完成时间：".concat(eB(e.resolved_at)):""]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["in_progress"!==e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"secondary",onClick:()=>eu(e.id,"in_progress"),disabled:s,children:s?"处理中...":"标记处理中"}),"resolved"!==e.status&&(0,a.jsx)(i.zx,{size:"sm",onClick:()=>eu(e.id,"resolved"),disabled:s,children:s?"处理中...":"标记已解决"}),"closed"!==e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>eu(e.id,"closed"),disabled:s,children:s?"处理中...":"关闭工单"}),"open"!==e.status&&(0,a.jsx)(i.zx,{size:"sm",variant:"ghost",onClick:()=>eu(e.id,"open"),disabled:s,children:"重新打开"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>eI(e.id),disabled:s,children:s?"处理中...":"删除"})]})]}),(0,a.jsxs)("div",{className:"mt-4 grid gap-3 text-sm text-gray-600 dark:text-gray-300 md:grid-cols-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-500 dark:text-gray-400",children:"联系方式"}),(0,a.jsxs)("p",{className:"mt-1",children:["电话：",e.contact_phone]}),(0,a.jsxs)("p",{className:"mt-1",children:["邮箱：",e.contact_email||"未填写"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-500 dark:text-gray-400",children:"问题类型"}),(0,a.jsx)("p",{className:"mt-1",children:e.issue_category||"未分类"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-500 dark:text-gray-400",children:"处理人"}),(0,a.jsx)("p",{className:"mt-1",children:e.handler_name||e.handler_email||"未分配"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"问题描述"}),(0,a.jsx)("p",{className:"mt-2 whitespace-pre-line rounded-lg bg-gray-50 p-3 text-sm text-gray-700 dark:bg-gray-800/70 dark:text-gray-200",children:e.issue_description})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"处理备注"}),(0,a.jsx)(i.gx,{className:"mt-2",rows:3,value:null!==(t=B[e.id])&&void 0!==t?t:"",onChange:t=>M(s=>({...s,[e.id]:t.target.value}))}),(0,a.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",onClick:()=>em(e.id),disabled:s,children:s?"保存中...":"保存备注"}),(0,a.jsx)(i.zx,{size:"sm",variant:"outline",onClick:()=>M(t=>{var s;return{...t,[e.id]:null!==(s=e.admin_notes)&&void 0!==s?s:""}}),disabled:s,children:"重置"})]})]})]},e.id)})})})]}),"adjustments"===T&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"积分调整"}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"手动调整用户积分"})}),(0,a.jsx)(i.aY,{children:(0,a.jsxs)("form",{className:"grid gap-4 md:grid-cols-2",onSubmit:eD,children:[(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"用户标识"}),(0,a.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,a.jsxs)("select",{className:"rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:er.identifierType,onChange:e=>en(t=>({...t,identifierType:e.target.value,identifier:""})),children:[(0,a.jsx)("option",{value:"email",children:"邮箱"}),(0,a.jsx)("option",{value:"userId",children:"用户ID"})]}),(0,a.jsx)(i.II,{placeholder:"email"===er.identifierType?"user@example.com":"用户UUID",value:er.identifier,onChange:e=>en(t=>({...t,identifier:e.target.value})),required:!0})]})]}),(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"积分数量"}),(0,a.jsx)(i.II,{type:"number",className:"mt-2",placeholder:"例如：100",value:er.amount,onChange:e=>en(t=>({...t,amount:e.target.value})),step:"1",inputMode:"numeric",required:!0}),(0,a.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,a.jsx)(i.zx,{type:"button",size:"sm",variant:"manual_increase"===er.adjustmentType?"primary":"secondary",onClick:()=>en(e=>({...e,adjustmentType:"manual_increase"})),children:"加积分"}),(0,a.jsx)(i.zx,{type:"button",size:"sm",variant:"manual_decrease"===er.adjustmentType?"primary":"secondary",onClick:()=>en(e=>({...e,adjustmentType:"manual_decrease"})),children:"扣积分"})]}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"也可以直接输入带符号的数字；上方快捷按钮会自动切换“加积分 / 扣积分”类型。"})]}),(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"调整类型"}),(0,a.jsx)("select",{className:"mt-2 w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",value:er.adjustmentType,onChange:e=>en(t=>({...t,adjustmentType:e.target.value})),children:Object.entries(eL).map(e=>{let[t,s]=e;return(0,a.jsx)("option",{value:t,children:s},t)})})]}),(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"关联充值记录（可选）"}),(0,a.jsx)(i.II,{className:"mt-2",placeholder:"recharge record UUID",value:er.relatedRechargeId,onChange:e=>en(t=>({...t,relatedRechargeId:e.target.value}))})]}),(0,a.jsxs)("div",{className:"md:col-span-1",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"关联消耗记录（可选）"}),(0,a.jsx)(i.II,{className:"mt-2",placeholder:"consumption record UUID",value:er.relatedConsumptionId,onChange:e=>en(t=>({...t,relatedConsumptionId:e.target.value}))})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"备注说明（可选）"}),(0,a.jsx)(i.gx,{className:"mt-2",rows:3,placeholder:"记录本次调整的原因（将写入数据库，便于追踪）",value:er.reason,onChange:e=>en(t=>({...t,reason:e.target.value}))})]}),(0,a.jsx)("div",{className:"md:col-span-2 flex justify-end",children:(0,a.jsx)(i.zx,{type:"submit",disabled:X,children:X?"提交中...":"提交调整"})})]})})]}),(0,a.jsxs)(i.Zb,{children:[(0,a.jsx)(i.Ol,{children:(0,a.jsx)(i.ll,{children:"最近积分调整记录"})}),(0,a.jsx)(i.aY,{children:L?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("div",{className:"mr-3 h-6 w-6 animate-spin rounded-full border-b-2 border-energy-water"}),"正在加载积分记录..."]}):0===_.length?(0,a.jsx)("p",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"暂无手动积分调整记录"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"时间"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"用户"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"变动"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"类型"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"原因"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"管理员"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"前后积分"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"关联记录"}),(0,a.jsx)("th",{className:"py-3 px-4 text-left",children:"操作"})]})}),(0,a.jsx)("tbody",{children:_.map(e=>{var t,s,r;let n=K===e.id;return(0,a.jsxs)("tr",{className:"border-b border-gray-100 transition-colors hover:bg-gray-50 dark:border-gray-800 dark:hover:bg-gray-800/50",children:[(0,a.jsx)("td",{className:"py-3 px-4",children:eB(e.created_at)}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{children:e.user_email||e.user_id.substring(0,8)}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:e.user_id})]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("span",{className:e.delta>=0?"font-semibold text-green-600 dark:text-green-400":"font-semibold text-red-600 dark:text-red-400",children:[e.delta>=0?"+":"",e.delta]})}),(0,a.jsx)("td",{className:"py-3 px-4",children:eL[e.adjustment_type]}),(0,a.jsx)("td",{className:"max-w-xs py-3 px-4 text-sm text-gray-600 dark:text-gray-300",children:e.reason||"—"}),(0,a.jsx)("td",{className:"py-3 px-4",children:e.admin_email||(null===(t=e.admin_user_id)||void 0===t?void 0:t.substring(0,8))||"系统"}),(0,a.jsxs)("td",{className:"py-3 px-4 text-sm text-gray-600 dark:text-gray-300",children:[null!==(s=e.before_credits)&&void 0!==s?s:"—"," → ",null!==(r=e.after_credits)&&void 0!==r?r:"—"]}),(0,a.jsxs)("td",{className:"py-3 px-4 text-xs text-gray-500 dark:text-gray-400",children:[e.related_recharge_id&&(0,a.jsxs)("div",{children:["充值：",e.related_recharge_id]}),e.related_consumption_id&&(0,a.jsxs)("div",{children:["消耗：",e.related_consumption_id]}),!e.related_recharge_id&&!e.related_consumption_id&&"—"]}),(0,a.jsx)("td",{className:"py-3 px-4",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(i.zx,{size:"sm",variant:"ghost",onClick:()=>{let t=window.prompt("编辑原因",e.reason||"");null!==t&&eE(e.id,{reason:t})},disabled:n,children:"编辑"}),(0,a.jsx)(i.zx,{size:"sm",variant:"danger",onClick:()=>eP(e.id),disabled:n,children:n?"处理中...":"删除"})]})})]},e.id)})})]})})})]})]}),"prompts"===T&&(0,a.jsx)(E,{onShowBanner:el}),"keywords"===T&&(0,a.jsx)(H,{onShowBanner:el}),"blog"===T&&(0,a.jsx)(G,{onShowBanner:el}),"use-cases"===T&&(console.log("渲染 AdminUseCasesManager 组件"),(0,a.jsx)("div",{children:(0,a.jsx)(ef,{onShowBanner:el})})),"compare-pages"===T&&(0,a.jsx)(ek,{onShowBanner:el}),"batch-generator"===T&&(0,a.jsx)(eN,{onShowBanner:el}),"seo-chat"===T&&(0,a.jsx)(eC,{onShowBanner:el}),"admin-chat"===T&&(0,a.jsx)(e_,{onShowBanner:el}),"chat-debug"===T&&(0,a.jsx)(eS,{onShowBanner:el}),"homepage"===T&&(0,a.jsx)(V,{onShowBanner:el}),"scene-config"===T&&(0,a.jsx)(eT,{onShowBanner:el})]})]})]})}},3953:function(e,t,s){"use strict";s.d(t,{Le:function(){return a},SM:function(){return r}});let a=[{id:"use-case",name:"使用场景页面生成",description:"批量生成使用场景介绍页面（适合 90% 内容）",parameters:[{key:"scene",label:"使用场景",required:!0,placeholder:"例如：健身课程视频"},{key:"industry",label:"目标行业",required:!1,placeholder:"例如：体育培训"},{key:"keyword",label:"目标关键词",required:!1,placeholder:"例如：ai fitness video generator"},{key:"style",label:"视频风格",required:!1,placeholder:"例如：真实写实、动漫、商业"}],template:'You are an experienced SEO content writer specializing in both SEO (Google ranking) and GEO (Generative Engine Optimization - AI search citation). Generate a high-quality, indexable use case page for an AI video generation platform (Sora2) that can be directly quoted by ChatGPT, Gemini, and Perplexity. All content must be in English.\n\nCRITICAL: The AI video platform ONLY supports 10-second or 15-second videos. NEVER mention any duration longer than 15 seconds (such as 20 seconds, 30 seconds, 45 seconds, 60 seconds, 1 minute, 2 minutes, etc.). When describing video examples, ALWAYS use "10 seconds" or "15 seconds" only.\n\n【Platform Features】\n- Text-to-video generation\n- Image-to-video generation\n- Multiple styles (realistic, anime, commercial, educational)\n- Video duration: 10 seconds or 15 seconds (NOT 2 minutes or longer)\n- Can generate product videos, marketing videos, educational content, TikTok videos, etc.\n\n【Content Requirements】\n- Do not stuff keywords\n- Natural, human-like tone\n- Each paragraph should be 60-120 words\n- Fixed structure with H2/H3 headings\n- All content must be in English\n- IMPORTANT: When mentioning video duration, ALWAYS use "10 seconds" or "15 seconds". NEVER mention "2 minutes", "1 minute", or any duration longer than 15 seconds.\n\n【GEO Optimization Requirements】\n1. Answer-First Structure (GEO-1): Start with "In [industry], AI-generated videos are commonly used for [use case]." Follow with typical applications list (noun phrases).\n2. List Format (GEO-2): Use noun phrases, NOT marketing sentences (e.g., "Product demo videos", not "Boost your brand visibility").\n3. FAQ Style (GEO-4): Answer questions non-experts would ask (e.g., "Is AI video suitable for [industry]?", "Do I need [equipment]?"). Keep answers 2-4 sentences, no marketing jargon.\n4. Industry + Scene + Platform (GEO-5): Must clearly identify at least 2 of: industry, use case scenario, platform.\n\n【Parameters】\nUse Case: {{scene}}\nTarget Industry: {{industry}}\nTarget Keyword: {{keyword}}\nVideo Style: {{style}}\n\n【Content Structure - SEO + GEO Optimized】\nH1: [Main title based on the use case, e.g., "AI Video Generation for {{scene}}"]\n\nH2: Introduction (GEO-1: Answer-First Structure - 150-200 words)\nStart with: "In {{industry}}, AI-generated videos are commonly used for {{scene}}."\nFollow with:\n- Typical applications include: [list of noun phrases]\n- This page explains how teams use AI video tools for this purpose, which platforms are most suitable, and practical steps to get started.\n\n\uD83D\uDEE1️ AUTHORITATIVENESS ANCHOR (After Answer-first paragraph):\nAdd this sentence immediately after the Answer-first paragraph (1-2 sentences, factual, non-promotional):\n"This page is part of a structured knowledge base on AI video use cases, covering multiple industries and scenarios."\nPurpose: Tell AI this is a systematic knowledge base, not an isolated page.\n\nH2: Why AI video is suitable for this scenario (3-5 points)\nUse noun phrases in lists:\n✅ Good: "Product demo videos", "Onboarding clips", "Social media ads"\n❌ Bad: "Boost your brand visibility", "Increase engagement dramatically"\n\nH2: What Sora2 can do in this scenario (3-6 sub-scenarios with H3 headings)\nList format with noun phrases\n\n\uD83D\uDEE1️ INDUSTRY CONSTRAINTS (After "Why AI video is suitable", before "What Sora2 can do"):\nH2: Industry Constraints and Considerations\n\nAdd a 2-3 sentence paragraph about real limitations specific to {{industry}}:\n"In the {{industry}} sector, AI-generated video may have limitations when [specific constraint 1], [specific constraint 2], or [specific constraint 3]. Teams should consider [consideration] before applying this approach to [specific scenario]."\n\nPurpose: Provide industry-specific constraints to reduce thin content and template spam risks.\n\nH2: Video generation examples (text-to-video examples)\nUse noun phrases for examples\n\nH2: Frequently Asked Questions (GEO-4: "傻问题化" - Answer questions non-experts would ask)\nMust include at least 3 questions. You MUST include at least 1 FAQ-A (beginner cognitive) AND at least 1 FAQ-B (decision boundary).\n\n\uD83D\uDEE1️ FAQ-A (Beginner Cognitive - Newcomer Questions):\n- "Is AI video suitable for {{industry}}?"\n- "Do I need filming equipment for {{scene}}?"\n- "Is this expensive?"\n- "Can small teams use this?"\n\n\uD83D\uDEE1️ FAQ-B (Decision Boundary - When NOT to Use):\n- "When should AI video not be used in {{industry}}?"\n- "What are common limitations of AI-generated video for {{scene}}?"\n- "What scenarios are not suitable for AI-generated video in {{industry}}?"\n\nKeep answers 2-4 sentences, no marketing jargon. FAQ-B answers should be honest about limitations.\n\nH2: Target Audience / Applicable Industries\n\nIMPORTANT: You MUST start with an H1 heading (single #). The H1 should be the main title of the page.\n\nPlease output high-quality SEO + GEO optimized content in English.'},{id:"long-tail-keyword",name:"长尾关键词页面生成",description:"批量生成长尾关键词解释页面（提高收录）",parameters:[{key:"keyword",label:"关键词",required:!0,placeholder:"例如：ai fitness video generator"},{key:"scene",label:"相关使用场景",required:!1,placeholder:"例如：健身课程视频"},{key:"industry",label:"行业",required:!1,placeholder:"例如：体育培训"}],template:'You are an SEO content expert. Please generate a dedicated long-tail keyword page based on the following parameters.\n\n【Parameters】\nKeyword: {{keyword}}\nRelated Use Case: {{scene}}\nIndustry: {{industry}}\n\n【Writing Requirements】\n- Use natural language, do not stuff keywords\n- Each paragraph: 60-100 words\n- Total length: 400-700 words (suitable for long-tail keyword pages)\n- Friendly, readable, informative\n- All content must be in English\n- IMPORTANT: When mentioning video duration, ALWAYS use "10 seconds" or "15 seconds". NEVER mention "2 minutes", "1 minute", or any duration longer than 15 seconds.\n\n【Page Structure】\nH1: What is {{keyword}}?\nH2: Its practical business applications\nH2: A simple example (explain with a story or scenario)\nH2: How to solve this problem with AI video (Sora2)\nH2: Frequently Asked Questions (2-3 questions)\n\nPlease output high-quality content in English.'},{id:"blog-post",name:"博客文章生成",description:"生成高质量博客文章（Pillar + Cluster，抢竞争词流量）",parameters:[{key:"title",label:"文章标题",required:!0,placeholder:"例如：Best Sora Alternatives for Creators"},{key:"keyword",label:"目标关键词",required:!0,placeholder:"例如：sora alternative"},{key:"audience",label:"读者群体",required:!1,placeholder:"例如：内容创作者、营销人员"},{key:"scene",label:"相关场景",required:!1,placeholder:"例如：YouTube 视频制作"}],template:'You are a professional SEO blog writer. Please generate a high-quality blog article based on the article title and target keyword.\n\n【Parameters】\nArticle Title: {{title}}\nTarget Keyword: {{keyword}}\nTarget Audience: {{audience}}\nRelated Scenario: {{scene}}\n\n【Overall Requirements】\n- Clear structure with logical paragraphs\n- Do not stuff keywords or repeat content\n- Use real examples\n- Write like a human, avoid AI-like tone\n- Content must satisfy search intent\n- Word count: 1500-2500 words\n- Fixed H2/H3 structure as below\n- All content must be in English\n- IMPORTANT: When mentioning video duration, ALWAYS use "10 seconds" or "15 seconds". NEVER mention "2 minutes", "1 minute", or any duration longer than 15 seconds.\n\n【Article Structure Template】\nH1: {{title}}\nH2: What problem does this article solve? (Introduction)\nH2: Core concept explanation (related to keyword)\nH2: Common misconceptions (3-5 points)\nH2: How to truly solve this problem (step-by-step explanation)\nH2: Applications of AI video (Sora2) in this scenario\n    H3: Sub-scenario 1\n    H3: Sub-scenario 2\n    H3: Sub-scenario 3\nH2: Real-world examples (can be fictional but must be specific)\nH2: Conclusion (give readers a clear takeaway)\n\nPlease output high-quality SEO blog content in English.'},{id:"industry-page",name:"行业页面生成",description:"生成特定行业的介绍页面（可扩展后台功能）",parameters:[{key:"industry",label:"行业",required:!0,placeholder:"例如：教育行业、电商行业"},{key:"keyword",label:"关键词",required:!1,placeholder:"例如：ai video for education"}],template:'You are an SEO content expert. Please generate an industry-specific introduction page.\n\n【Parameters】\nIndustry: {{industry}}\nKeyword: {{keyword}}\n\n【Writing Requirements】\n- Emphasize industry pain points\n- Combine with the practical value of AI video\n- List real application scenarios (avoid generic statements)\n- All content must be in English\n- IMPORTANT: When mentioning video duration, ALWAYS use "10 seconds" or "15 seconds". NEVER mention "2 minutes", "1 minute", or any duration longer than 15 seconds.\n\n【Structure】\nH1: Applications of AI Video in the {{industry}} Industry\nH2: Problems facing the industry (4-6 points)\nH2: Why AI video is suitable for this industry\nH2: Typical application scenarios of Sora2 in this industry\n    H3: Scenario 1\n    H3: Scenario 2\n    H3: Scenario 3\nH2: Video generation examples\nH2: Conclusion (provide industry future trends)\n\nPlease output high-quality SEO content in English.'},{id:"compare-page",name:"对比页面生成",description:"生成工具对比页面（Sora vs 其他工具）",parameters:[{key:"tool_a",label:"工具 A（默认 Sora）",required:!1,placeholder:"例如：OpenAI Sora"},{key:"tool_b",label:"工具 B",required:!0,placeholder:"例如：Runway、Pika、Luma"},{key:"keyword",label:"目标关键词",required:!1,placeholder:"例如：sora vs runway"}],template:'You are a professional tool comparison article writer. Please generate an AI video tool comparison page.\n\n【Parameters】\nTool A: {{tool_a}} (default: OpenAI Sora)\nTool B: {{tool_b}}\nTarget Keyword: {{keyword}}\n\n【Writing Requirements】\n- Objective, fair, data-supported\n- Do not favor any side\n- Use real comparison points\n- Clear structure, easy to read\n- All content must be in English\n- IMPORTANT: When mentioning video duration, ALWAYS use "10 seconds" or "15 seconds". NEVER mention "2 minutes", "1 minute", or any duration longer than 15 seconds.\n\n【Structure】\nH1: {{tool_a}} vs {{tool_b}}: Which AI Video Generator is Better?\nH2: Quick Comparison Table (price, features, quality, speed, etc.)\nH2: Advantages of {{tool_a}} (3-5 points)\nH2: Advantages of {{tool_b}} (3-5 points)\nH2: Detailed Feature Comparison\n    H3: Video Quality\n    H3: Generation Speed\n    H3: Price Comparison\n    H3: Ease of Use\nH2: Recommended Use Cases\n    H3: Scenarios for choosing {{tool_a}}\n    H3: Scenarios for choosing {{tool_b}}\nH2: Conclusion and Recommendations\n\nPlease output high-quality comparison content in English.'}];function r(e,t){let s=e;for(let[e,a]of Object.entries(t)){let t="{{".concat(e,"}}");s=a&&""!==a.trim()?s.replace(RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),a.trim()):(s=s.replace(RegExp("^.*".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),".*$"),"gm"),"")).replace(RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"")}return(s=s.replace(/\n{3,}/g,"\n\n")).trim()}},970:function(e,t,s){"use strict";let a,r;s.d(t,{createClient:function(){return l}});var n=s(3053);let i=new Map;function l(){let e="https://hgzpzsiafycwlqrkzbis.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhnenB6c2lhZnljd2xxcmt6YmlzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI2MTk4NzIsImV4cCI6MjA3ODE5NTg3Mn0.WdpkrSXVZVZ64bY8NXG6Bpf-w59i305F7agny6wuj_Q";if(!e||!t)throw Error("Missing Supabase environment variables");return r||(r=function(){let e=function(){try{return"localStorage"in window?window.localStorage:null}catch(e){return null}}(),t=function(){try{return"sessionStorage"in window?window.sessionStorage:null}catch(e){return null}}();return{async getItem(s){var a;s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] getItem start",{key:s});let r=null==e?void 0:e.getItem(s);if(null!=r)return i.set(s,r),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] getItem hit localStorage",{key:s}),r;let n=null==t?void 0:t.getItem(s);if(null!=n)return i.set(s,n),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] getItem hit sessionStorage",{key:s}),n;let l=function(e){if("undefined"==typeof document)return null;for(let t of document.cookie?document.cookie.split("; "):[]){let[s,...a]=t.split("=");if(s===e)return decodeURIComponent(a.join("="))}return null}(s);return null!==l?(i.set(s,l),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] getItem hit cookie",{key:s}),l):(s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] getItem miss",{key:s}),null!==(a=i.get(s))&&void 0!==a?a:null)},async setItem(s,a){let r=String(a);try{null==e||e.setItem(s,r),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] setItem localStorage success",{key:s})}catch(e){s.endsWith("-code-verifier")&&console.warn("[SupabaseStorage] setItem localStorage failed",{key:s,error:e})}try{null==t||t.setItem(s,r),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] setItem sessionStorage success",{key:s})}catch(e){s.endsWith("-code-verifier")&&console.warn("[SupabaseStorage] setItem sessionStorage failed",{key:s,error:e})}if(s.endsWith("-code-verifier"))try{(function(e,t,s){if("undefined"==typeof document)return;let a="https:"===window.location.protocol,r="".concat(e,"=").concat(encodeURIComponent(t),"; Path=/; SameSite=Lax; Max-Age=").concat(600).concat(a?"; Secure":"");document.cookie=r})(s,r,0),console.log("[SupabaseStorage] setItem cookie success",{key:s})}catch(e){console.warn("[SupabaseStorage] setItem cookie failed",{key:s,error:e})}i.set(s,r),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] setItem memory store",{key:s})},async removeItem(s){try{null==e||e.removeItem(s),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] removeItem localStorage",{key:s})}catch(e){s.endsWith("-code-verifier")&&console.warn("[SupabaseStorage] removeItem localStorage failed",{key:s,error:e})}try{null==t||t.removeItem(s),s.endsWith("-code-verifier")&&console.log("[SupabaseStorage] removeItem sessionStorage",{key:s})}catch(e){s.endsWith("-code-verifier")&&console.warn("[SupabaseStorage] removeItem sessionStorage failed",{key:s,error:e})}s.endsWith("-code-verifier")&&("undefined"!=typeof document&&(document.cookie="".concat(s,"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; SameSite=Lax")),console.log("[SupabaseStorage] removeItem cookie",{key:s})),i.delete(s)}}}()),a||(a=(0,n.eI)(e,t,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,flowType:"pkce",storage:r}})),a}}},function(e){e.O(0,[2972,6137,4609,3053,5726,8547,5492,2971,2117,1744],function(){return e(e.s=1043)}),_N_E=e.O()}]);