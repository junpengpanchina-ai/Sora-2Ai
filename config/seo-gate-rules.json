{
  "seo_scaling_gate": {
    "version": "1.1",
    "last_updated": "2026-01-24",
    
    "observation_window_days": 14,
    
    "systemic_errors": {
      "description": "5xx/404 hard rules - overrides Index Rate if violated",
      "5xx": {
        "red": {
          "condition": "count_7d >= 10 OR (count_today > 0 AND consecutive_days >= 3)",
          "action": "BLOCK_SYSTEMIC_5XX",
          "description": "Immediate freeze due to 5xx errors"
        },
        "yellow": {
          "condition": "count_today > 0",
          "action": "FREEZE_SYSTEMIC_5XX",
          "description": "Freeze expansion, allow fixes"
        },
        "green": {
          "condition": "count_today = 0 AND clean_days >= 7",
          "action": "ALLOW",
          "description": "No 5xx for 7 days"
        }
      },
      "404": {
        "red": {
          "condition": "count_in_sitemap > 0",
          "action": "BLOCK_404_IN_SITEMAP",
          "description": "Sitemap contains 404 URLs"
        },
        "yellow": {
          "condition": "count_total > 20",
          "action": "FREEZE_HIGH_404",
          "description": "High 404 count needs attention"
        },
        "green": {
          "condition": "count_in_sitemap = 0 AND clean_days >= 7",
          "action": "ALLOW",
          "description": "No 404 in sitemap for 7 days"
        }
      },
      "combined_rule": "systemic_errors must be GREEN before Index Rate is evaluated"
    },
    
    "index_rate_thresholds": {
      "green": {
        "min": 0.70,
        "action": "ALLOW_SCALE",
        "description": "Scale allowed - can expand sitemaps and admit core"
      },
      "yellow": {
        "min": 0.40,
        "max": 0.69,
        "action": "FREEZE",
        "description": "Observe only - no structural changes allowed"
      },
      "red": {
        "max": 0.39,
        "action": "BLOCK_AND_ROLLBACK",
        "description": "Freeze all expansion, consider rollback"
      }
    },
    
    "sitemap_core_admission": {
      "description": "Conditions for admitting sitemap-core.xml to sitemap index",
      "required": {
        "index_rate_min": 0.65,
        "stability_days": 7,
        "max_volatility": 0.05,
        "crawl_errors_allowed": false,
        "crawl_trend_declining": false,
        "manual_checks": {
          "min_urls": 5,
          "eligible_only": true
        }
      },
      "on_pass": "ALLOW_ADMISSION",
      "on_fail": "DENY_ADMISSION"
    },
    
    "tier_expansion": {
      "tier1": {
        "chunk_size": 1000,
        "expansion_requires": "GREEN",
        "observation_before_next": 7
      },
      "tier2": {
        "chunk_size": 500,
        "expansion_requires": "GREEN",
        "observation_before_next": 3
      }
    },
    
    "alerts": {
      "index_rate_drop": {
        "threshold": 0.10,
        "window_days": 1,
        "severity": "critical"
      },
      "consecutive_decline": {
        "days": 3,
        "severity": "warning"
      },
      "zone_transition": {
        "from": "green",
        "to": "yellow",
        "severity": "info"
      },
      "zone_transition_critical": {
        "from": "any",
        "to": "red",
        "severity": "critical"
      }
    },
    
    "forbidden_actions": [
      "ADD_SITEMAP_CORE_BEFORE_TIER1_VALIDATION",
      "EXPAND_TIER_DURING_YELLOW",
      "EXPAND_TIER_DURING_RED",
      "COMPENSATE_LOW_INDEX_RATE_WITH_CORE",
      "SCALE_ON_ASSUMPTION",
      "OVERRIDE_WITHOUT_JUSTIFICATION"
    ],
    
    "default_action": "FREEZE",
    
    "rollback": {
      "enabled": true,
      "max_rollback_days": 7,
      "method": "noindex_recent_pages"
    },
    
    "audit": {
      "log_all_decisions": true,
      "require_justification_for_override": true,
      "metrics_snapshot_required": true
    }
  },
  
  "reason_codes": {
    "BLOCKED_SYSTEMIC_5XX": {
      "description": "5xx errors detected - system health issue",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 1
    },
    "BLOCKED_404_IN_SITEMAP": {
      "description": "404 URLs found in sitemap",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 2
    },
    "BLOCKED_TIER1_EMPTY": {
      "description": "tier1-0.xml has 0 URLs",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 3
    },
    "BLOCKED_LOW_INDEX_RATE": {
      "description": "Index Rate below 40%",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 4
    },
    "BLOCKED_INDEX_DELTA_NEGATIVE": {
      "description": "Index delta negative for 3+ days",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 5
    },
    "BLOCKED_HIGH_DUPLICATE": {
      "description": "Duplicate rate above 20%",
      "severity": "fatal",
      "action": "BLOCK",
      "priority": 6
    },
    "FREEZE_SYSTEMIC_5XX": {
      "description": "5xx detected today - freeze until clean",
      "severity": "warning",
      "action": "FREEZE",
      "priority": 1
    },
    "FREEZE_HIGH_404": {
      "description": "High 404 count needs attention",
      "severity": "warning",
      "action": "FREEZE",
      "priority": 2
    },
    "HOLD_MODERATE_INDEX_RATE": {
      "description": "Index Rate between 40-70%",
      "severity": "warning",
      "action": "HOLD",
      "priority": 10
    },
    "CAUTIOUS_BORDERLINE": {
      "description": "Index Rate between 65-70%",
      "severity": "info",
      "action": "CAUTIOUS",
      "priority": 11
    },
    "SAFE_TO_SCALE": {
      "description": "All conditions met - no systemic errors, good Index Rate",
      "severity": "ok",
      "action": "ALLOW",
      "priority": 100
    }
  },
  
  "daily_metrics": {
    "required": [
      "discovered_urls",
      "indexed_urls",
      "index_rate",
      "crawled_not_indexed",
      "crawl_stats",
      "error_5xx_count",
      "error_404_count",
      "error_404_in_sitemap"
    ],
    "derived": [
      "index_rate_7d_ma",
      "index_delta",
      "duplicate_rate",
      "5xx_clean_days",
      "404_clean_days"
    ]
  },
  
  "current_status": {
    "description": "Snapshot from GSC 2026-01-20",
    "indexed": 29000,
    "not_indexed": 1126,
    "index_rate": 0.963,
    "issues": {
      "5xx": 43,
      "404": 8,
      "redirect": 708,
      "discovered_not_indexed": 266,
      "crawled_not_indexed": 100
    },
    "gate_state": "YELLOW",
    "reason": "FREEZE_SYSTEMIC_5XX",
    "action_required": "Fix 5xx errors before scaling"
  }
}
